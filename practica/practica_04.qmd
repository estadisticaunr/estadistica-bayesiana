---
title: "Pr치ctica - Unidad 4"
nocite: "@Martin2021, @Downey2021, @Gelman2021, @Johnson2021"
practica: "Pr치ctica 4"
---

```{r}
#| echo: false
#| include: false
is_html <- knitr::is_html_output()
options("knitr.graphics.error" = FALSE)
source(here::here("scripts", "utils.R"))
caption_data <- list(
    "uluru" = list(
        author = "Snowscat", 
        handle = "snowscat", 
        code = "8uq1smN9g1w",
        msg = "Parque Nacional Ulu攷릇-Kata Tju攷스 en Uluru, Australia."
    )
)
captions <- lapply(caption_data, function(x) do.call(make_unsplash_caption, x))
captions[["mesquite"]] <- paste(
    "Un 치rbol de mesquite.<br>Foto de Sergei Bogomyakov,",
    "<a href='https://nationalgeographicla.com/fotografo/alamy-stock-photo'>Alamy Stock Photo</a>."
)
captions[["especies_pescados"]] <- "Especies de peces de todas variedades y tama침os."
```

## Regresi칩n lineal

El objetivo principal de esta unidad es la aplicaci칩n de modelos de regresi칩n lineales 
desde una perspectiva bayesiana, considerando a los par치metros del modelo como cantidades
aleatorias que se corresponden con una distribuci칩n de probabilidad _a priori_. 
A diferencia del enfoque frecuentista o m치ximo veros칤mil, el resultado de la inferencia 
bayesiana es una distribuci칩n de probabilidad _a posteriori_, la cual se utiliza como 
fuente de todas las conclusiones. Adem치s, se emplean t칠cnicas propias de la estad칤stica
bayesiana para evaluar la adecuaci칩n y comparar los modelos utilizados.

1.  游늷 **Mi primer regresi칩n bayesiana**

    El conjunto de datos `sales` contiene los montos semanales de inversi칩n en publicidad 
    y de ingresos de una determinada compa침칤a. Considere el siguiente modelo de regresi칩n 
    lineal simple:

    $$
    \begin{aligned}
    \text{ventas}_i &\sim \text{Normal}(\mu_i, \sigma^2) \\
    \mu_i &= \beta_0 + \beta_1 \text{publicidad}_i \\
    \end{aligned}
    $$

    i. Ajuste el modelo utilizando `{Rstan}` y distribuciones uniformes como _priors_.
    i. Construya un gr치fico que muestre las ventas en funci칩n de la inversi칩n en 
    publicidad y superponga la recta de regresi칩n estimada.

1.  游늷 **Mejorando mi regresi칩n bayesiana**

    Considere la siguiente versi칩n del modelo del ejercicio anterior que propone 
    distribuciones _a priori_ para los par치metros del modelo:
    $$
    \begin{aligned}
    \text{ventas}_i &\sim \text{Normal}(\mu_i, \sigma^2) \\
    \mu_i &= \beta_0 + \beta_1 \text{publicidad}_i \\
    \beta_0  &\sim \text{Normal}(\overline{\text{ventas}}, 10^2) \\
    \beta_1  &\sim \text{Normal}(0, 0.5^2) \\
    \sigma &\sim \text{Normal}^+(5)
    \end{aligned}
    $$

    i. Ajuste el modelo utilizando `{RStan}` y los _priors_ sugeridos.
    i. Construya un gr치fico que muestre las ventas en funci칩n de la inversi칩n en 
    publicidad, superponga la recta de regresi칩n estimada, y el intervalo de credibilidad
    del 95% para la recta de regresi칩n.

1.  **Regresiones frecuentistas y bayesianas**

    Utilice datos simulados para comparar la estimaci칩n por m칤nimos cuadrados con la 
    estimaci칩n Bayesiana en modelos de regresi칩n.

    i. Simule 100 observaciones del modelo $Y = 2 + 3X + \varepsilon$ donde los valores 
    del predictor $X$ se obtienen de una distribuci칩n $\text{Uniforme}(0, 20)$ y los errores
    son obtenidos de manera independiente de una distribuci칩n $\text{Normal}(0, 5^2)$.
    i. Ajuste el modelo de regresi칩n utilizando `lm()` y un modelo bayesiano mediante 
    `{RStan}` utilizando _priors_ uniformes.
    i. Verifique que ambos m칠todos arrojan resultados similares.
    i. Represente gr치ficamente los datos y las dos rectas de regresi칩n.
    i. Intente repetir la simulaci칩n, pero esta vez cree las condiciones para que ambos
    enfoques den resultados diferentes.
    <!-- @Gelman2021 8.8 -->

1.  游늷 **La altura... 쯥e hereda?**

    El conjunto de datos de las alturas (`heights`) contiene las alturas (en pulgadas) de
    5524 pares de madres e hijas registradas en un estudio realizado por Karl Pearson y 
    Alice Lee en 1903.

    i. Elabore un gr치fico que permita ver la relaci칩n entre las alturas de las madres y 
    las hijas. Aplique las t칠cnicas que crea necesaria para obtener una visualizaci칩n 
    informativa y fidedigna.
    i. 쯇or qu칠 es adecuado utilizar un modelo de regresi칩n lineal?
    i. Ajuste el siguiente modelo de regresi칩n lineal utilizando `{Rstan}` y _priors_ que
    crea convenientes:

    $$
    \begin{aligned}
    \text{altura hija}_i &\sim \text{Normal}(\mu_i, \sigma^2) \\
    \mu_i &= \beta_0 + \beta_1 \text{altura madre}_i
    \end{aligned}
    $$
    
    i. Calcule la media, el desv칤o est치ndar y el intervalo de credibilidad del 95% 
    para los par치metros del modelo utilizando el _posterior_.
    i. Interprete los coeficientes del modelo.
    i. Superponga la recta de regresi칩n en el gr치fico donde se visualiza la relaci칩n
    entre las variables.
    i. Obtenga el _posterior_ del peso medio de una hija cuya madre mide 58 pulgadas.
    <!-- @Gelman2021 Capitulo 6-->

1.  游늷 **Clima en Australia**

    El conjunto de datos `weather_WU` datos clim치ticos correspondientes a 100 d칤as en dos 
    ciudades de Australia: Uluru y Wollongong. Se intentar치 predecir la temperatura a las
    3 de la tarde, utilizando otras variables.
    
    Considere los siguientes cuatro modelos:
    
    * $m_1$: `temp3pm ~ temp9am`;
    * $m_2$: `temp3pm ~ location`;
    * $m_3$: `temp3pm ~ temp9am + location`;
    * $m_4$: `temp3pm ~ .`.
    
    i. Ajuste cada uno de los modelos y construya gr치ficas para mostrar los par치metros obtenidos.
    i. Realice pruebas predictivas _a posteriori_ para comparar los modelos.
    i. Compare los _ELPD_ de cada modelo utilizando _LOO_.
    <!-- Bayes Rules. Cap칤tulo 11. -->
    
    ```{r}
    #| echo: false
    #| out.width: 70%
    #| fig-align: center
    #| fig-cap: !expr captions[["uluru"]]
    if (is_html) knitr::include_graphics(file.path("imgs", "uluru.jpg"))
    ```

1.  游늷 **Ping칲inos**

    Considere el dataset de ping칲inos de Palmer (`penguins`) y los siguientes 
    modelos:
        
    * $m_1$: `body_mass_g ~ flipper_length_mm`;
    * $m_2$: `body_mass_g ~ species`;
    * $m_3$: `body_mass_g ~ flipper_length_mm + species`;
    * $m_4$: `body_mass_g ~ flipper_length_mm + species + flipper_length_mm:species`;
    * $m_5$: `body_mass_g ~ flipper_length_mm + bill_length_mm + bill_depth_mm`.
    
    i. Ajuste cada uno de los modelos y construya gr치ficas para mostrar los par치metros 
    obtenidos.
    i. Realice pruebas predictivas _a posteriori_ para comparar los modelos.
    i. Compare los _ELPD_ de cada modelo utilizando _LOO_.
    <!-- Bayes Rules. Cap칤tulo 11. -->
    
1.  游늷 **De tal palo...**

    El dataset `child_iq` contiene informaci칩n de los resultados de tests de coeficiente
    intelectual de ni침os de 3 a침os, educaci칩n de la madre, y edad de la madre cuando dio
    a luz.
    
    i. Ajuste un modelo de regresi칩n del puntaje del beb칠 a los 3 a침os en funci칩n de la 
    edad de la madre.
    i. Ajsute ahora un modelo que incluya la educaci칩n de la madre.
    i. Construya gr치ficas para mostrar los par치metros obtenidos.
    i. Realice pruebas predictivas _a posteriori_ para comparar los modelos.
    i. Compare los _ELPD_ de cada modelo utilizando _LOO_.

    <!-- 1.  **La pinta es lo de menos...**

    Hamermesh y Parker estudiaron la relaci칩n entre los resultados de los estudiantes en 
    un curso y la belleza de los instructores. La determinaci칩n de la belleza se hizo a 
    partir de las opiniones de seis estudiantes que no participaron de los cursos y no
    conoc칤an las notas. Los datos se encuentran en el archivo `beauty`.
    
    i. Considere un modelo de regresi칩n `courseevaluation ~ btystdave`.
    **To Do**? -->
    
1.  游늷 **Ingresos**

    El dataset `earnings` contiene los resultados de la encuesta realizada por Ross sobre
    Trabajo, Familia y Bienestar.
    
    i. Ajuste un modelo que prediga ingreso en funci칩n de altura e interprete los 
    par치metros. 
    i. 쯈u칠 transformaci칩n ser칤a necesaria para interpretar el intercepto como el ingreso
    promedio de una persona con altura promedio?
    i. Ajuste un nuevo modelo utilizando la transformaci칩n propuesta en el punto anterior
    y compare los _posteriors_ de los coeficientes.
    
1.  游늷 **!Kung**

    Los !Kung son un pueblo que habita en el desierto de Kalahari entre Botsuana, 
    Namibia y Angola. Hablan la lengua !Kung, que se destaca por su amplio uso de 
    consonantes clic (chasquido conson치ntico). El !K del nombre 킊Kung es un sonido
    como cuando sale un corcho de una botella.
    
    El archivo `Howell1` contiene datos de un censo parcial realizado por Dobe Howell
    acerca de la poblaci칩n !Kung.
    
    Considere un modelo de altura en funci칩n del peso.
    
    i. Determine e interprete las distribuciones _a posteriori_ de los par치metros.
    i. Construya un gr치fico de altura en funci칩n del peso, incluya las observaciones
    de los individuos, la recta de regresi칩n MAP, el intervalo del 80\% para la media y
    y el intervalo del 80\% para la altura predicha.
    i. Realice predicciones para individuos cuyos pesos son: 46.95, 43.72, 64.78, 32.59
    y 54.63. Calcule la altura esperada y el intervalo del 89\%.
    
1.  游늷 **Zorros urbanos**

    Considere del conjunto de datos sobre zorros urbanos (`foxes`). Ajuste tres modelos:

    * $m_1$: `weight ~ area`;
    * $m_2$: `weight ~ groupsize`;
    * $m_3$: `weight ~ area + groupsize`.
    
    i. Para los modelos $m_1$ y $m_2$, represente gr치ficamente los resultados, incluyendo
    la recta de regresi칩n MAP, su intervalo del 89\% y el intervalo de predicci칩n del 89\%.
    쮼s alguna de las dos variables importantes para predecir la masa de un zorro?
    i. Representar gr치ficamente las predicciones del modelo para cada predictor, dejando
    el otro constante en su valor medio. 쯈u칠 puede decirse sobre la importancia de las
    variables para predecir la masa de un zorro?

1.  游늷 **Un _prior_ informativo marca la diferencia**

    Considere el conjunto de datos sobre belleza y proporci칩n de sexos (`sexratio`) .
    Estos datos provienen de un estudio de adolescentes estadounidenses cuyo atractivo en
    una escala de cinco puntos fue evaluado por entrevistadores en una 
    encuesta cara a cara. A침os m치s tarde, muchos de estos encuestados tuvieron hijos
    y se registraron ciertos atributos entre los cuales se incluy칩 el sexo. 
    El objetivo del an치lisis es comparar la proporci칩n de sexos de los hijos seg칰n la 
    belleza de los padres. Para ello considere el siguiente modelo de regresi칩n:

    $$
    \begin{aligned}
    \text{pf}_i &\sim \text{Normal}(\mu_i, \sigma^2) \\
    \mu_i &= \beta_0 + \beta_1 \text{belleza}_i \\
    \end{aligned}
    $$

    Donde $\text{pf}$ representa la proporci칩n de beb칠s de sexo femenino y $\text{belleza}$
    representa el grupo de belleza de los padres.

    i. Ajuste el modelo utilizando m칤nimos cuadrados.
    i. Ajuste el modelo con `{RStan}` y _priors_ uniformes.
    i. Compare el ajuste de ambos modelos.
    i. Explore los _priors_ utilizados por `{RStan}` y la distribuci칩n predictiva _a priori_.
    쯈u칠 puede concluir? 
    i. Proponga distribuciones _a priori_ informativas.
    i. Ajuste el modelo utilizando `{RStan}` y los _priors_ informativos.
    i. Compare el resultado con los obtenidos anteriormente y concluya.

1.  游늷 **춰A la pesca de _priors_!**

    El conjunto de datos `fish-market` contiene mediciones morfol칩gicas realizadas sobre
    pescados de diferentes especies. El objetivo es construir un modelo de regresi칩n
    lineal que permita predecir el peso de los pescados en base a sus otros atributos. 
    
    Uno de los modelos propuestos es el siguiente:

    $$
    \begin{aligned}
    \log(\text{Weight}_i) &\sim \text{Normal}(\mu_i, \sigma) \\
    \mu_i  &= \beta_{0, j[i]} + \beta_{1, j[i]} \log(\text{Length1}_i)
    \end{aligned}
    $$

    $\text{Weight}_i$ es el peso del i-칠simo pescado en gramos y $\text{Length1}_i$ es la
    longitud del i-칠simo pescado en cent칤metros. La letra $j$ indexa las especies
    de los pescados. Por lo tanto, en este modelo cada especie tiene su propio intercepto
    y pendiente.

    i. Implemente el modelo utilizando `{RStan}` y los siguientes _priors_ no informativos:
    $$
    \begin{aligned}
    \beta_{0, j[i]} &\sim \text{Normal}(0, 10) \\
    \beta_{1, j[i]} &\sim \text{Normal}(0, 5)
    \end{aligned}
    $$
    i. Obtenga y visualice la distribuci칩n predictiva a _priori_.
    i. Elabore un gr치fico y describa la funci칩n de densidad _a priori_ de los par치metros 
    $\beta_{0, j[i]}$ y  $\beta_{1, j[i]}$.
    i. Proponga _priors_ m치s adecuados en base a la interpretaci칩n de los par치metros del
    modelo y la informaci칩n que tenga del problema.
    i. Nuevamente, obtenga y visualice la distribuci칩n predictiva a _priori_ y compare 
    con el resultado obtenido anteriormente.
    i. Ajuste el modelo, obtenga la distribuci칩n predictiva _a posteriori_ y graf칤quela.
    
    ```{r}
    #| echo: false
    #| out.width: 70%
    #| fig-align: center
    #| fig-cap: !expr captions[["especies_pescados"]]
    if (is_html) knitr::include_graphics(file.path("imgs", "especies_pescados.png"))
    ```


1.  **En b칰squeda del modelo adecuado**

    Continuando con los datos del ejercicio anterior, El objetivo es construir un modelo 
    de regresi칩n lineal que permita predecir el peso de los pescados en base a sus otros 
    atributos.

    Considere los siguientes modelos

    * $m_1$: `log(Weight) ~ 0 + Species`;
    * $m_2$: `log(Weight) ~ 0 + Species + log(Length1)`;
    * $m_3$: `log(Weight) ~ 0 + Species + log(Length1):Species`;
    * $m_4$: `log(Weight) ~ 0 + Species + log(Length1):Species + log(Height)`;
    * $m_5$: `log(Weight) ~ 0 + Species + log(Length1):Species + log(Height):Species`.
    
    i. Ajuste cada uno de los modelos.
    i. Estime el _ELPD_ de cada modelo utilizando _LOO_ y seleccione el modelo m치s
    adecuado de acuerdo a este criterio.
    i. Explique el resultado.

1.  **Comparaci칩n de modelos**

    Se recopilaron datos (`mesquite`) con el fin de desarrollar un m칠todo para estimar la 
    producci칩n total (biomasa) de hojas de mesquite utilizando par치metros f치cilmente 
    medibles de la planta, antes de que se realice la cosecha real. 
    Se tomaron dos conjuntos separados de mediciones, uno en un grupo de 26 arbustos de 
    mesquite y otro en un grupo diferente de 20 arbustos de mesquite medidos en un momento
    diferente del a침o. Todos los datos se obtuvieron en la misma ubicaci칩n geogr치fica,
    pero ninguno constituy칩 una muestra estrictamente aleatoria. 
    La variable de resultado es el peso total (en gramos) de material fotosint칠tico 
    obtenido de la cosecha real del arbusto. Las variables de entrada son:
    
    | **Nombre**      | **Descripci칩n**                                                              |
    |-----------------|------------------------------------------------------------------------------|
    | `diam1`         | Di치metro de la copa medido a lo largo del eje m치s largo del arbusto (metros) |
    | `diam2`         | Di치metro de la copa medido a lo largo del eje m치s corto (metros)             |
    | `canopy_height` | Altura de la copa                                                            |
    | `total_height`  | Altura total del arbusto                                                     |
    | `density`       | N칰mero de tallos primarios por planta                                        |
    | `group`         | Grupo de mediciones (0 para el primer grupo, 1 para el segundo)              |
    
    i. Realice un an치lisis exploratorio de los datos.
    i. Ajuste el modelo 
    `weight ~ diam1 + diam2 + canopy_height + total_height + density + group`.
    i. Explore y describa el _posterior_.
    i. Estime _ELPD_ mediante _PSIS-CV_ con la funci칩n `loo()`, analice los valores de
    las estimaciones del par치metro $k$ de la distribuci칩n generalizada de Pareto y otros
    valores de la salida que crea relevant, 쯤u칠 puede concluir?
    i. Estime ELPD mediante _K-fold cross validation_ con $K=10$. Compare la estimaci칩n
    con el resultado obtenido mediante _PSIS-CV_ y concluya.
    i. Ajuste el modelo transformando todas las variables num칠ricas con la funci칩n
    logar칤tmica. 쮺칩mo afecta esta transformaci칩n la interpretaci칩n de los coeficientes?
    i. Estime _ELPD_ mediante _PSIS-CV_ con la funci칩n `loo()`. Concluya acerca de la 
    estabilidad del c칩mputo. 쮼s posible comparar la la estimaci칩n con la obtenida en el 
    inciso iv? 쯇or qu칠?
    i. Con ambos modelos, obtenga y grafique la distribuci칩n predictiva _a posteriori_
    compar치ndola con los datos observados 쮺u치l de los modelos representa mejor a los datos?

    ```{r}
    #| echo: false
    #| out.width: 70%
    #| fig-align: center
    #| fig-cap: !expr captions[["mesquite"]]
    if (is_html) knitr::include_graphics(file.path("imgs", "mesquite.png"))
    ```

    <!-- @Gelman2021 Capitulo 12-->
    <!-- https://avehtari.github.io/ROS-Examples/Mesquite/mesquite.html -->

1.  游빌 **Secundarios en Portugal**

    Se cuenta con un conjunto de datos sobre 343 estudiantes de secundaria de Portugal 
    (`portugal`) y se desea predecir la calificaci칩n final en matem치ticas del 칰ltimo a침o
    en base a un gran n칰mero de predictores potencialmente relevantes. 

    El listado de variables se compone por: escuela del estudiante, sexo del estudiante, 
    edad del estudiante, tipo de domicilio del estudiante, tama침o de la familia, 
    estado de convivencia de los padres, educaci칩n de la madre, educaci칩n del padre, 
    tiempo de viaje del hogar a la escuela, tiempo de estudio semanal, n칰mero de fracasos 
    escolares pasados, apoyo educativo adicional, clases pagadas adicionales dentro de la 
    materia del curso, actividades extracurriculares, si el estudiante asisti칩 a una 
    guarder칤a, si el estudiante desea cursar estudios superiores, acceso a Internet en el 
    hogar, si el estudiante tiene una relaci칩n rom치ntica, calidad de las relaciones 
    familiares, tiempo libre despu칠s de la escuela, si el estudiante sale con amigos, 
    consumo de alcohol entre semana, consumo de alcohol los fines de semana, 
    estado de salud actual y n칰mero de ausencias escolares. 

    **Priors d칠bilmente informativos**

    i. Ajuste un modelo de regresi칩n lineal utilizando todos los predictores luego de
    estandarizarlos y con los siguientes _priors_:
    $$
    \begin{aligned}
    \beta_k &\sim \text{Normal}(0, 2.5) \\
    \sigma  &\sim \text{Exponential}(1 / \text{std}(y))
    \end{aligned}
    $$

    i. Elabore un gr치fico para visualizar los _posteriors_ marginales y comp치relos.
    쯈u칠 puede concluir acerca de su incertidumbre?
    i. Calcule y compare la mediana del $R^2$ bayesiano y del $R^2$ calculado mediante 
    _LOO_ 쯈u칠 conclusi칩n puede extraer de esta comparaci칩n?
    i. 쮺u치l es el n칰mero efectivo de par치metros seg칰n _LOO_? 쯈u칠 indica?
    i. Obtenga muestras del _prior_ y del _posterior_ del $R^2$ bayesiano, comp치relos
    utilizando una visualizaci칩n y concluya considerando la elecci칩n de los _priors_
    d칠bilmente informativos sobre $\beta_k$ y $\sigma$.

    **Priors alternativos (I)**

    Si se asume que muchos predictores pueden tener poca relevancia, se pueden escalar 
    los _priors_ independientes para que la suma de la varianza de los _priors_ se encuentre
    alrededor de un valor razonable. En este caso, se cuenta con 26 predictores y 
    se podr칤a suponer que la proporci칩n de la varianza explicada por los predictores est치
    alrededor de 0.3. Entonces, un enfoque simple consiste en asignar _priors_ 
    independientes a los coeficientes de regresi칩n con media 0 y desviaci칩n est치ndar
    $\sqrt{0.3/26}\text{sd}(y)$ y un _prior_ exponencial con media 
    $\sqrt{0.7}\text{sd}(y)$ para $\sigma$.


    i. Ajuste el modelo nuevamente utilizando los siguientes priors:
    $$
    \begin{aligned}
    \beta_k &\sim \text{Normal}(0, \sqrt{\frac{0.3}{26}}\text{sd}(y)) \\
    \sigma  &\sim \text{Exponential}(1 / \sqrt{0.7}\text{sd}(y))
    \end{aligned}
    $$
    i. Explore la distribuci칩n _a priori_ sobre $R^2$ y comp치rela con la distribuci칩n
    obtenida con los _priors_ d칠bilmente informativos.
    i. Calcule _ELPD_ mediante _LOO_ y compare este modelo con el anterior.
    i. Elabore un gr치fico para visualizar los _posteriors_ marginales. Compare este 
    resultado con el obtenido con los _priors_ d칠bilmente informativos.

    **Priors alternativos (II)**

    Otra alternativa es asumir que solo algunos de los predictores tienen alta 
    relevancia y que el resto de los predictores tienen una relevancia insignificante.
    Una posibilidad para modelar bajo este supuesto es el _horseshoe prior_ 
    regularizado[^horseshoe]. Este _prior_ utiliza distribuciones normales independientes 
    con media 0 y varianza $\tau^2\lambda_k^2$ para los coeficientes de regresi칩n 
    $\beta_k$ y se describe a continuaci칩n:

    $$
    \begin{aligned}
    \beta_k   &\sim \text{Normal}(0, \tau^2\tilde{\lambda}_k^2) \\
    \tilde{\lambda}_k^2 &= \frac{c^2\lambda_k^2}{c^2 + \tau^2\lambda_k^2} \\
    c & = \sqrt{c'} \text{SS} \\
    c' &\sim \text{InvGamma}(0.5 \cdot SDF, 0.5 \cdot SDF) \\
    \lambda_k &\sim \text{StudentT}^+(\text{df} = 1, \mu = 0, \sigma = 1 ) \\
    \tau      &\sim \text{StudentT}^+(\text{df} = 1, \mu = 0, \sigma = \text{GS})
    \end{aligned}
    $$

    con
    $$
    \begin{aligned}
    \text{GS} = \frac{p_0}{p - p_0} \frac{\sigma}{\sqrt{n}} \\
    \text{SS} = \sqrt{\frac{0.3}{p_0}} \text{sd}(y) \\
    \text{SDF} = 4
    \end{aligned}
    $$

    donde $\text{GS}$, $\text{SS}$ y $\text{SDF}$ representan _global scale_, _slab scale_ y
    _slab degrees of freedom_, respectivamente. Adem치s, $p$ representa la cantidad de 
    predictores, 26, y $p_0$ la cantidad de predictores que se espera que sean relevantes.

    Intuitivamente, el par치metro global $\tau$ empuja todos los $\beta_k$ hacia el 0, 
    mientras que los par치metros locales $\lambda_k$ contribuyen a que algunos de los 
    $\beta_k$ escapen del 0.

    i. Utilice $p_0 = 6$ para ajustar el modelo con todos los predictores y grafique
    y analice los _posteriors_ marginales.
    i. Compare este modelo con los ajustados anteriormente en base a sus _ELPD_ estimados
    con _LOO_ y concluya.

    **Priors d칠bilmente informativos con menos predictores**

    Ajuste el modelo de regresi칩n con un subconjunto de predictores que crea conveniente
    y los _priors_ d칠bilmente informativos que se utilizaron inicialmente.

    i. Visualice los _posteriors_ marginales.
    i. Nuevamente, calcule y compare la mediana del $R^2$ bayesiano y del $R^2$ calculado 
    mediante.
    i. Compare este modelo con el ajustado anteriormente en base a sus _ELPD_ estimados
    con _LOO_ y concluya sobre la capacidad predictiva de este modelo.

    <!-- Nota: A la hora de pasar `scale_global` a `horseshoe` de `brms` no hay que incluir
    `sigma` porque eso pasa internamente (mostrar como buscar la ayuda online) -->

    <!-- @Gelman2021 Capitulo 12 -->



[^horseshoe]: El nombre _horseshoe_ (herradura) no se relaciona con la forma de la funci칩n
    de densidad en s칤, sino con la forma del _prior_ impl칤cito para los coeficientes de 
    _shrinkage_ (contracci칩n) aplicados a cada par치metro.

<!-- 
1.  **Ejercicio donde haya sobre-ajuste**

    Idea: Utilizar priors estrechos para prevenir sobre-ajuste?


Lo que falta:

* Eleccion de distribuciones a priori
    * Priors de regularizacion (e.g. cuando hay muchos predictores num칠ricos)
* Sobreajuste y subajuste
* Deberiamos ver como escribimos lo de "estimar elpd con loo" porque es ambiguo.
  La documentacion de la funcion dice
  "compute PSIS-LOO CV, efficient approximate leave-one-out (LOO) cross-validation for 
  Bayesian models using Pareto smoothed importance sampling (PSIS)
  
  Returns:
  A matrix with two columns (Estimate, SE) and three rows (elpd_loo, p_loo, looic). 
  This contains point estimates and standard errors of the expected log pointwise 
  predictive density (elpd_loo), the effective number of parameters (p_loo) and the 
  LOO information criterion looic (which is just -2 * elpd_loo, i.e., converted to deviance scale).
  "
-->

<!-- 
Unidad 4: Modelos Lineales
Modelos lineales. Elecci칩n de distribuciones a priori. Regularizaci칩n. Diagn칩stico de modelos. Predicciones basadas en distribuciones de probabilidad. Pruebas predictivas a priori y a posteriori. Densidad predictiva a posteriori logar칤tmica evaluada punto a punto (lppd). Deviance. Criterios de informaci칩n: AIC, BIC, WAIC. Validacion cruzada. Sobreajuste y subajuste. Validaci칩n cruzada utilizando muestreo por importancia mediante suavizado Pareto (PSIS-CV). 
-->
