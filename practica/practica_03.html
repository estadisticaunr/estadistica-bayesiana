<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>EstadÃ­stica Bayesiana - PrÃ¡ctica - Unidad 3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../practica/practica_04.html" rel="next">
<link href="../practica/practica_02.html" rel="prev">
<link href="../utils/imgs/favicon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la bÃºsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">EstadÃ­stica Bayesiana</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Buscar"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="NavegaciÃ³n de palanca" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../info/programa.html"> 
<span class="menu-text">InformaciÃ³n</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../teoria/u1_teoria_01.html"> 
<span class="menu-text">TeorÃ­a</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../practica/practica_00.html" aria-current="page"> 
<span class="menu-text">PrÃ¡ctica</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../trabajos_practicos/descripcion.html"> 
<span class="menu-text">Trabajos PrÃ¡cticos</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../recursos/codigo/index.html"> 
<span class="menu-text">Recursos</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/estadisticaunr/estadistica-bayesiana"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../practica/practica_03.html">Unidad 3</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="quarto-sidebar-header"><div class="sidebar-header-item">
<p>PrÃ¡ctica</p>
</div></div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../practica/practica_00.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unidad 0</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../practica/practica_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unidad 1</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../practica/practica_02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unidad 2</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../practica/practica_03.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Unidad 3</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../practica/practica_04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unidad 4</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../practica/practica_05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unidad 5</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    <div class="quarto-alternate-formats"><h2>Otros formatos</h2><ul><li><a href="practica_03.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">PrÃ¡ctica - Unidad 3</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="mÃ©todos-computacionales" class="level2">
<h2 class="anchored" data-anchor-id="mÃ©todos-computacionales">ğŸ’» MÃ©todos Computacionales</h2>
<p>Esta secciÃ³n contiene una lista exhaustiva de ejercicios que requieren el uso de herramientas computacionales para resolver problemas que involucran una variedad de cÃ¡lculos, como el cÃ¡lculo de probabilidades y el cÃ¡lculo de integrales. Se vuelve indispensable el uso de R y se promueve el uso de buenas prÃ¡cticas de programaciÃ³n cientÃ­fica, como el uso de funciones compartimentar los componentes de un programa.</p>
<ol type="1">
<li><p>ğŸ“Œ <strong>Â¡A calcular probabilidades! (I)</strong></p>
<p>Sea <span class="math inline">\(X \sim \text{Normal}(\mu=3, \sigma=1.2)\)</span>.</p>
<ol type="i">
<li>Elabore un grÃ¡fico que permita visualizar la funciÃ³n de densidad de probabilidad de <span class="math inline">\(X\)</span>.</li>
<li>Â¿CuÃ¡l es la probabilidad de que <span class="math inline">\(X\)</span> sea menor a 2.5?</li>
<li>Â¿CuÃ¡l es la probabilidad de que <span class="math inline">\(X\)</span> sea mayor a 4?</li>
<li>Â¿CuÃ¡l es la probabilidad de que <span class="math inline">\(X\)</span> sea mayor 2 y menor 3?</li>
</ol></li>
<li><p>ğŸ“Œ <strong>Â¡A calcular probabilidades! (II)</strong></p>
<p>Sea <span class="math inline">\(X \sim \text{Beta}(\alpha=10, \beta=2)\)</span>.</p>
<ol type="i">
<li>Elabore un grÃ¡fico que permita visualizar la funciÃ³n de densidad de probabilidad de <span class="math inline">\(X\)</span>.</li>
<li>Â¿CuÃ¡l es la probabilidad de que <span class="math inline">\(X\)</span> sea menor a 0.5?</li>
<li>Â¿CuÃ¡l es la probabilidad de que <span class="math inline">\(X\)</span> sea mayor a 0.8?</li>
<li>Â¿CuÃ¡l es la probabilidad de que <span class="math inline">\(X\)</span> sea mayor 0.25 y menor 0.75?</li>
</ol></li>
<li><p>ğŸ“Œ <strong>Magia blanca: Obtener probabilidades mediante simulaciÃ³n</strong></p>
<p>Responda los dos puntos anteriores sin evaluar la funciÃ³n de densidad ni la funciÃ³n de distribuciÃ³n de las variables aleatorias mencionadas. Para eso genere muestras que provengan de las correspondientes distribuciones y utilÃ­celas para responder las preguntas mencionadas. Reflexione sobre las ventajas y desventajas de utilizar un enfoque basado en la simulaciÃ³n para resolver problemas.</p></li>
<li><p>ğŸ“Œ <strong>Media y varianza de una variable aleatoria</strong></p>
<p>Una variable aleatoria <span class="math inline">\(X\)</span> toma valores en el conjunto <span class="math inline">\(\{2, 4, 6, 8, 10\}\)</span> con igual probabilidad. Encuentre la media y el desvÃ­o estÃ¡ndar de las variables <span class="math inline">\(X\)</span> e <span class="math inline">\(Y = 2X + 1\)</span>. <!-- Tal vez se puede hacer un poco mÃ¡s difÃ­cil si hacemos que la funciÃ³n sea no-lineal --></p></li>
<li><p>ğŸ“Œ <strong>Probabilidades <em>a posteriori</em></strong></p>
<p>En un problema determinado la distribuciÃ³n <em>a posteriori</em> de la parÃ¡metro de inteÅ•es <span class="math inline">\(\alpha\)</span> es <span class="math inline">\(\Gamma(k=3, \theta=1.5)\)</span>, donde <span class="math inline">\(k\)</span> es el parÃ¡metro de forma y <span class="math inline">\(\theta\)</span> es el parÃ¡metro de escala. Calcule la probabilidad de que <span class="math inline">\(\alpha^2\)</span> sea mayor a 10. <!-- https://stats.stackexchange.com/questions/154135/square-of-gamma-random-variable --></p></li>
<li><p>ğŸ“Œ <strong>Probabilidades con dos variables aleatorias</strong></p>
<p>Sean <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> dos variables aleatorias independientes con distribuciÃ³n uniforme en el intervalo <span class="math inline">\([0, 1]\)</span>.</p>
<ol type="i">
<li>Â¿CuÃ¡l es la probabilidad de que <span class="math inline">\(X \le Y\)</span>?</li>
<li>Grafique los puntos muestreados coloreando de acuerdo a si la muestra satisface el evento antes mencionado o no.</li>
</ol></li>
<li><p><strong>Te veo en la fotocopiadora</strong></p>
<p>Dos estudiantes de estadÃ­stica deciden encontrarse en la fotocopiadora de la Facultad entre las 10 y las 11 de la maÃ±ana, eligiendo el tiempo de llegada al azar. La estudiante A esperarÃ¡ 10 minutos luego de llegar. Si el estudiante B no llega en ese intervalo, se irÃ¡. Lo mismo hace el estudiante B, pero este decide esperar 14 minutos. Â¿CuÃ¡l es la probabilidad de que se produzca el encuentro en la fotocopiadora entre la estudiante A y el estudiante B?</p></li>
<li><p>ğŸ§© <strong>Armando celulares en Tierra del Fuego</strong></p>
<p>Una mÃ¡quina que se utiliza para ensamblar telÃ©fonos celulares en una fÃ¡brica en Tierra del Fuego cuenta con tres componentes crÃ­ticos para su funcionamiento. Ante una falla en cualquiera de estos componentes, la mÃ¡quina se detiene. Las probabilidades de que estos elementos operen correctamente durante un dÃ­a cualquiera son <span class="math inline">\(p_1 = 0.8\)</span>, <span class="math inline">\(p_2 = 0.9\)</span> y <span class="math inline">\(p_3 = 0.7\)</span>. Responda las siguientes preguntas utilizando tÃ©cnicas de simulaciÃ³n:</p>
<ol type="i">
<li>Â¿CuÃ¡l es la probabilidad de que la mÃ¡quina falle en el primer dÃ­a de uso?</li>
<li>Â¿CuÃ¡l es la probabilidad de que la mÃ¡quina siga funcionando luego de 10 dÃ­as?</li>
<li>Â¿CuÃ¡l es la probabilidad de que la mÃ¡quina falle en el dÃ­a 7 de uso?</li>
<li>Sea <span class="math inline">\(T=\)</span> Cantidad de dÃ­as que la mÃ¡quina funciona ininterrumpidamente. Grafique la funciÃ³n de densidad de probabilidad de <span class="math inline">\(T\)</span>.</li>
</ol></li>
<li><p><strong>Bolas infinitas</strong></p>
<p><a href="https://twitter.com/pgroisma/status/1616137795180822528">Este tuit</a> propone un problema muy interesante. Una urna contiene una bola azul y una amarilla. Se elije una bola al azar y se la vuelve a colocar junto con otra bola adicional del mismo color. Se repite este proceso indefinidamente. Â¿QuÃ© ocurre con la proporciÃ³n de bolas azules en la urna a medida que repetimos mÃ¡s y mÃ¡s veces?</p>
<ol type="i">
<li>Tiende a 1/2.</li>
<li>Tiende a 0 Ã³ a 1.</li>
<li>No se estabiliza.</li>
<li>Ninguna de las anteriores.</li>
</ol>
<p>Escriba un programa en R para responder esta pregunta utilizando simulaciones. Genere grÃ¡ficos que faciliten la comprensiÃ³n del resultado. <!-- https://twitter.com/pgroisma/status/1616820135313932288 --></p></li>
<li><p>ğŸ“Œ <strong>Estimando el valor de</strong> <span class="math inline">\(\pi\)</span></p>
<p>Imagine un cÃ­rculo de radio <span class="math inline">\(r\)</span> y un cuadrado de lado <span class="math inline">\(2r\)</span>, ambos centrados en el mismo punto, que de manera arbitraria puede ser el punto <span class="math inline">\((0, 0)\)</span>. Obtenga muestras de una distribuciÃ³n uniforme en el plano <span class="math inline">\((x, y)\)</span>, cuyo dominio estÃ¡ acotado por el cuadrado antes mencionado. Para cada muestra extraida, determine si se encuentra dentro del cÃ­rculo o no â€“ todos las muestras se encontrarÃ¡n dentro del cuadrado. Utilice esta informaciÃ³n para estimar el valor de <span class="math inline">\(\pi\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="practica_03_files/figure-html/circulo-cuadrado-pi-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="432"></p>
</figure>
</div>
</div>
</div>
<p>Algunos datos Ãºtiles</p>
<ul>
<li>Area de un cÃ­rculo: <span class="math inline">\(\pi \cdot r^2\)</span>.</li>
<li>Area de un cuadrado: <span class="math inline">\(a^2\)</span>, donde <span class="math inline">\(a\)</span> es la longitud del lado.</li>
</ul></li>
<li><p><strong>Los puntos uniformes</strong></p>
<p>Se seleccionan dos puntos de manera uniforme e independiente dentro de un cÃ­rculo. Â¿CuÃ¡l es la probabilidad de que la distancia entre dos puntos sea menor al radio?</p>
<ol type="i">
<li>Resuelva el problema utilizando R.</li>
<li>Elabore una visualizaciÃ³n que facilite la comunicaciÃ³n de los resultados.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ayuda
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>TO DO Algo sobre como simular de una uniforme en 2d</p>
</div>
</div>
</div></li>
<li><p><strong>Sobre el histÃ³rico 7 a 1 del 2014</strong></p>
<p>En la Copa del Mundo de la FIFA 2014, Alemania jugÃ³ contra Brasil en la semifinal. Los alemanes hicieron el primer gol a los 11 minutos y el segundo a los 23. Asuma que el tiempo entre goles sigue una distribuciÃ³n exponencial. Elija una distribuciÃ³n <em>a priori</em> para el tiempo entre goles (puede ser conjugada o no). En ese momento del partido,</p>
<ol type="i">
<li>Â¿CuÃ¡l es la distribuciÃ³n <em>a posteriori</em> del tiempo entre goles de Alemania?</li>
<li>Â¿CuÃ¡ntos goles cabrÃ­a esperar que Alemania hiciera al finalizar los 90 minutos?</li>
<li>Â¿CuÃ¡l era la probabilidad de que Alemania hiciera mÃ¡s de 5 goles (cosa que ocurriÃ³)? <!-- http://allendowney.github.io/ThinkBayes2/chap08.html --></li>
</ol></li>
<li><p>ğŸ’» <strong>Â¿TendrÃ© que esperar mucho?</strong></p>
<p>El tiempo que un empleado de recursos humanos demora en hacer una entrevista tiene distribuciÃ³n exponencial con media 30 minutos. Los tiempos de duraciÃ³n de cada entrevista se pueden considerar independientes entre sÃ­. Las entrevistas a postulantes para un trabajo estÃ¡n programadas cada 15 minutos, comenzando desde las 8. Es vÃ¡lido considerar que todos los postulantes llegan puntuales a su entrevista. Cuando la persona del turno de las 8:15 llega a la oficina</p>
<ol type="i">
<li>Â¿CuÃ¡l es la probabilidad de que tenga que esperar antes de ser entrevistada?</li>
<li>Â¿CuÃ¡l es el horario esperado al que terminarÃ¡ su entrevista? <!-- Modern Data Science with R --></li>
</ol></li>
<li><p>ğŸ§© <strong>Â¡QuÃ© casualidad!</strong></p>
<p>Dos personas se conocen en la fila de embarque para un vuelo en un aviÃ³n Airbus A330-300. Considere que el Airbus A330-300 tiene 30 filas de 2-4-2 asientos.</p>
<ol type="i">
<li>Â¿CuÃ¡l es la probabilidad de que tengan asientos en la misma fila?</li>
<li>Â¿CuÃ¡l es la probabilidad de que estÃ©n sentados en asientos adyacentes?</li>
</ol></li>
<li><p>âœï¸ ğŸ’» ğŸ“Œ <strong>El Problema de Monty Hall</strong></p>
<p>El Problema de Monty Hall es un problema de probabilidad basado en un juego del concurso televisivo estadounidense â€œTrato hechoâ€. En este problema, el concursante debe elegir una puerta entre tres, todas cerradas. El premio consiste en llevarse lo que se encuentra detrÃ¡s de la elegida. Se sabe con certeza que tras una de ellas se oculta un automÃ³vil, y tras las otras dos hay cabras. Una vez que el concursante haya elegido una puerta y comunicado su elecciÃ³n a los presentes, el presentador, que sabe lo que hay detrÃ¡s de cada puerta, abrirÃ¡ una de las otras dos en la que haya una cabra. A continuaciÃ³n, le da la opciÃ³n al concursante de cambiar, si lo desea, de puerta (tiene dos opciones). Â¿Debe el concursante mantener su elecciÃ³n original o escoger la otra puerta? Â¿Hay alguna diferencia? Resuelva este ejercicio utilizando simulaciones. <!-- Modern Data Science with R --></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/monty_hall.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
<figcaption>Las 3 puertas del problema de Monty Hall</figcaption>
</figure>
</div>
</div>
</div></li>
<li><p>ğŸ’» <strong>Que los cumplan feliz</strong></p>
<p>BasÃ¡ndose en el <a href="https://twitter.com/Kit_Yates_Maths/status/1542767039814713346">siguiente tuit</a> y conociendo el problema del cumpleaÃ±os (Â¿cuÃ¡ntas personas debe haber en una habitaciÃ³n para que la probabilidad de que dos de ellas cumplan aÃ±os el mismo dÃ­a sea mayor a X%?) construir un grÃ¡fico similar al del tuit donde se grafique la probabilidad de que haya <span class="math inline">\(n\)</span> personas que cumplan aÃ±os el mismo dÃ­a para <span class="math inline">\(K\)</span> personas presentes en la habitaciÃ³n.</p></li>
<li><p>ğŸ’» <strong>QuÃ© suerte, Â¿no?</strong></p>
<p>Previo a la final de la Copa AmÃ©rica 2021, los jugadores de la SelecciÃ³n Argentina se reÃºnen en la habitaciÃ³n del hotel como se describe en <a href="https://twitter.com/PlanetaDeCABJ/status/1587925636869300224">este tuit</a>.</p>
<ol type="i">
<li>Â¿CuÃ¡l es la probabilidad de que un jugador adivine una de diez cartas?</li>
<li>Â¿CuÃ¡l es la probabilidad de que tres de ellos adivinen una de diez cartas?</li>
</ol></li>
<li><p><strong>El Ã¡lbum del CampeÃ³n</strong></p>
<p>El Ã¡lbum oficial del Mundial de FÃºtbol de Qatar 2022 consta de 638 figuritas. Cada paquete trae cinco figuritas.</p>
<ol type="i">
<li>Comprando cinco paquetes, Â¿cuÃ¡l es la probabilidad de tener a Messi?</li>
<li>Comprando cinco paquetes, Â¿cuÃ¡l es la probabilidad de sacar a Messi repetido?</li>
<li>Â¿CuÃ¡ntos paquetes se necesitan, en promedio, para completar el Ã¡lbum?</li>
<li>Si a una persona le faltan diez figuritas para completar el Ã¡lbum, Â¿cuÃ¡ntos paquetes tiene que comprar para asegurarse de lograrlo?</li>
</ol></li>
<li><p>ğŸ’» <strong>Â¿Que tÃ¡n raras son estas secuencias raras?</strong></p>
<p>Si se arroja una moneda <span class="math inline">\(n\)</span> veces, Â¿cuÃ¡l es la probabilidad de que no haya secuencias de <span class="math inline">\(k\)</span> caras?</p></li>
<li><p>ğŸ“Œ <strong>Un viaje por el elevador</strong></p>
<p>Â¿CuÃ¡l es la probabilidad de que tres personas en un ascensor con doce pisos presionen para ir a tres pisos consecutivos? Â¿QuÃ© supuestos realiza para resolver el problema? EscrÃ­balos en una lista de manera explÃ­cita.</p></li>
<li><p><strong>La vida es muy corta como para perderla ordenando medias</strong></p>
<p>Un cajÃ³n contiene 10 pares de medias. No hay dos pares iguales. Por fiaca, el dueÃ±o de las medias no las agrupa despuÃ©s de lavarlas y simplemente las pone en el cajÃ³n. Al momento de necesitar un par de medias, saca una tras una hasta que se forma un par. En promedio, Â¿cuÃ¡ntas medias sacarÃ¡ hasta encontrar un par? <!-- https://fivethirtyeight.com/features/can-you-find-a-matching-pair-of-socks/ --></p></li>
<li><p><strong>Â¿Vale la pena hacer un ensayo clÃ­nico a gran escala?</strong></p>
<p>Dados los resultados de un estudio piloto, la probabilidad <em>a posteriori</em> de que la droga desarrollada por tu compaÃ±Ã­a sea mas efectiva que el tratamiento actual es <span class="math inline">\(\theta \in [0, 1]\)</span>. Tu compaÃ±Ã­a estÃ¡ considerando realizar un ensayo clÃ­nico a gran escala para confirmar que la droga que desarrollan es de hecho mejor. El costo del estudio es <strong>$X</strong>. Si la droga es mejor, la probabilidad de que esto se confirme en el ensayo es del 80%. Si la droga no es mejor, hay una probabilidad del 5% de que el estudio confirme que es mejor. Si el ensayo sugiere que tu droga es mejor, ganarÃ¡s <strong>$cX</strong>. Â¿Para quÃ© valores de <span class="math inline">\(\theta\)</span> y <span class="math inline">\(c\)</span> tiene sentido realizar el estudio? <!-- @Reich2020 --></p></li>
<li><p><strong>El problema de concordancia</strong></p>
<p>Resuelva el problema de concordancia de de Montmort presentado en la <strong>PrÃ¡ctica 0</strong> utilizando simulaciones. <!-- Blitzstein, Introdudction to Probability --></p></li>
<li><p><strong>El problema de los sobres</strong></p>
<p>Resuelva el problema de los dos sobres presentado en la <strong>PrÃ¡ctica 0</strong> utilizando simulaciones.</p></li>
<li><p>ğŸ§© <strong>IntegraciÃ³n por muestreo</strong></p>
<p>Calcule las siguientes integrales utilizando muestras.</p>
<ol type="i">
<li><span class="math inline">\(\displaystyle \int_{-\infty}^{\infty}{\frac{x^2}{\sqrt{2\pi}}\exp \left(-\frac{x^2}{2} \right)dx}\)</span></li>
<li><span class="math inline">\(\displaystyle \int_{1}^{\infty}{\frac{x^3}{\sqrt{2\pi}}\exp \left(-\frac{x^2}{2} \right)dx}\)</span></li>
<li><span class="math inline">\(\displaystyle \int_{1}^{\infty}{\frac{x^6}{\sqrt{2\pi}}\exp \left(-\frac{x^2 - 4x}{2} \right)dx}\)</span></li>
<li><span class="math inline">\(\displaystyle \int_{1}^{10}{x^6\frac{e^{-x^4/2}}{\sqrt{2\pi}}dx}\)</span> <!-- @Lambert2018 Capitulo 9 --></li>
</ol></li>
<li><p>Â¿CuÃ¡l es la distribuciÃ³n de muestreo aproximada al usar muestreo independiente para evaluar integrales? <!-- @Lambert2018 Capitulo 9 --></p></li>
</ol>
</section>
<section id="aproximaciÃ³n-de-una-distribuciÃ³n-mediante-una-grilla" class="level2">
<h2 class="anchored" data-anchor-id="aproximaciÃ³n-de-una-distribuciÃ³n-mediante-una-grilla">ğŸ’» AproximaciÃ³n de una distribuciÃ³n mediante una grilla</h2>
<p>En esta parte de la prÃ¡ctica se comienza a utilizar tÃ©cnicas computacionales que se asocian directamente a la prÃ¡ctica de la estadÃ­stica bayesiana. Los problemas tienen como objetivo la familiarizaciÃ³n con el uso prÃ¡ctico de estas tÃ©cnicas y la comprensiÃ³n de sus caracterÃ­sticas principales.</p>
<ol type="1">
<li><p>ğŸ“Œ <strong>AproximaciÃ³n de grilla</strong></p>
<p>Se tiene un experimento binomial donde <span class="math inline">\(n=80\)</span> y se observan <span class="math inline">\(y=7\)</span> Ã©xitos. Considere que el <em>prior</em> de la probabilidad de Ã©xito <span class="math inline">\(\theta\)</span> es <span class="math inline">\(\text{Beta}(2, 10)\)</span>.</p>
<ol type="i">
<li>Obtenga la distribuciÃ³n <em>a posteriori</em> de <span class="math inline">\(\theta\)</span> de manera analÃ­tica y grafÃ­quela.</li>
<li>Obtenga la distribuciÃ³n <em>a posteriori</em> de <span class="math inline">\(\theta\)</span> utilizando el mÃ©todo de la grilla en base a una grilla de 10 puntos y dibuje la curva obtenida en el grÃ¡fico creado anteriormente.</li>
<li>Repita el proceso del punto anterior utilizando una grilla de 100 puntos.</li>
<li>Concluya sobre la fidelidad de las aproximaciones. Â¿Considera que es necesario utilizar una grilla mÃ¡s densa? Â¿CuÃ¡les serÃ­an las ventajas y desventajas?</li>
</ol></li>
<li><p>ğŸ“Œ <strong>CÃ¡lculo de probabilidades en base a la grilla (I)</strong></p>
<p>En base al <em>posterior</em> obtenido en el ejercicio anterior mediante el mÃ©todo de la grilla calcule las siguientes probabilidades</p>
<ul>
<li><span class="math inline">\(P(\theta &lt; 0.7)\)</span>.</li>
<li><span class="math inline">\(P(\theta &gt; 0.05)\)</span>.</li>
<li><span class="math inline">\(P(0.05 &lt; \theta &lt; 0.15)\)</span>.</li>
</ul>
<p>De ser necesario, obtenga el <em>posterior</em> mediante una grilla de mayor densidad.</p></li>
<li><p>ğŸ“Œ <strong>CÃ¡lculo de probabilidades en base a la grilla (II)</strong></p>
<p>Utilice los valores de la grilla y sus probabilidades <em>a posteriori</em> para obtener muestras del <em>posterior</em> y calcular las mismas probabilidades que en el ejercicio anterior en base a muestras. Ayuda: Para obtener muestras utilice la funciÃ³n <code>sample()</code>.</p></li>
<li><p>ğŸ“Œ <strong>AproximaciÃ³n de grilla en 2 dimensiones</strong></p>
<p>Sean dos variables aleatorias continuas <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> tales que <span class="math inline">\((X, Y) \in \mathbb{R}^2\)</span>, y sea el siguiente modelo de regresiÃ³n lineal simple:</p>
<p><span class="math display">\[
\begin{aligned}
\alpha &amp;\sim \text{Normal}(0, 1.5) \\
\beta  &amp;\sim \text{Normal}(0, 2) \\
Y      &amp;\sim \text{Normal}(\alpha + \beta X, 0.8)
\end{aligned}
\]</span></p>
<ol type="i">
<li>Obtenga el <em>posterior</em> conjunto del vector de parÃ¡metros <span class="math inline">\([\alpha, \beta]^T\)</span> mediante el mÃ©todo de la grilla. Elabore un grÃ¡fico que permita visualizar esta distribuciÃ³n.</li>
<li>Obtenga el <em>posterior</em> marginal de <span class="math inline">\(\alpha\)</span> y grafÃ­quelo.</li>
<li>Obtenga el <em>posterior</em> marginal de <span class="math inline">\(\beta\)</span> y grafÃ­quelo.</li>
<li>Calcule la probabilidad de que el intercepto sea mayor a 0.95.</li>
<li>Calcule la probabilidad de que la pendiente sea menor a -2.</li>
</ol>
<p>Para responder las consignas utilice los datos simulados que se obtienen con el siguiente bloque de cÃ³digo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">121195</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">80</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, alpha <span class="sc">+</span> beta <span class="sc">*</span> x, sigma)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Bonus:</strong> Â¿CÃ³mo podrÃ­a responder las consignas (ii)-(v) utilizando muestras del <em>posterior</em>?</p></li>
<li><p>ğŸ“Œ <strong>Escalando la aproximaciÃ³n de la grilla</strong></p>
<p>Suponga que se tiene que estimar un <em>posterior</em> utilizando la aproximaciÃ³n mediante una grilla de 200 puntos en cada dimensiÃ³n. Calcule cÃºantas veces se tiene que evaluar el posterior en cada uno de los siguientes escenarios:</p>
<ol type="i">
<li>1 dimensiÃ³n.</li>
<li>2 dimensiones.</li>
<li>3 dimensiones.</li>
<li>5 dimensiones.</li>
<li>10 dimensiones.</li>
</ol>
<p>Concluya sobre las ventajas y desventajas de la aproximaciÃ³n de la grilla teniendo en cuenta sus caracterÃ­sticas conforme se incrementa el nÃºmero de dimensiones del <em>posterior</em>.</p></li>
<li><p><strong><em>Benchmark</em> de la aproximaciÃ³n de la grilla</strong></p>
<p>El siguiente bloque de cÃ³digo define una funciÃ³n llamada <code>create_and_eval_grid()</code> que evalÃºa la funciÃ³n de densidad normal en una cantidad arbitraria dimensiones. El argumento <code>dimension_n</code> indica la dimensionalidad de la distribuciÃ³n normal, y <code>grid_n</code> indica la cantidad de puntos en la grilla de cada dimensiÃ³n. Debajo, se utiliza la funciÃ³n <code>mark()</code> del paquete <code>{bench}</code> para comparar el desempeÃ±o de la funciÃ³n <code>create_and_eval_grid()</code> con diferentes nÃºmeros de dimensiones.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>create_and_eval_grid <span class="ot">&lt;-</span> <span class="cf">function</span>(dimension_n, <span class="at">grid_n =</span> <span class="dv">100</span>) {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length.out =</span> grid_n)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    grids <span class="ot">&lt;-</span> <span class="fu">replicate</span>(dimension_n, grid, <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(grids, <span class="at">KEEP.OUT.ATTRS =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    Mu <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, dimension_n)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    Sigma <span class="ot">&lt;-</span> <span class="fu">diag</span>(dimension_n)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    mvtnorm<span class="sc">::</span><span class="fu">dmvnorm</span>(df, <span class="at">mean =</span> Mu, <span class="at">sigma =</span> Sigma)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>bench<span class="sc">::</span><span class="fu">mark</span>(</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">create_and_eval_grid</span>(<span class="dv">1</span>),</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">create_and_eval_grid</span>(<span class="dv">2</span>),</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">check =</span> <span class="cn">FALSE</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_iterations =</span> <span class="dv">500</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Modifique el cÃ³digo brindado para evaluar la funciÃ³n de densidad en hasta un mÃ¡ximo de 10 dimensiones. Concluya sobre el tiempo de ejecuciÃ³n, el consumo de memoria, y otras cantidades que se encuentren en la salida y crea adecuadas para el anÃ¡lisis.</p></li>
</ol>
<!-- 
TO DO

1.  Grid approximation para una _skew-normal_. Estimar los parÃ¡metros $\xi$ (posiciÃ³n), 
    $\omega$ (escala) y $\alpha$ (asimetrÃ­a).
    
    $$
    f(x) = \frac{2}{\omega} \phi\left(\frac{x-\xi}{\omega}\right)\Phi\left( \alpha \frac{x-\xi}{\omega} \right)
    $$
    https://en.wikipedia.org/wiki/Skew_normal_distribution 

-->
</section>
<section id="sec-mh" class="level2">
<h2 class="anchored" data-anchor-id="sec-mh">ğŸ’» <strong>Metropolis-Hastings</strong></h2>
<!--
Copio algunos pasajes del libro porque la verdad me parece super claro. 
Puede ser Ãºtil para la presentaciÃ³n de teorÃ­a.
Although not as efficient as independent sampling, dependent sampling is easier to 
implement, and only requires calculation of the un-normalised posterior, avoiding the 
troublesome denominator term

We also know that MCMC is typically used to do dependent sampling. It is called Monte Carlo 
because the decision of where to step next involves a random component

In this chapter we see that there are two components to this decision: 
in the first, we choose _where_ to propose a next step from the current position; 
in the second, we choose _whether_ we accept this step or stay where we are
@Lambert2018
-->
<!--
El algoritmo Metropolis es un caso especial del algoritmo general Metropolis-Hastings 
(Hoff, 2009). La principal diferencia es que el algoritmo Metropolis-Hastings no tiene el 
requisito de distribuciÃ³n simÃ©trica.
-->
<p>En esta secciÃ³n, se profundiza en la prÃ¡ctica de uno de los algoritmos fundamentales de la inferencia estadÃ­stica bayesiana: el algoritmo de Metropolis-Hastings.</p>
<ol type="1">
<li><p>ğŸ“Œ <strong>Muestreo utilizando el algoritmo de Metropolis-Hastings (I)</strong></p>
<p>Use el algoritmo de Metropolis-Hastings y una distribuciÃ³n de propuesta <span class="math inline">\(\text{Normal}(0, 0.1)\)</span> para obtener 5000 muestras de las siguientes distribuciones de probabilidad:</p>
<ol type="i">
<li><span class="math inline">\(\text{Normal}(\mu = 3, \sigma = 6)\)</span>.</li>
<li><span class="math inline">\(\text{StudentT}(\nu = 5)\)</span>.</li>
<li><span class="math inline">\(\frac{2}{3}\text{Normal}(\mu = 0, \sigma = 0.5) + \frac{1}{3}\text{Normal}(\mu = 3, \sigma = 2)\)</span>.</li>
</ol>
<p>Grafique las distribuciones obtenidas utilizando un histograma o una estimaciÃ³n de densidad y superponga la funciÃ³n de densidad verdadera para realizar una comparaciÃ³n. Concluya sobre la similitud de las mismas y la aptitud de la distribuciÃ³n de propuesta utilizada.</p></li>
<li><p>ğŸ“Œ <strong>Simplificando el algoritmo de Metropolis-Hastings</strong></p>
<p>La distribuciÃ³n de propuesta utilizada en el ejercicio anterior goza de una propiedad que permite simplificar el algoritmo de Metropolis-Hastings.</p>
<ol type="i">
<li>Â¿CuÃ¡l es esta propiedad?</li>
<li>Â¿QuÃ© simplificaciÃ³n se puede hacer?</li>
<li>Â¿QuÃ© nombre recibe la versiÃ³n simplificada del algoritmo?</li>
<li>Implemente la versiÃ³n simplificada del algoritmo de Metropolis-Hastings y obtenga nuevamente 5000 muestras para las distribuciones presentadas en el ejercicio anterior utilizando la nueva implementaciÃ³n.</li>
</ol></li>
<li><p>ğŸ“Œ <strong>Muestreo utilizando el algoritmo de Metropolis-Hastings (II)</strong></p>
<p>Use el algoritmo de Metropolis-Hastings y una distribuciÃ³n de propuesta que crea conveniente para obtener 5000 muestras de las siguientes distribuciones de probabilidad:</p>
<ol type="i">
<li><span class="math inline">\(\text{Beta}(\alpha=4, \beta=8)\)</span>.</li>
<li><span class="math inline">\(\text{Gamma}(k = 3, \theta = 2)\)</span>.</li>
<li><span class="math inline">\(\frac{1}{2}\text{Beta}(\alpha=10, \beta=3) + \frac{1}{2}\text{Beta}(\alpha=3, \beta=10)\)</span>.</li>
</ol>
<p>Realice un anÃ¡lisis similar al realizado en el Ejercicio 1.</p></li>
<li><p><strong>Â¡A jugar con la distribuciÃ³n de propuesta!</strong></p>
<p>Suponga que se desea obtener muestras de una distribuciÃ³n <span class="math inline">\(\text{Normal}(4, 1)\)</span> utilizando Metropolis-Hastings y la siguiente distribuciÃ³n de propuesta:</p>
<p><span class="math display">\[
\mu' | \mu \sim \text{Uniforme}(\mu - w, \mu + w)
\]</span></p>
<p>Obtenga <span class="math inline">\(n=5000\)</span> muestras con <span class="math inline">\(w \in \{0.01, 1, 100\}\)</span> y compute la probabilidad de aceptaciÃ³n. Luego, para cada <span class="math inline">\(w\)</span>, grafique la distribuciÃ³n obtenida y visualice la cadena de Markov utilizando un <em>traceplot</em>.</p>
<ul>
<li>Â¿CÃ³mo se relaciona <span class="math inline">\(w\)</span> con el desempeÃ±o del muestreo?</li>
<li>Â¿CÃ³mo se relaciona <span class="math inline">\(w\)</span> con la probabilidad de aceptaciÃ³n? Justifique su respuesta utilizando la ecuaciÃ³n del criterio de aceptaciÃ³n.</li>
</ul></li>
<li><p>ğŸ“Œ <span id="ex-mh-mm"><strong>Modelo Normal-Normal</strong></span></p>
<p>Se desea estudiar el tiempo promedio que los estudiantes de estadÃ­stica dedican por semana a la materia EstadÃ­stica Bayesiana. Para eso se propone utilizar un modelo Normal-Normal, con <span class="math inline">\(\sigma=1.2\)</span> conocido.</p>
<ol type="i">
<li>Elija una distribuciÃ³n <em>a priori</em> para el parÃ¡metro <span class="math inline">\(\mu\)</span>.</li>
<li>Describa el modelo matemÃ¡ticamente.</li>
<li>Determine una distribuciÃ³n de propuesta adecuada para este problema. Explique.</li>
<li>Obtenga 2000 muestras del <em>posterior</em> de <span class="math inline">\(\mu\)</span>. Ajuste los parÃ¡metros de la distribuciÃ³n de propuesta hasta que los resultados se vean adecuados.</li>
<li>Grafique un histograma de las muestras obtenidas y concluya sobre el desempeÃ±o de la aproximaciÃ³n.</li>
</ol>
<p>Para resolver este problema utilice los datos que se leen con el siguiente codigo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"https://raw.githubusercontent.com/estadisticaunr/"</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"estadistica-bayesiana/main/datos/tiempo-estudio-eb.csv"</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>df_estudio <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(url)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>ğŸ“Œ <span id="ex-mh-bb"><strong>Modelo Beta-Binomial</strong></span></p>
<p>Se desea estimar el <em>posterior</em> del parÃ¡metro <span class="math inline">\(\pi\)</span> en el siguiente modelo Beta-Binomial:</p>
<p><span class="math display">\[
\begin{aligned}
Y &amp;\sim \text{Binomial}(n, \pi) \\
\pi &amp;\sim \text{Beta}(2, 3)
\end{aligned}
\]</span></p>
<p>Se observan <span class="math inline">\(n=10\)</span> ensayos de Bernoulli y se registran <span class="math inline">\(y=3\)</span> Ã©xitos. Determine una distribuciÃ³n de propuesta adecuada y obtenga muestras de la distribuciÃ³n <em>a posteriori</em> del parÃ¡metro <span class="math inline">\(\pi\)</span> utilizando el algoritmo de Metropolis-Hastings.</p>
<p>De ser necesario, ajuste los parÃ¡metros de la distribuciÃ³n de propuesta.</p></li>
<li><p>ğŸ“Œ <strong>Modelo Poisson</strong></p>
<p>En el ejercicio <strong>Â¡Ostras! Â¡Estoy haciendo inferencia bayesiana!</strong> de la PrÃ¡ctica 1 se reportÃ³ que la cantidad de especies marinas bivalvas descubiertas cada aÃ±o entre 2010 y 2015 fue 64, 13, 33, 18, 30 y 20.</p>
<p>Sea <span class="math inline">\(Y_t\)</span> la cantidad de especies descubiertas en el aÃ±o <span class="math inline">\(2009 + t\)</span> (e.g.&nbsp;<span class="math inline">\(Y_1 = 64\)</span> es el conteo para el aÃ±o 2010) y el siguiente modelo:</p>
<p><span class="math display">\[
\begin{aligned}
Y_t        &amp;\sim \text{Poisson}(\lambda_t) \\
\lambda_t  &amp;= \exp (\alpha + \beta t) \\
\alpha     &amp;\sim \text{Normal}(0, 10^2) \\
\beta      &amp;\sim \text{Normal}(0, 10^2)
\end{aligned}
\]</span></p>
<p>Ajuste el modelo utilizando Metropolis-Hastings y verifique la convergencia de las cadenas de Markov. <!-- @Reich2020 3.10/3.11  --></p></li>
<li><p>ğŸ“Œ <strong>Metropolis-Hastings multivariado</strong></p>
<p>Use el algoritmo de Metropolis Hastings para obtener 1000 muestras de la distribuciÃ³n <span class="math inline">\(\text{MVN}(\boldsymbol{\mu}, \boldsymbol{\Sigma})\)</span> donde</p>
<p><span class="math display">\[
\begin{array}{cc}
    \boldsymbol{\mu} = \begin{bmatrix}1.2 \\ 0.8 \end{bmatrix}, &amp;
    \boldsymbol{\Sigma} = \begin{bmatrix}3 &amp; 0.2 \\ 0.2 &amp; 2 \end{bmatrix}
\end{array}
\]</span></p>
<p>Utilice una distribuciÃ³n de propuesta <span class="math inline">\(\text{MVN}(\boldsymbol{0}_2, \boldsymbol{I}_2\sigma)\)</span> con <span class="math inline">\(\sigma = 0.2\)</span>.</p></li>
<li><p>ğŸ“Œ <strong>Metropolis-Hastings para regresiÃ³n</strong></p>
<p>Repita el ejercicio <strong>AproximaciÃ³n de grilla en 2 dimensiones</strong> pero utilice Metropolis-Hastings para obtener muestras del <em>posterior</em> en vez del mÃ©todo de la grilla.</p></li>
</ol>
<!-- 1.  **DemostraciÃ³n sobre la distribuciÃ³n estacionaria**
    
    Demostrar que la distribuciÃ³n estacionaria del algoritmo de Metropolis-Hastings es
    la distribuciÃ³n objetivo $p(\boldsymbol{\theta} | \boldsymbol{y})$ -->
<!--
TO DO

## **Hamiltonian Monte Carlo (HMC) y el Not-U-Turn Sampler (NUTS)**

Tenemos que completarlo...
-->
</section>
<section id="diagnÃ³sticos" class="level2">
<h2 class="anchored" data-anchor-id="diagnÃ³sticos"><strong>DiagnÃ³sticos</strong></h2>
<p>El uso de algoritmos de MCMC provee de un gran poder que conlleva una gran responsabilidad. En los ejercicios de esta secciÃ³n ya se cuenta con un <em>posterior</em> y se busca evaluar la fiabilidad de las muestras utilizando diferentes medidas de diagnÃ³stico anÃ¡liticas y grÃ¡ficas.</p>
<ol type="1">
<li><p>ğŸ“Œ <strong>Describir medidas de diagnÃ³stico (I)</strong></p>
<p>En sus propias palabras, explique que son <span class="math inline">\(\text{ESS}\)</span>, <span class="math inline">\(\hat{R}\)</span> y <span class="math inline">\(\text{MCSE}\)</span>. Considere:</p>
<ul>
<li>Â¿QuÃ© miden?</li>
<li>Â¿QuÃ© potencial problema de MCMC detectan? <!-- @Martin2021 2E2 --></li>
</ul></li>
<li><p>ğŸ“Œ <strong>Describir medidas de diagnÃ³stico (II)</strong></p>
<p>En sus propias palabras, explique por quÃ© las tÃ©cnicas de estimaciÃ³n del <em>posterior</em> basadas en MCMC necesitan diagnÃ³sticos de convergencia. En particular, contraste estos con los mÃ©todos conjugados descritos en la Unidad 2 que no necesitan esos diagnÃ³sticos. Â¿QuÃ© es diferente entre los dos mÃ©todos de inferencia? <!-- @Martin2021 2E8 --></p></li>
<li><p>ğŸ“Œ <strong>Problemitas de MCMC</strong></p>
<p>Para cada escenario de simulaciÃ³n mediante MCMC descrito a continuaciÃ³n, explique cÃ³mo el escenario podrÃ­a afectar la aproximaciÃ³n del <em>posterior</em>.</p>
<ul>
<li>La cadena se mezcla muy lentamente.</li>
<li>La cadena presenta alta auto-correlaciÃ³n.</li>
<li>La cadena tiende a quedarse â€œtrabadaâ€. <!-- @Johnson2021 Exercise 6.3  --></li>
</ul></li>
<li><p>ğŸ“Œ <strong>Vamos de paseo</strong></p>
<p>Elabore <em>traceplots</em> que le permitan visualizar la traza de la cadena de Markov utilizada en el ejercicio <a href="#ex-mh-mm"><strong>Modelo Normal-Normal</strong></a> de la secciÃ³n <a href="#sec-mh"><strong>Metropolis-Hastings</strong></a>.</p>
<p>Luego, repita el ejercicio utilizando 4 cadenas independientes y grafique sus trazas en un mismo grÃ¡fico. Â¿QuÃ© puede concluir sobre la convergencia y la mezcla de las cadenas?</p></li>
<li><p>ğŸ“Œ <span id="ex-diag-pprhat"><strong>Primeros pasitos con <span class="math inline">\(\hat{R}\)</span></strong></span></p>
<p>Repita lo realizado en el ejercicio <a href="#ex-mh-bb"><strong>Modelo Beta-Binomial</strong></a> de la secciÃ³n <a href="#sec-mh"><strong>Metropolis-Hastings</strong></a> utilizando 4 cadenas independientes. Luego:</p>
<ol type="i">
<li>Calcule la varianza intra-cadenas <span class="math inline">\(W\)</span>.</li>
<li>Calcule la varianza entre-cadenas <span class="math inline">\(B\)</span>.</li>
<li>Calcule <span class="math inline">\(\hat{R}\)</span> y concluya sobre el resultado obtenido.</li>
</ol>
<!-- **NOTA:** No hay una Ãºnica alternativa de $\hat{R}$ dando vueltas por ahÃ­. EstÃ¡
la versiÃ³n de BDA3, que entiendo que es la misma que la del libro de Lambert, pero hoy
se estÃ¡ recomendando una versiÃ³n "rank-normalized". Ver [este paper](https://projecteuclid.org/journals/bayesian-analysis/advance-publication/Rank-Normalization-Folding-and-Localization--An-Improved-R%CB%86-for/10.1214/20-BA1221.full)
y esta [discusiÃ³n](https://statmodeling.stat.columbia.edu/2019/03/19/maybe-its-time-to-let-the-old-ways-die-or-we-broke-r-hat-so-now-we-have-to-fix-it/) --></li>
<li><p><strong><span class="math inline">\(\hat{R}\)</span> para un muestreo independiente</strong></p>
<p>En un determinado problema se encuentra que el <em>posterior</em> del parÃ¡metro <span class="math inline">\(\pi\)</span> de un modelo con verosimilitud binomial estÃ¡ dado por</p>
<p><span class="math display">\[
\pi | \boldsymbol{y} \sim \text{Beta}(12, 6)
\]</span></p>
<ol type="i">
<li>Obtenga 4 conjuntos independientes de 1000 muestras independientes de esta distribuciÃ³n.</li>
<li>Calcule <span class="math inline">\(W\)</span>, <span class="math inline">\(B\)</span>, y <span class="math inline">\(\hat{R}\)</span> considerando que cada conjunto representa una cadena.</li>
<li>Explique el resultado de <span class="math inline">\(\hat{R}\)</span>.</li>
</ol>
<p><strong>Bonus</strong></p>
<ol type="i">
<li>Â¿Se puede concluir que cada uno de los muestreos realizados representan realizaciones de una cadena de Markov? Â¿Por quÃ©?</li>
<li>Â¿Por quÃ© no fue necesario descartar un conjunto de muestras de <em>warm-up</em>?</li>
</ol></li>
<li><p>ğŸ“Œ <strong>FunciÃ³n de autocorrelaciÃ³n</strong></p>
<p>Utilice las 4 cadenas obtenidas en el ejercicio <a href="#ex-diag-pprhat"><strong>Primeros pasitos con <span class="math inline">\(\hat{R}\)</span></strong></a> y grafique la funciÃ³n de autocorrelaciÃ³n y calcule el coeficiente de autocorrelaciÃ³n utilizando un rezago unitario. Concluya sobre la dependencia entre las muestras obtenidas.</p></li>
<li><p>ğŸ“Œ <strong>TamaÃ±o de muestra efectivo</strong></p>
<p>Utilice las muestras obtenidas en el ejercicio anterior para calcular el tamaÃ±o de muestra efectivo.</p></li>
<li><p><strong>Experimentos con el tamaÃ±o de muestra efectivo</strong></p>
<p>Suponga una distribuciÃ³n <span class="math inline">\(\text{Normal}(0, 1^2)\)</span>. Obtenga <span class="math inline">\(n\)</span> muestras independientes utilizando <code>rnorm()</code> y <span class="math inline">\(n\)</span> muestras dependientes utilizando Metropolis-Hastings con <span class="math inline">\(n \in \{10, 50, 100, 500, 1000, 10000\}\)</span>.</p>
<ol type="i">
<li>Calcule el temaÃ±o de muestra efectivo en todos los escenarios simulados.</li>
<li>Describa el comportamiento del tamaÃ±o de muestra efectivo conforme se incrementa el nÃºmero de muestras.</li>
<li>Â¿Por quÃ© se observan los comportamientos descritos?</li>
</ol></li>
<li><p>ğŸ“Œ <strong>Â¡Rompan todo! Un caso simulado</strong></p>
<p>Los siguientes grÃ¡ficos muestran las trazas y las distribuciones que resultan al obtener muestras de un <em>posterior</em> utilizando dos cadenas de Markov independientes. Estos muestreos fueron realizados de manera que presenten algunos problemas. Describa cuales son los problemas que puede observar en los siguientes grÃ¡ficos y explique por quÃ© no utilizarÃ­a estas muestras para obtener conclusiones sobre el <em>posterior</em>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="practica_03_files/figure-html/trace-and-histogram-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></p>
<figcaption>GrÃ¡fico 1</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="practica_03_files/figure-html/trace-and-histogram-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></p>
<figcaption>GrÃ¡fico 2</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="practica_03_files/figure-html/trace-and-histogram-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></p>
<figcaption>GrÃ¡fico 3</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="practica_03_files/figure-html/trace-and-histogram-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></p>
<figcaption>GrÃ¡fico 4</figcaption>
</figure>
</div>
</div>
</div></li>
<li><p>ğŸ“Œ <strong>Â¡Rompan todo! Un caso real</strong></p>
<p>Al igual que en el ejercicio anterior, se presentan <em>traceplots</em> donde el muestreo del <em>posterior</em> presenta problemas. En este caso, los grÃ¡ficos que se observan fueron obtenidos en el marco de un problema real, y se usan 4 cadenas en vez de 2. Nuevamente, describa cuales son los problemas que puede observar en los siguientes grÃ¡ficos y explique por quÃ© no utilizarÃ­a estas muestras para obtener conclusiones sobre el <em>posterior</em>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/posterior_rota.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
<figcaption>GrÃ¡fico 1</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/posterior_rota_2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
<figcaption>GrÃ¡fico 2</figcaption>
</figure>
</div>
</div>
</div>
<p>AdemÃ¡s, responda:</p>
<ol type="i">
<li>Â¿CuÃ¡l grÃ¡fico se asocia a un mayor tamaÃ±o de muestra efectivo?</li>
<li>Â¿QuÃ© grafico muestra peor mezcla entre cadenas?</li>
<li>Â¿En quÃ© grÃ¡fico se puede observar que las cadenas convergen a la misma distribuciÃ³n?</li>
</ol></li>
</ol>
</section>
<section id="programaciÃ³n-probabilÃ­stica---stan-y-rstan" class="level2">
<h2 class="anchored" data-anchor-id="programaciÃ³n-probabilÃ­stica---stan-y-rstan"><strong>ProgramaciÃ³n probabilÃ­stica - Stan y RStan</strong></h2>
<p>En esta secciÃ³n se comienza a utilizar Stan para realizar los cÃ¡lculos relacionados a la inferencia bayesiana. Stan es uno de los lenguajes de programaciÃ³n probabilÃ­stica mas potentes y populares en la actualidad. Los ejercicios contienen modelos estadÃ­sticos que deben ser resueltos con la interface de <code>Stan</code> a R, <code>{RStan}</code>.</p>
<ol type="1">
<li><p>ğŸ“Œ <strong>MCMC con RStan: Precalentamiento (I)</strong></p>
<p>Utilice la informaciÃ³n proporcionada para definir la estructura del modelo bayesiano utilizando <code>{RStan}</code>. No es necesario ejecutar nada, solo necesita proporcionar el cÃ³digo correcto.</p>
<ol type="i">
<li><span class="math inline">\(Y | \pi \sim \text{Binomial}(\pi, 20)\)</span> con <span class="math inline">\(\pi \sim \text{Beta}(1, 1)\)</span>.</li>
<li><span class="math inline">\(Y | \lambda \sim \text{Poisson}(\lambda)\)</span> con <span class="math inline">\(\lambda \sim \text{Gamma}(4, 2)\)</span>.</li>
<li><span class="math inline">\(Y | \mu \sim \text{Normal}(\mu, 1^2)\)</span> con <span class="math inline">\(\mu \sim \text{Normal}(0, 10^2)\)</span>. <!-- @Johnson2021 6.11 --></li>
</ol></li>
<li><p>ğŸ“Œ <strong>MCMC con RStan: Precalentamiento (II)</strong></p>
<p>Utilice la informaciÃ³n proporcionada para (1) definir la estructura del modelo bayesiano y (2) obtener muestras del <em>posterior</em> utilizando <code>{RStan}</code>. No es necesario ejecutar nada, solo necesita proporcionar el cÃ³digo correcto.</p>
<ol type="i">
<li><span class="math inline">\(Y | \pi \sim \text{Binomial}(\pi, 20)\)</span> con <span class="math inline">\(\pi \sim \text{Beta}(1, 1)\)</span> e <span class="math inline">\(y = 12\)</span>.</li>
<li><span class="math inline">\(Y | \lambda \sim \text{Poisson}(\lambda)\)</span> con <span class="math inline">\(\lambda \sim \text{Gamma}(4, 2)\)</span> e <span class="math inline">\(y = 3\)</span>.</li>
<li><span class="math inline">\(Y | \mu \sim \text{Normal}(\mu, 1^2)\)</span> con <span class="math inline">\(\mu \sim \text{Normal}(0, 10^2)\)</span> e <span class="math inline">\(y = 12.2\)</span>. <!-- @Johnson2021 6.12 --></li>
</ol></li>
<li><p>ğŸ“Œ <strong>Modelo Beta-Binomial con RStan (I)</strong></p>
<p>Considere el modelo Beta-Binomial para <span class="math inline">\(\pi\)</span> con <span class="math inline">\(Y | \pi \sim \text{Binomial}(\pi, n)\)</span> y <span class="math inline">\(\pi \sim \text{Beta}(3, 8)\)</span>. Suponga que en <span class="math inline">\(n = 10\)</span> ensayos independientes observa <span class="math inline">\(y = 2\)</span> Ã©xitos.</p>
<ol type="i">
<li>Obtenga muestras del <em>posterior</em> de <span class="math inline">\(\pi\)</span> con <code>{RStan}</code> utilizando 3 cadenas y 12000 iteraciones por cadena.</li>
<li>Grafique la traza de cada una de las tres cadenas.</li>
<li>Â¿CuÃ¡l es el rango de valores en el eje x del <em>traceplot</em>? Â¿Por quÃ© el valor mÃ¡ximo de este rango no es 12000?</li>
<li>Cree un grÃ¡fico que permita visualizar la funciÃ³n de densidad de los valores obtenidos con cada una de las tres cadenas.</li>
<li>Utilizando lo estudiado en la Unidad 2, especifique el <em>posterior</em> de <span class="math inline">\(\pi\)</span>. Â¿CÃ³mo se compara con la aproximaciÃ³n mediante MCMC?</li>
</ol></li>
<li><p>ğŸ“Œ <strong>Modelo Beta-Binomial con RStan (II)</strong></p>
<p>Repita el ejercicio anterior utilizando <span class="math inline">\(\pi \sim \text{Beta}(4, 3)\)</span>, donde observa <span class="math inline">\(y = 4\)</span> Ã©xitos en <span class="math inline">\(n = 12\)</span> ensayos independientes.</p></li>
<li><p>ğŸ“Œ <strong>Modelo Gamma-Poisson con RStan (I)</strong></p>
<p>Considere el modelo Gamma-Poisson para <span class="math inline">\(\lambda\)</span> con <span class="math inline">\(Y_i \mid \lambda \sim \text{Poisson}(\lambda)\)</span> y <span class="math inline">\(\lambda \sim \text{Gamma}(20, 5)\)</span>. Suponga que cuenta con <span class="math inline">\(n = 3\)</span> observaciones independientes <span class="math inline">\((y_1, y_2, y_3) = (0, 1, 0)\)</span></p>
<ol type="i">
<li>Obtenga muestras del <em>posterior</em> de <span class="math inline">\(\lambda\)</span> con <code>{RStan}</code> utilizando 4 cadenas y 10000 iteraciones por cadena.</li>
<li>Grafique la traza y la funciÃ³n de densidad de cada una de las tres cadenas.</li>
<li>A partir del grÃ¡fico de la funciÃ³n de densidad, Â¿cuÃ¡les suelen ser, <em>a posteriori</em>, los valores mÃ¡s probables de <span class="math inline">\(\lambda\)</span>?</li>
<li>Utilizando lo estudiado en la Unidad 2, especifique el <em>posterior</em> de <span class="math inline">\(\lambda\)</span>. Â¿CÃ³mo se compara con la aproximaciÃ³n mediante MCMC?</li>
</ol></li>
<li><p>ğŸ“Œ <strong>Modelo Gamma-Poisson con RStan (II)</strong></p>
<p>Repita el ejercicio anterior utilizando el <em>prior</em> <span class="math inline">\(\lambda \sim \text{Gamma}(5, 5)\)</span>.</p></li>
<li><p>ğŸ“Œ <strong>Modelo Normal-Normal con RStan (I)</strong></p>
<p>Repita los mismos pasos del ejercicio <strong>Modelo Gamma-Poisson con Rstan (I)</strong> pero considere el modelo Normal-Normal para <span class="math inline">\(\mu\)</span> con <span class="math inline">\(Y_i | \mu \sim \text{Normal}(\mu, 1.3^2)\)</span> y <span class="math inline">\(\mu \sim \text{Normal}(10, 1.2^2)\)</span>. Suponga que cuenta con <span class="math inline">\(n = 4\)</span> observaciones independientes <span class="math inline">\((y_1, y_2, y_3, y_4) = (7.1, 8.9, 8.4, 8.6)\)</span></p></li>
<li><p>ğŸ“Œ <strong>Modelo Normal-Normal con RStan (II)</strong></p>
<p>Repita el ejercicio anterior con el modelo Normal-Normal pero ahora considere <span class="math inline">\(Y_i | \mu \sim \text{Normal}(\mu, 8^2)\)</span> y <span class="math inline">\(\mu \sim \text{Normal}(-15, 2^2)\)</span>. Suponga que en <span class="math inline">\(n = 5\)</span> observaciones independientes observa <span class="math inline">\((y_1, y_2, y_3, y_4, y_5) = (âˆ’10.1, 5.5, 0.1,âˆ’1.4, 11.5)\)</span></p></li>
<li><p><strong>Un modelo que es un poco Â¿complicado?</strong></p>
<p>Considere el siguiente modelo</p>
<p><span class="math display">\[
\begin{aligned}
\text{mass}_i &amp;\sim \text{Normal}(\mu_i, \sigma^2) \\
\mu_i         &amp;= \theta_1 + \theta_2 + \text{age}_i^{\theta_3} \\
\theta_1      &amp;\sim \text{Normal}(0, 100^2) \\
\theta_2      &amp;\sim \text{Uniforme}(0, 20000) \\
\theta_3      &amp;\sim \text{Normal}(0, 1) \\
\sigma^2      &amp;\sim \text{InvGamma}(0.01, 0.01)
\end{aligned}
\]</span></p>
<p>y los siguientes datos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>edad <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">15</span>, <span class="dv">14</span>, <span class="dv">16</span>, <span class="dv">18</span>, <span class="dv">22</span>, <span class="dv">28</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>peso <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">29.9</span>, <span class="dv">1761</span>, <span class="dv">1807</span>, <span class="dv">2984</span>, <span class="dv">3230</span>, <span class="dv">5040</span>, <span class="dv">5654</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(edad)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>data_list <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">peso =</span> peso, <span class="at">edad =</span> edad, <span class="at">n =</span> n)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="i">
<li>Ajuste el modelo utilizando <code>{RStan}</code>.</li>
<li>Obtenga una visualizaciÃ³n de la edad versus el peso junto con una curva que indique la media <em>a posteriori</em> de <span class="math inline">\(\mu_i\)</span> para evaluar si el modelo ajusta bien.</li>
<li>Estudie la convergencia de las cadenas de Markov.</li>
<li>Mencione tres medidas que podrÃ­a tomar para mejorar la convergencia. <!-- @Reich2020 3.15 --></li>
</ol></li>
</ol>
</section>
<section id="otros" class="level2">
<h2 class="anchored" data-anchor-id="otros"><strong>Otros</strong></h2>
<ol type="1">
<li><p>ğŸ“Œ <strong>El peso de los pescados</strong></p>
<p>Una compaÃ±Ã­a pesquera de Comodoro Rivadavia se encuentra probando un nuevo mÃ©todo para estimar el peso de los peces que extrae del Mar Argentino. El objetivo de este mÃ©todo es obtener una estimaciÃ³n lo suficientemente buena del peso de cada pescado sin tener que pesarlos uno por uno, ya que es un proceso costoso en tiempo y labor. Para eso, seleccionaron una muestra de pescados, los pesaron y les midieron ciertos aspectos morfolÃ³gicos (ancho, alto y largo). En el futuro, esperan recolectar estas mismas medidas morfolÃ³gicas mediante una cÃ¡mara especializada y utilizar un modelo para estimar el peso.</p>
<p>El modelo propuesto por el equipo de investigaciÃ³n es el siguiente:</p>
<p><span class="math display">\[
\begin{aligned}
\log(\text{Peso}_i) &amp;\sim \text{Normal}(\mu, \sigma) \\
\mu_i               &amp;= \beta_0 + \beta_1 \log(\text{Largo}_i) \\
\sigma              &amp;\sim \text{Gamma}(k, \theta)
\end{aligned}
\]</span></p>
<p>El peso se encuentra medido en gramos y la longitud en centÃ­metros. El equipo provee las muestras que obtuvieron del <em>posterior</em>. Las mismas se pueden leer en R utilizando el siguiente bloque de cÃ³digo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"https://raw.githubusercontent.com/estadisticaunr/"</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"estadistica-bayesiana/main/datos/fish-market-posterior.csv"</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>df_posterior <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(url)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_posterior)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code># A tibble: 6 Ã— 3
  intercepto pendiente sigma
       &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
1      -4.44      3.08 0.408
2      -4.30      3.05 0.431
3      -4.49      3.12 0.433
4      -4.04      2.96 0.341
5      -4.76      3.18 0.413
6      -4.65      3.15 0.350</code></pre>
<ol type="i">
<li>Analice de manera grÃ¡fica y analÃ­tica los <em>posteriors</em> marginales de los parÃ¡metros del modelo. Realice las transformaciones de parÃ¡metros que crea conveniente para facilitar la comprensiÃ³n del anÃ¡lisis.</li>
<li>Considere un pescado cuya longitud es de 30 centÃ­metros.
<ol type="a">
<li>Obtenga y grafique la distribuciÃ³n <em>a posteriori</em> del peso medio.</li>
<li>Obtenga y grafique la distribuciÃ³n predictiva <em>a posteriori</em> del peso.</li>
<li>Interprete los resultados.</li>
</ol></li>
<li>Grafique la curva de regresiÃ³n junto a una banda de credibilidad del 95% en el plano de las variables originales y en el plano de las variables transformadas.</li>
<li>Agregue a los grÃ¡ficos anteriores una banda de credibilidad del 95% para la distribuciÃ³n predictiva <em>a posteriori</em>. Interprete los resultados.</li>
</ol></li>
</ol>
<!--
TO DO: Mover a otro lado?

1.  Considere la siguiente familia de distribuciones normales en 2D

    $$
    f(\boldsymbol{x} | \boldsymbol{\Sigma}, \boldsymbol{\mu} = \boldsymbol{0}) 
    = \frac{1}{\det(2\pi\boldsymbol{\Sigma})^{-\frac{1}{2}}}
    \exp[{-\frac{1}{2} \boldsymbol{x}^T \boldsymbol{\Sigma}^{-1} \boldsymbol{x}}]
    $$

    y las siguientes matrices de covarianza

    $$
    \begin{array}{cc}
        \boldsymbol{\Sigma}_1 = \begin{bmatrix} 1 & 0 \\ 0 & 1 \end{bmatrix} & 
        \boldsymbol{\Sigma}_2 = \begin{bmatrix} 1 & 0.2 \\ 0.2 & 1 \end{bmatrix}
        \\ \\ 
        \boldsymbol{\Sigma}_1 = \begin{bmatrix} 1 & 0.5 \\ 0.5 & 1 \end{bmatrix} & 
        \boldsymbol{\Sigma}_2 = \begin{bmatrix} 0.1 & 0 \\ 0 & 1 \end{bmatrix}
        \\ \\
        \boldsymbol{\Sigma}_1 = \begin{bmatrix} 1 & 0.9 \\ 0.9 & 1 \end{bmatrix} & 
        \boldsymbol{\Sigma}_2 = \begin{bmatrix} 0.01 & 0 \\ 0 & 1 \end{bmatrix}
    \end{array}
    $$

    Que dan lugar a las siguientes funciones de densidad:



    ::: {.cell layout-align="center"}
    ::: {.cell-output-display}
    ![](practica_03_files/figure-html/plot-matrix-of-gaussians-1.png){fig-align='center' width=768}
    :::
    :::



    **Parte 1:** Metropolis-Hastings

    i. Utilice el algoritmo Metropolis-Hastings para obtener $n=10000$ muestras de
    cada una de las distribuciones.
    i. Calcule la probabilidad de aceptaciÃ³n.
    i. Grafique la funciÃ³n de autocorrelaciÃ³n y calcule la cantidad de muestras efectivas.
    i. Analice como varÃ­a la probabilidad de aceptaciÃ³n y la cantidad de muestras 
    efectivas segÃºn las diferentes caracterÃ­sticas de la distribuciÃ³n objetivo.
    i. Â¿CuÃ¡les son las ventajas y desventajas del algoritmo de Metropolis-Hastings segÃºn
    lo que puede concluir a partir de esta aplicaciÃ³n? Comente dificultades con las que
    se haya encontrado. 

    **Parte 2:** Hamiltonian Monte Carlo

    i. Utilice el algoritmo HMC para obtener $n=10000$ muestras de
    cada una de las distribuciones.
    i. Calcule la probabilidad de aceptaciÃ³n.
    i. Grafique la funciÃ³n de autocorrelaciÃ³n y calcule la cantidad de muestras efectivas.
    i. Analice como varÃ­a la probabilidad de aceptaciÃ³n y la cantidad de muestras 
    efectivas segÃºn las diferentes caracterÃ­sticas de la distribuciÃ³n objetivo.
    i. Â¿CuÃ¡les son las ventajas y desventajas del algoritmo de Metropolis-Hastings segÃºn
    lo que puede concluir a partir de esta aplicaciÃ³n? Comente dificultades con las que
    se haya encontrado. 

    **To Do** Proveer valores para los parÃ¡metros 'mu' y 'sigma'

-->
<!--
TO DO

### Ejercicios que faltan

* Utilizar HMC para la normal multivariada con correlaciÃ³n moderada y alta correlaciÃ³n
* Utilizar HMC para los modelos donde se usÃ³ MH
* Algun caso donde los diagnosticos no den bien...
    * Puede ser cuando el HMC no esta bien tuneado
    * Pensar algunos otros (deberia buscar en cosas que he hecho)
* Algo con brms?

**Nota:** Para los que dicen "utilizar HMC" estaria bueno que proveamos una funcion
que use HMC, sin que tengan que usar Stan.
-->
<!-- 
1. **La maldiciÃ³n de la dimensionalidad**

    **Nota:** Creo que esto puede ir para el TP 2 de este aÃ±o, o ser parte del TP 2
    del aÃ±o que viene. Esto todo en el contexto de grid approximation.

    * Mostrar que casi todo el volumen de un hipercubo estÃ¡ en las esquinas.
    * Hablar de la distnacia a la moda en una normal multivariada conforme d -> inftys 

1.  **Tomar el Torus por las astas**

    Ver el script "torus.R"
-->



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">Referencias</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Downey2021" class="csl-entry" role="listitem">
Downey, Allen B. 2021. <em>Think Bayes: Bayesian Statistics in Python</em>. 2nd edition. Oâ€™Reilly Media. <a href="http://allendowney.github.io/ThinkBayes2/">http://allendowney.github.io/ThinkBayes2/</a>.
</div>
<div id="ref-Martin2021" class="csl-entry" role="listitem">
Martin, Osvaldo A., Ravin Kumar, y Junpeng Lao. 2021. <em>Bayesian Modeling and Computation in Python</em>. 1st edition. Chapman; Hall/CRC.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../practica/practica_02.html" class="pagination-link  aria-label=" unidad="" 2"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Unidad 2</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../practica/practica_04.html" class="pagination-link" aria-label="Unidad 4">
        <span class="nav-page-text">Unidad 4</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Esta pÃ¡gina es hecha con â¤ï¸ y <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>