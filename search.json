[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Estadística Bayesiana",
    "section": "",
    "text": "Licenciatura en Estadística\n   Facultad de Ciencias Económicas y Estadística (UNR)\n   1° Cuatrimestre 2023\n   Lun – 11:00 a 13:00   |   Mié – 7:00 a 9:00   |   Vie – 7:00 a 9:00"
  },
  {
    "objectID": "index.html#profesores",
    "href": "index.html#profesores",
    "title": "Estadística Bayesiana",
    "section": "Profesores",
    "text": "Profesores\n\n\nNacho Evangelista\n\n   evangelistaignacio@gmail.com\n   Consultas\n\n\n\nTomás Capretto\n\n   tomicapretto@gmail.com\n   Consultas"
  },
  {
    "objectID": "practica/practica_03.html",
    "href": "practica/practica_03.html",
    "title": "Práctica - Unidad 3",
    "section": "",
    "text": "Descargar PDF"
  },
  {
    "objectID": "practica/practica_03.html#métodos-computacionales",
    "href": "practica/practica_03.html#métodos-computacionales",
    "title": "Práctica - Unidad 3",
    "section": "Métodos Computacionales",
    "text": "Métodos Computacionales\n\nSea \\(X \\sim \\text{Normal}(\\mu=3, \\sigma=1.2)\\).\n\nElabore un gráfico que permita visualizar la función de densidad de probabilidad de \\(X\\).\n¿Cuál es la probabilidad de que \\(X\\) sea menor a 2.5?\n¿Cuál es la probabilidad de que \\(X\\) sea mayor a 4?\n¿Cuál es la probabilidad de que \\(X\\) sea mayor 2 y menor 3?\n\nSea \\(X \\sim \\text{Beta}(\\alpha=10, \\beta=2)\\)\n\nElabore un gráfico que permita visualizar la función de densidad de probabilidad de \\(X\\).\n¿Cuál es la probabilidad de que \\(X\\) sea menor a 0.5?\n¿Cuál es la probabilidad de que \\(X\\) sea mayor a 0.8?\n¿Cuál es la probabilidad de que \\(X\\) sea mayor 0.25 y menor 0.75?\n\nResponda los dos puntos anteriores sin evaluar la función de densidad ni la función de distribución de las variables aleatorias mencionadas. Para eso genere muestras que provengan de las correspondientes distribuciones y utilícelas para responder las preguntas mencionadas. Reflexione sobre las ventajas y desventajas de utilizar un enfoque basado en la simulación para resolver problemas.\nUna variable aleatoria \\(X\\) toma valores en el conjunto \\(\\{2, 4, 6, 8, 10\\}\\) con igual probabilidad. Encuentre la media y el desvío estándar de las variables \\(X\\) e \\(Y = 2X + 1\\). \nEn un problema determinado la distribución a posteriori de la parámetro de inteŕes \\(\\alpha\\) es \\(\\Gamma(k=3, \\theta=1.5)\\), donde \\(k\\) es el parámetro de forma y \\(\\theta\\) es el parámetro de escala. Calcule la probabilidad de que \\(\\alpha^2\\) sea mayor a 10. \nSean \\(X\\) e \\(Y\\) dos variables aleatorias independientes con distribución uniforme en el intervalo \\([0, 1]\\).\n\n¿Cuál es la probabilidad de que \\(X \\le Y\\)?\nGrafique los puntos muestreados coloreando de acuerdo a si la muestra satisface el evento antes mencionado o no.\n\nDos estudiantes de estadística deciden encontrarse en la fotocopiadora de la Facultad entre las 10 y las 11 de la mañana, eligiendo el tiempo de llegada al azar. La estudiante A esperará 10 minutos luego de llegar. Si el estudiante B no llega en ese intervalo, se irá. Lo mismo hace el estudiante B, pero este decide esperar 14 minutos. ¿Cuál es la probabilidad de que se produzca el encuentro en la fotocopiadora entre la estudiante A y el estudiante B?\nUna máquina que se utiliza para ensamblar teléfonos celulares en una fábrica en Tierra del Fuego cuenta con tres componentes críticos para su funcionamiento. Ante una falla en cualquiera de estos componentes, la máquina se detiene. Las probabilidades de que estos elementos operen correctamente durante un día cualquiera son \\(p_1 = 0.8\\), \\(p_2 = 0.9\\) y \\(p_3 = 0.7\\). Responda las siguientes preguntas utilizando técnicas de simulación:\n\n¿Cuál es la probabilidad de que la máquina falle en el primer día de uso?\n¿Cuál es la probabilidad de que la máquina siga funcionando luego de 10 días?\n¿Cuál es la probabilidad de que la máquina falle en el día 7 de uso?\nSea \\(T=\\) Cantidad de días que la máquina funciona ininterrumpidamente. Grafique la función de densidad de probabilidad de \\(T\\).\n\nEste tuit propone un problema muy interesante. Una urna contiene una bola azul y una amarilla. Se elije una bola al azar y se la vuelve a colocar junto con otra bola adicional del mismo color. Se repite este proceso indefinidamente. ¿Qué ocurre con la proporción de bolas azules en la urna a medida que repetimos más y más veces?\n\nTiende a 1/2\nTiende a 0 ó a 1\nNo se estabiliza\nNinguna de las anteriores\n\nEscriba un programa en R para responder esta pregunta utilizando simulaciones. Genere gráficos que faciliten la comprensión del resultado.\n¿Cuánto vale \\(\\pi\\)?\nImagine un círculo de radio \\(r\\) y un cuadrado de lado \\(2r\\), ambos centrados en el mismo punto, que de manera arbitraria puede ser el punto \\((0, 0)\\). Obtenga muestras de una distribución uniforme en el plano \\((x, y)\\), cuyo dominio está acotado por el cuadrado antes mencionado. Para cada muestra extraida, determine si se encuentra dentro del círculo o no – todos las muestras se encontrarán dentro del cuadrado. Utilice esta información para estimar el valor de \\(\\pi\\).\n\n\n\n\n\n\n\n\n\nDatos útiles\n\nArea de un círculo: \\(\\pi \\cdot r^2\\).\nArea de un cuadrado: \\(a^2\\), donde \\(a\\) es la longitud del lado.\n\nSe seleccionan dos puntos de manera uniforme e independiente dentro de un círculo. ¿Cuál es la probabilidad de que la distancia entre dos puntos sea menor al radio?\n\nIntentar hacer a mano?\nResuelva el problema utilizando R\nElabore una visualización que facilite la comunicación de los resultados\n\nEn la Copa del Mundo de la FIFA 2014, Alemania jugó contra Brasil en la semifinal. Los alemanes hicieron el primer gol a los 11 minutos y el segundo a los 23. Asuma que el tiempo entre goles sigue una distribución exponencial. Elija una distribución a priori para el tiempo entre goles (puede ser conjugada o no). En ese momento del partido,\n\n¿Cuál es la distribución a posteriori del tiempo entre goles de Alemania?\n¿Cuántos goles cabría esperar que Alemania hiciera al finalizar los 90 minutos?\n¿Cuál era la probabilidad de que Alemania hiciera más de 5 goles (cosa que ocurrió)? \n\n¿Tendré que esperar mucho?\nEl tiempo que un empleado de recursos humanos demora en hacer una entrevista tiene distribución exponencial con media 30 minutos. Los tiempos de duración de cada entrevista se pueden considerar independientes entre sí. Las entrevistas a postulantes para un trabajo están programadas cada 15 minutos, comenzando desde las 8. Es válido considerar que todos los postulantes llegan puntuales a su entrevista. Cuando la persona del turno de las 8:15 llega a la oficina\n\n¿Cuál es la probabilidad de que tenga que esperar antes de ser entrevistada?\n¿Cuál es el horario esperado al que terminará su entrevista? \n\n¡Qué casualidad!\nDos personas se conocen en la fila de embarque para un vuelo en un avión Airbus A330-300\n\n¿Cuál es la probabilidad de que tengan asientos en la misma fila?\n¿Cuál es la probabilidad de que estén sentados en asientos adyacentes?\n\nEl Problema de Monty Hall\nEl Problema de Monty Hall es un problema de probabilidad basado en un juego del concurso televisivo estadounidense “Trato hecho”. En este problema, el concursante debe elegir una puerta entre tres, todas cerradas. El premio consiste en llevarse lo que se encuentra detrás de la elegida. Se sabe con certeza que tras una de ellas se oculta un automóvil, y tras las otras dos hay cabras. Una vez que el concursante haya elegido una puerta y comunicado su elección a los presentes, el presentador, que sabe lo que hay detrás de cada puerta, abrirá una de las otras dos en la que haya una cabra. A continuación, le da la opción al concursante de cambiar, si lo desea, de puerta (tiene dos opciones). ¿Debe el concursante mantener su elección original o escoger la otra puerta? ¿Hay alguna diferencia? Resuelva este ejercicio utilizando simulaciones. \n\n\n\n\n\nLas 3 puertas del problema de Monty Hall\n\n\n\n\nQue los cumplan feliz\nBasándose en el siguiente tuit y conociendo el problema del cumpleaños (¿cuántas personas debe haber en una habitación para que la probabilidad de que dos de ellas cumplan años el mismo día sea mayor a X%?) construir un gráfico similar al del tuit donde se grafique la probabilidad de que haya \\(n\\) personas que cumplan años el mismo día para \\(K\\) personas presentes en la habitación.\nQué suerte, ¿no?\nPrevio a la final de la Copa América 2021, los jugadores de la Selección Argentina se reúnen en la habitación del hotel como se describe en este tuit.\n\n¿Cuál es la probabilidad de que un jugador adivine una de diez cartas?\n¿Cuál es la probabilidad de que tres de ellos adivinen una de diez cartas?\n\nEl álbum del Campeón\nEl álbum oficial del Mundial de Fútbol de Qatar 2022 consta de 638 figuritas. Cada paquete trae cinco figuritas.\n\nComprando cinco paquetes, ¿cuál es la probabilidad de tener a Messi?\nComprando cinco paquetes, ¿cuál es la probabilidad de sacar a Messi repetido?\n¿Cuántos paquetes se necesitan, en promedio, para completar el álbum?\nSi a una persona le faltan diez figuritas para completar el álbum, ¿cuántos paquetes tiene que comprar para asegurarse de lograrlo?\n\n¿Que tán raras son estas secuencias raras?\nSi se arroja una moneda \\(n\\) veces, ¿cuál es la probabilidad de que no haya secuencias de \\(k\\) caras?\nUn viaje por el elevador\n¿Cuál es la probabilidad de que tres personas en un ascensor con doce pisos presionen para ir a tres pisos consecutivos? ¿Qué supuestos realiza para resolver el problema? Escríbalos en una lista de manera explícita.\nLa vida es muy corta como para perderla ordenando medias\nUn cajón contiene 10 pares de medias. No hay dos pares iguales. Por fiaca, el dueño de las medias no las agrupa después de lavarlas y simplemente las pone en el cajón. Al momento de necesitar un par de medias, saca una tras una hasta que se forma un par. En promedio, ¿cuántas medias sacará hasta encontrar un par? \n¿Vale la pena hacer un ensayo clínico a gran escala?\nDados los resultados de un estudio piloto, la probabilidad a posteriori de que la droga desarrollada por tu compañía sea mas efectiva que el tratamiento actual es \\(\\theta \\in [0, 1]\\). Tu compañía está considerando realizar un ensayo clínico a gran escala para confirmar que la droga que desarrollan es de hecho mejor. El costo del estudio es $X. Si la droga es mejor, la probabilidad de que esto se confirme en el ensayo es del 80%. Si la droga no es mejor, hay una probabilidad del 5% de que el estudio confirme que es mejor. Si el ensayo sugiere que tu droga es mejor, ganarás $cX. ¿Para qué valores de \\(\\theta\\) y \\(c\\) tiene sentido realizar el estudio? \nEl problema de concordancia\nResuelva el problema de concordancia de de Montmort presentado en la Práctica 0 utilizando simulaciones. \nEl problema de los sobres\nResuelva el problema de los dos sobres presentado en la Práctica 0 utilizando simulaciones.\nIntegración por muestreo\nCalcule las siguientes integrales utilizando muestras.\n\n\\(\\displaystyle \\int_{-\\infty}^{\\infty}{\\frac{x^2}{\\sqrt{2\\pi}}\\exp \\left(-\\frac{x^2}{2} \\right)dx}\\)\n\\(\\displaystyle \\int_{1}^{\\infty}{\\frac{x^3}{\\sqrt{2\\pi}}\\exp \\left(-\\frac{x^2}{2} \\right)dx}\\)\n\\(\\displaystyle \\int_{1}^{\\infty}{\\frac{x^6}{\\sqrt{2\\pi}}\\exp \\left(-\\frac{x^2 - 4x}{2} \\right)dx}\\)\n\\(\\displaystyle \\int_{1}^{10}{x^6\\frac{e^{-x^4/2}}{\\sqrt{2\\pi}}dx}\\) \n\n¿Cuál es la distribución de muestreo aproximada al usar muestreo independiente para evaluar integrales?"
  },
  {
    "objectID": "practica/practica_03.html#método-de-la-grilla",
    "href": "practica/practica_03.html#método-de-la-grilla",
    "title": "Práctica - Unidad 3",
    "section": "Método de la grilla",
    "text": "Método de la grilla\nPodriamos encontrar un mejor nombre…\n\nAproximación de grilla\nSe tiene un experimento binomial donde \\(n=80\\) y se observan \\(y=7\\) éxitos. Considere que el prior de la probabilidad de éxito \\(\\theta\\) es \\(\\text{Beta}(2, 10)\\).\n\nObtenga la distribución a posteriori de \\(\\theta\\) de manera analítica y grafíquela.\nObtenga la distribución a posteriori de \\(\\theta\\) utilizando el método de la grilla en base a una grilla de 10 puntos y dibuje la curva obtenida en el gráfico creado anteriormente.\nRepita el proceso del punto anterior utilizando una grilla de 100 puntos.\nConcluya sobre la fidelidad de las aproximaciones. ¿Considera que es necesario utilizar una grilla más densa? ¿Cuáles serían las ventajas y desventajas?\n\nCálculo de probabilidades en base a la grilla (I)\nEn base al posterior obtenido en el ejercicio anterior mediante el método de la grilla calcule las siguientes probabilidades\n\n\\(P(\\theta < 0.7)\\)\n\\(P(\\theta > 0.05)\\)\n\\(P(0.05 < \\theta < 0.15)\\)\n\nDe ser necesario, obtenga el posterior mediante una grilla de mayor densidad.\nCálculo de probabilidades en base a la grilla (II)\nUtilice los valores de la grilla y sus probabilidades a posteriori para obtener muestras del posterior y calcular las mismas probabilidades que en el ejercicio anterior en base a muestras. Ayuda: Para obtener muestras utilice la función sample().\nAproximación de grilla en 2 dimensiones\nSean dos variables aleatorias continuas \\(X\\) e \\(Y\\) tales que \\((X, Y) \\in \\mathbb{R}^2\\), y sea el siguiente modelo de regresión lineal simple:\n\\[\n\\begin{aligned}\n\\alpha &\\sim \\text{Normal}(0, 1.5) \\\\\n\\beta  &\\sim \\text{Normal}(0, 2) \\\\\nY      &\\sim \\text{Normal}(\\alpha + \\beta X, 0.8)\n\\end{aligned}\n\\]\n\nObtenga el posterior conjunto del vector de parámetros \\([\\alpha, \\beta]^T\\) mediante el método de la grilla. Elabore un gráfico que permita visualizar esta distribución.\nObtenga el posterior marginal de \\(\\alpha\\) y grafíquelo.\nObtenga el posterior marginal de \\(\\beta\\) y grafíquelo.\nCalcule la probabilidad de que el intercepto sea mayor a 0.5.\nCalcule la probabilidad de que la pendiente sea menor a -3.\n\nPara responder las consignas utilice los datos simulados que se obtienen con el siguiente bloque de código:\n\nset.seed(121195)\nalpha <- 1\nbeta <- -2\nsigma <- 0.8\nn <- 80\nx <- rnorm(n)\ny <- rnorm(n, alpha + beta * x, sigma)\ndf <- data.frame(x = x, y = y)\n\nBonus: ¿Cómo podría responder las consignas (ii)-(v) utilizando muestras del posterior?\n\n\n\n\n\n\nEscalando la aproximación de la grilla\nSuponga que se tiene que estimar un posterior utilizando la aproximación mediante una grilla de 200 puntos en cada dimensión. Calcule cúantas veces se tiene que evaluar el posterior en cada uno de los siguientes escenarios:\n\n1 dimensión\n2 dimensiones\n3 dimensiones\n5 dimensiones\n10 dimensiones\n\nConcluya sobre las ventajas y desventajas de la aproximación de la grilla teniendo en cuenta sus características conforme se incrementa el número de dimensiones del posterior.\nBenchmark de la aproximación de la grilla\nEl siguiente bloque de código define una función llamada create_and_eval_grid() que evalúa la función de densidad normal en una cantidad arbitraria dimensiones. El argumento dimension_n indica la dimensionalidad de la distribución normal, y grid_n indica la cantidad de puntos en la grilla de cada dimensión. Debajo, se utiliza la función mark() del paquete bench para comparar el desempeño de la función create_and_eval_grid() con diferentes números de dimensiones.\n\ncreate_and_eval_grid <- function(dimension_n, grid_n = 100) {\n    grid <- seq(-3, 3, length.out = grid_n)\n    grids <- replicate(dimension_n, grid, simplify = FALSE)\n    df <- expand.grid(grids, KEEP.OUT.ATTRS = FALSE)\n    Mu <- rep(0, dimension_n)\n    Sigma <- diag(dimension_n)\n    mvtnorm::dmvnorm(df, mean = Mu, sigma = Sigma)\n}\nbench::mark(\n    create_and_eval_grid(1),\n    create_and_eval_grid(2),\n    check = FALSE,\n    max_iterations = 500\n)\n\nModifique el código brindado para evaluar la función de densidad en hasta un máximo de 10 dimensiones. Concluya sobre el tiempo de ejecución, el consumo de memoria, y otras cantidades que se encuentren en la salida y crea adecuadas para el análisis.\nGrid approximation para una skew-normal. Estimar los parámetros \\(\\xi\\) (posición), \\(\\omega\\) (escala) y \\(\\alpha\\) (asimetría).\n\\[\nf(x) = \\frac{2}{\\omega} \\phi\\left(\\frac{x-\\xi}{\\omega}\\right)\\Phi\\left( \\alpha \\frac{x-\\xi}{\\omega} \\right)\n\\]"
  },
  {
    "objectID": "practica/practica_03.html#sec-mh",
    "href": "practica/practica_03.html#sec-mh",
    "title": "Práctica - Unidad 3",
    "section": "Metropolis-Hastings",
    "text": "Metropolis-Hastings\n\n\n\nMuestreo utilizando el algoritmo de Metropolis-Hastings (I)\nUse el algoritmo de Metropolis-Hastings y una distribución de propuesta \\(\\text{Normal}(0, 0.1)\\) para obtener 5000 muestras de las siguientes distribuciones de probabilidad:\n\n\\(\\text{Normal}(\\mu = 3, \\sigma = 6)\\)\n\\(\\text{StudentT}(\\nu = 5)\\)\n\\(\\frac{2}{3}\\text{Normal}(\\mu = 0, \\sigma = 0.5) + \\frac{1}{3}\\text{Normal}(\\mu = 3, \\sigma = 2)\\)\n\nGrafique las distribuciones obtenidas utilizando un histograma o una estimación de densidad y superponga la función de densidad verdadera para realizar una comparación. Concluya sobre la similitud de las mismas y la aptitud de la distribución de propuesta utilizada.\nSimplificando el algoritmo de Metropolis-Hastings\nLa distribución de propuesta utilizada en el ejercicio anterior goza de una propiedad que permite simplificar el algoritmo de Metropolis-Hastings.\n\n¿Cuál es esta propiedad?\n¿Qué simplificación se puede hacer?\n¿Qué nombre recibe la versión simplificada del algoritmo?\nImplemente la versión simplificada del algoritmo de Metropolis-Hastings y obtenga nuevamente 5000 muestras para las distribuciones presentadas en el ejercicio anterior utilizando la nueva implementación.\n\nMuestreo utilizando el algoritmo de Metropolis-Hastings (II)\nUse el algoritmo de Metropolis-Hastings y una distribución de propuesta que crea conveniente para obtener 5000 muestras de las siguientes distribuciones de probabilidad:\n\n\\(\\text{Beta}(\\alpha=4, \\beta=8)\\)\n\\(\\text{Gamma}(k = 3, \\theta = 2)\\)\n\\(\\frac{1}{2}\\text{Beta}(\\alpha=10, \\beta=3) + \\frac{1}{2}\\text{Beta}(\\alpha=3, \\beta=10)\\)\n\nRealice un análisis similar al realizado en el Ejercicio 1.\nA jugar con la distribución de propuesta!\nSuponga que se desea obtener muestras de una distribución \\(\\text{Normal}(4, 1)\\) utilizando Metropolis-Hastings y la siguiente distribución de propuesta:\n\\[\n\\mu' | \\mu \\sim \\text{Uniforme}(\\mu - w, \\mu + w)\n\\]\nObtenga \\(n=5000\\) muestras con \\(w \\in \\{0.01, 1, 100\\}\\) y compute la probabilidad de aceptación. Luego, para cada \\(w\\), grafique la distribución obtenida y visualice la cadena de Markov utilizando un traceplot.\n\n¿Cómo se relaciona \\(w\\) con el desempeño del muestreo?\n¿Cómo se relaciona \\(w\\) con la probabilidad de aceptación? Justifique su respuesta utilizando la ecuación del criterio de aceptación.\n\nModelo Normal-Normal\nSe desea estudiar el tiempo promedio que los estudiantes de estadística dedican por semana a la materia Estadística Bayesiana. Para eso se propone utilizar un modelo Normal-Normal, con \\(\\sigma=1.2\\) conocido.\n\nElija una distribución a priori para el parámetro \\(\\mu\\).\nDescriba el modelo matemáticamente.\nDetermine una distribución de propuesta adecuada para este problema. Explique.\nObtenga 2000 muestras del posterior de \\(\\mu\\). Ajuste los parámetros de la distribución de propuesta hasta que los resultados se vean adecuados.\nGrafique un histograma de las muestras obtenidas y concluya sobre el desempeño de la aproximación.\n\nPara resolver este problema utilice los datos que se leen con el siguiente codigo:\n\nurl <- paste0(\n    \"https://raw.githubusercontent.com/estadisticaunr/estadistica-bayesiana/\",\n    \"main/datos/tiempo-estudio-eb.csv\"\n)\ndf_estudio <- readr::read_csv(url)\n\nModelo Beta-Binomial\nSe desea estimar el posterior del parámetro \\(\\pi\\) en el siguiente modelo Beta-Binomial:\n\\[\n\\begin{aligned}\nY &\\sim \\text{Binomial}(n, \\pi) \\\\\n\\pi &\\sim \\text{Beta}(2, 3)\n\\end{aligned}\n\\]\nSe observan \\(n=10\\) ensayos de Bernoulli y se registran \\(y=3\\) éxitos. Determine una distribución de propuesta adecuada y obtenga muestras de la distribución a posteriori del parámetro \\(\\pi\\) utilizando el algoritmo de Metropolis-Hastings.\nDe ser necesario, ajuste los parámetros de la distribución de propuesta.\nModelo Poisson\nEn el ejercicio ¡Ostras! ¡Estoy haciendo inferencia bayesiana! de la Práctica 1 se reportó que la cantidad de especies marinas bivalvas descubiertas cada año entre 2010 y 2015 fue 64, 13, 33, 18, 30 y 20.\nSea \\(Y_t\\) la cantidad de especies descubierta en el año \\(2009 + t\\) (e.g. \\(Y_1 = 64\\) es el conteo para el año 2010) y el siguiente modelo:\n\\[\n\\begin{aligned}\nY_t        &\\sim \\text{Poisson}(\\lambda_t) \\\\\n\\lambda_t  &= \\exp (\\alpha + \\beta t) \\\\\n\\alpha     &\\sim \\text{Normal}(0, 10^2) \\\\\n\\beta      &\\sim \\text{Normal}(0, 10^2)\n\\end{aligned}\n\\]\nAjuste el siguiente modelo utilizando Metropolis-Hastings y verifique la convergencia de las cadenas de Markov. \nMetropolis-Hastings multivariado\nUse el algoritmo de Metropolis Hastings para obtener 1000 muestras de la distribución \\(\\text{MVN}(\\pmb{\\mu}, \\pmb{\\Sigma})\\) donde\n\\[\n\\begin{array}{cc}\n    \\pmb{\\mu} = \\begin{bmatrix}1.2 \\\\ 0.8 \\end{bmatrix}, &\n    \\pmb{\\Sigma} = \\begin{bmatrix}3 & 0.2 \\\\ 0.2 & 2 \\end{bmatrix}\n\\end{array}\n\\]\nUtilice una distribución de propuesta \\(\\text{MVN}(\\mathbf{0}_2, \\mathbf{I}_2\\sigma)\\) con \\(\\sigma = 0.2\\).\nMetropolis-Hastings para regresión\nRepita el ejercicio Aproximación de grilla en 2 dimensiones pero utilice Metropolis-Hastings para obtener muestras del posterior en vez del método de la grilla.\nDemostrar que la distribución estacionaria del algoritmo de Metropolis-Hastings es la distribución objetivo \\(p(\\pmb{\\theta} | \\mathbf{y})\\)"
  },
  {
    "objectID": "practica/practica_03.html#hamiltonian-monte-carlo-hmc-y-el-not-u-turn-sampler-nuts",
    "href": "practica/practica_03.html#hamiltonian-monte-carlo-hmc-y-el-not-u-turn-sampler-nuts",
    "title": "Práctica - Unidad 3",
    "section": "Hamiltonian Monte Carlo (HMC) y el Not-U-Turn Sampler (NUTS)",
    "text": "Hamiltonian Monte Carlo (HMC) y el Not-U-Turn Sampler (NUTS)\nTenemos que completarlo…"
  },
  {
    "objectID": "practica/practica_03.html#diagnósticos",
    "href": "practica/practica_03.html#diagnósticos",
    "title": "Práctica - Unidad 3",
    "section": "Diagnósticos",
    "text": "Diagnósticos\n\nDescribir medidas de diagnóstico (I)\nEn sus propias palabras, explique que son \\(\\text{ESS}\\), \\(\\hat{R}\\) y \\(\\text{MCSE}\\). Considere:\n\n¿Qué miden?\n¿Qué potencial problema de MCMC detectan? \n\nDescribir medidas de diagnóstico (II)\nEn sus propias palabras, explique por qué las técnicas de estimación del posterior basadas en MCMC necesitan diagnósticos de convergencia. En particular, contraste estos con los métodos conjugados descritos en la Unidad 2 que no necesitan esos diagnósticos. ¿Qué es diferente entre los dos métodos de inferencia? \nProblemitas de MCMC\nPara cada escenario de simulación mediante MCMC descrito a continuación, explique cómo el escenario podría afectar la aproximación del posterior.\n\nLa cadena se mezcla muy lentamente\nLa cadena presenta alta auto-correlación.\nLa cadena tiende a quedarse “trabada” \n\nVamos de paseo\nElabore traceplots que le permitan visualizar la traza de la cadena de Markov utilizada en el ejercicio Modelo Normal-Normal de la sección Metropolis-Hastings.\nLuego, repita el ejercicio utilizando 4 cadenas independientes y grafique sus trazas en un mismo gráfico. ¿Qué puede concluir sobre la convergencia y la mezcla de las cadenas?\nPrimeros pasitos con \\(\\hat{R}\\)\nRepita lo realizado en el ejercicio Modelo Beta-Binomial de la sección Metropolis-Hastings utilizando 4 cadenas independientes. Luego:\n\nCalcule la varianza intra-cadenas \\(W\\)\nCalcule la varianza entre-cadenas \\(B\\)\nCalcule \\(\\hat{R}\\) y concluya sobre el resultado obtenido.\n\n\n\\(\\hat{R}\\) para un muestreo independiente\nEn un determinado problema se encuentra que el posterior del parámetro \\(\\pi\\) de un modelo con verosimilitud binomial está dado por\n\\[\n\\pi | \\mathbf{y} \\sim \\text{Beta}(12, 6)\n\\]\n\nObtenga 4 conjuntos independientes de 1000 muestras independientes de esta distribución.\nCalcule \\(W\\), \\(B\\), y \\(\\hat{R}\\) considerando que cada conjunto representa una cadena.\nExplique el resultado de \\(\\hat{R}\\).\n\nBonus\n\n¿Se puede concluir que cada uno de los muestreos realizados representan realizaciones de una cadena de Markov? ¿Por qué?\n¿Por qué no fue necesario descartar un conjunto de muestras de warm-up?\n\nFunción de autocorrelación\nUtilice las 4 cadenas obtenidas en el ejercicio Primeros pasitos con \\(\\hat{R}\\) y grafique la función de autocorrelación y calcule el coeficiente de autocorrelación utilizando un rezago unitario. Concluya sobre la dependencia entre las muestras obtenidas.\nTamaño de muestra efectivo\nUtilice las muestras obtenidas en el ejercicio anterior para calcular el tamaño de muestra efectivo.\nExperimentos con el tamaño de muestra efectivo\nSuponga una distribución \\(\\text{Normal}(0, 1^2)\\). Obtenga \\(n\\) muestras independientes utilizando rnorm() y \\(n\\) muestras dependientes utilizando Metropolis-Hastings con \\(n \\in \\{10, 50, 100, 500, 1000, 10000\\}\\).\n\nCalcule el temaño de muestra efectivo en todos los escenarios simulados.\nDescriba el comportamiento del tamaño de muestra efectivo conforme se incrementa el número de muestras.\n¿Por qué se observan los comportamientos descritos?\n\n¡Rompan todo! Un caso simulado\nLos siguientes gráficos muestran las trazas y las distribuciones que resultan al obtener muestras de un posterior utilizando dos cadenas de Markov independientes. Estos muestreos fueron realizados de manera que presenten algunos problemas. Describa cuales son los problemas que puede observar en los siguientes gráficos y explique por qué no utilizaría estas muestras para obtener conclusiones sobre el posterior.\n\n\n\n\nGráfico 1\n\n\n\n\n\n\n\n\n\n\n\nGráfico 2\n\n\n\n\n\n\n\n\n\n\n\nGráfico 3\n\n\n\n\n\n\n\n\n\n\n\nGráfico 4\n\n\n\n\n\n\n\n\n\n\n¡Rompan todo! Un caso real\nAl igual que en el ejercicio anterior, se presentan traceplots donde el muestreo del posterior presenta problemas. En este caso, los gráficos que se observan fueron obtenidos en el marco de un problema real, y se usan 4 cadenas en vez de 2. Nuevamente, describa cuales son los problemas que puede observar en los siguientes gráficos y explique por qué no utilizaría estas muestras para obtener conclusiones sobre el posterior.\n\nGráfico 1\n\n\n\n\n\n\n\n\n\n\n\nGráfico 2\n\n\n\n\n\n\n\n\n\n\nAdemás, responda:\n\n¿Cuál gráfico se asocia a un mayor tamaño de muestra efectivo?\n¿Qué grafico muestra peor mezcla entre cadenas?\n¿En qué gráfico se puede observar que las cadenas convergen a la misma distribución?"
  },
  {
    "objectID": "practica/practica_03.html#programación-probabilística---stan-y-rstan",
    "href": "practica/practica_03.html#programación-probabilística---stan-y-rstan",
    "title": "Práctica - Unidad 3",
    "section": "Programación probabilística - Stan y RStan",
    "text": "Programación probabilística - Stan y RStan\n\nMCMC con RStan: Precalentamiento (I)\nUtilice la información proporcionada para definir la estructura del modelo bayesiano utilizando RStan. No es necesario ejecutar nada, solo necesita proporcionar el código correcto.\n\n\\(Y | \\pi \\sim \\text{Binomial}(\\pi, 20)\\) con \\(\\pi \\sim \\text{Beta}(1, 1)\\)\n\\(Y | \\lambda \\sim \\text{Poisson}(\\lambda)\\) con \\(\\lambda \\sim \\text{Gamma}(4, 2)\\)\n\\(Y | \\mu \\sim \\text{Normal}(\\mu, 1^2)\\) con \\(\\mu \\sim \\text{Normal}(0, 10^2)\\) \n\nMCMC con RStan: Precalentamiento (II)\nUtilice la información proporcionada para (1) definir la estructura del modelo bayesiano y (2) obtener muestras del posterior utilizando RStan. No es necesario ejecutar nada, solo necesita proporcionar el código correcto.\n\n\\(Y | \\pi \\sim \\text{Binomial}(\\pi, 20)\\) con \\(\\pi \\sim \\text{Beta}(1, 1)\\) e \\(y = 12\\)\n\\(Y | \\lambda \\sim \\text{Poisson}(\\lambda)\\) con \\(\\lambda \\sim \\text{Gamma}(4, 2)\\) e \\(y = 3\\).\n\\(Y | \\mu \\sim \\text{Normal}(\\mu, 1^2)\\) con \\(\\mu \\sim \\text{Normal}(0, 10^2)\\) e \\(y = 12.2\\). \n\nModelo Beta-Binomial con Rstan (I)\nConsidere el modelo Beta-Binomial para \\(\\pi\\) con \\(Y | \\pi \\sim \\text{Binomial}(\\pi, n)\\) y \\(\\pi \\sim \\text{Beta}(3, 8)\\). Suponga que en \\(n = 10\\) ensayos independientes observa \\(y = 2\\) éxitos.\n\nObtenga muestras del posterior de \\(\\pi\\) con RStan utilizando 3 cadenas y 12000 iteraciones por cadena.\nGrafique la traza de cada una de las tres cadenas.\n¿Cuál es el rango de valores en el eje x del traceplot? ¿Por qué el valor máximo de este rango no es 12000?\nCree un gráfico que permita visualizar la función de densidad de los valores obtenidos con cada una de las tres cadenas.\nUtilizando lo estudiado en la Unidad 2, especifique el posterior de \\(\\pi\\). ¿Cómo se compara con la aproximación mediante MCMC?\n\nModelo Beta-Binomial con Rstan (II)\nRepita el ejercicio anterior utilizando \\(\\pi \\sim \\text{Beta}(4, 3)\\), donde observa \\(y = 4\\) éxitos en \\(n = 12\\) ensayos independientes.\nModelo Gamma-Poisson con Rstan (I)\nConsidere el modelo Gamma-Poisson para \\(\\lambda\\) con \\(Y_i | \\lambda \\sim \\text{Poisson}(\\lambda)\\) y \\(\\lambda \\sim \\text{Gamma}(20, 5)\\). Suponga que cuenta con \\(n = 3\\) observaciones independientes \\((y_1, y_2, y_3) = (0, 1, 0)\\)\n\nObtenga muestras del posterior de \\(\\lambda\\) con RStan utilizando 4 cadenas y 10000 iteraciones por cadena.\nGrafique la traza y la función de densidad de cada una de las tres cadenas.\nA partir del gráfico de la función de densidad, ¿cuáles suelen ser, a posteriori, los valores más probables de \\(\\lambda\\)?\nUtilizando lo estudiado en la Unidad 2, especifique el posterior de \\(\\lambda\\). ¿Cómo se compara con la aproximación mediante MCMC?\n\nModelo Gamma-Poisson con Rstan (II)\nRepita el ejercicio anterior utilizando el prior \\(\\lambda \\sim \\text{Gamma}(5, 5)\\).\nModelo Normal-Normal con Rstan (I)\nRepita los mismos pasos del ejercicio Modelo Gamma-Poisson con Rstan (I) pero considere el modelo Normal-Normal para \\(\\mu\\) con \\(Y_i | \\mu \\sim \\text{Normal}(\\mu, 1.3^2)\\) y \\(\\mu \\sim \\text{Normal}(10, 1.2^2)\\). Suponga que cuenta con \\(n = 4\\) observaciones independientes \\((y_1, y_2, y_3, y_4) = (7.1, 8.9, 8.4, 8.6)\\)\nModelo Normal-Normal con Rstan (II)\nRepita el ejercicio anterior con el modelo Normal-Normal pero ahora considere \\(Y_i | \\mu \\sim \\text{Normal}(\\mu, 8^2)\\) y \\(\\mu \\sim \\text{Normal}(-15, 2^2)\\). Suponga que en \\(n = 5\\) observaciones independientes observa \\((y_1, y_2, y_3, y_4, y_5) = (−10.1, 5.5, 0.1,−1.4, 11.5)\\)\nUn modelo que es un poco ¿complicado?\nConsidere el siguiente modelo\n\\[\n\\begin{aligned}\n\\text{mass}_i &\\sim \\text{Normal}(\\mu_i, \\sigma^2) \\\\\n\\mu_i         &= \\theta_1 + \\theta_2 + \\text{age}_i^{\\theta_3} \\\\\n\\theta_1      &\\sim \\text{Normal}(0, 100^2) \\\\\n\\theta_2      &\\sim \\text{Uniforme}(0, 20000) \\\\\n\\theta_3      &\\sim \\text{Normal}(0, 1) \\\\\n\\sigma^2      &\\sim \\text{InvGamma}(0.01, 0.01)\n\\end{aligned}\n\\]\ny los siguientes datos\n\nedad <- c(2, 15, 14, 16, 18, 22, 28)\npeso <- c(29.9, 1761, 1807, 2984, 3230, 5040, 5654)\nn <- length(edad)\ndata_list <- data.frame(peso = peso, edad = edad, n = n)\n\n\nAjuste el modelo utilizando RStan\nObtenga una visualización de la edad versus el peso junto con una curva que indique la media a posteriori de \\(\\mu_i\\) para evaluar si el modelo ajusta bien.\nEstudie la convergencia de las cadenas de Markov.\nMencione tres medidas que podría tomar para mejorar la convergencia."
  },
  {
    "objectID": "practica/practica_03.html#otros",
    "href": "practica/practica_03.html#otros",
    "title": "Práctica - Unidad 3",
    "section": "Otros",
    "text": "Otros\n\nUna compañía pesquera de Comodoro Rivadavia se encuentra probando un nuevo método para estimar el peso de los peces que extrae del Mar Argentino. El objetivo de este método es obtener una estimación lo suficientemente buena del peso de cada pescado sin tener que pesarlos uno por uno, ya que es un proceso costoso en tiempo y labor. Para eso, seleccionaron una muestra de pescados, los pesaron y les midieron ciertos aspectos morfológicos (ancho, alto y largo). En el futuro, esperan recolectar estas mismas medidas morfológicas mediante una cámara especializada y utilizar un modelo para estimar el peso.\nEl modelo propuesto por el equipo de investigación es el siguiente:\n\\[\n\\begin{aligned}\n\\log(\\text{Peso}_i) &\\sim \\text{Normal}(\\mu, \\sigma) \\\\\n\\mu_i               &= \\beta_0 + \\beta_1 \\log(\\text{Largo}_i) \\\\\n\\sigma              &\\sim \\text{Gamma}(k, \\theta)\n\\end{aligned}\n\\]\nEl peso se encuentra medido en gramos y la longitud en centímetros. El equipo provee las muestras que obtuvieron del posterior. Las mismas se pueden leer en R utilizando el siguiente bloque de código.\n\nurl <- paste0(\n    \"https://raw.githubusercontent.com/estadisticaunr/estadistica-bayesiana/\",\n    \"main/datos/fish-market-posterior.csv\"\n)\ndf_posterior <- readr::read_csv(url)\nhead(df_posterior)\n\n# A tibble: 6 × 3\n  intercepto pendiente sigma\n       <dbl>     <dbl> <dbl>\n1      -4.44      3.08 0.408\n2      -4.30      3.05 0.431\n3      -4.49      3.12 0.433\n4      -4.04      2.96 0.341\n5      -4.76      3.18 0.413\n6      -4.65      3.15 0.350\n\nAnalice de manera gráfica y analítica los posteriors marginales de los parámetros del modelo. Realice las transformaciones de parámetros que crea conveniente para facilitar la comprensión del análisis.\nConsidere un pescado cuya longitud es de 30 centímetros.\n\nObtenga y grafique la distribución a posteriori del peso medio.\nObtenga y grafique la distribución predictiva a posteriori del peso.\nInterprete los resultados.\n\nGrafique la curva de regresión junto a una banda de credibilidad del 95% en el plano de las variables originales y en el plano de las variables transformadas.\nAgregue a los gráficos anteriores una banda de credibilidad del 95% para la distribución predictiva a posteriori. Interprete los resultados.\n\nConsidere la siguiente familia de distribuciones normales en 2D\n\\[\nf(\\mathbf{x} | \\pmb{\\Sigma}, \\pmb{\\mu} = \\mathbf{0})\n= \\frac{1}{\\det(2\\pi\\pmb{\\Sigma})^{-\\frac{1}{2}}}\n\\exp[{-\\frac{1}{2} \\mathbf{x}^T \\pmb{\\Sigma}^{-1} \\mathbf{x}}]\n\\]\ny las siguientes matrices de covarianza\n\\[\n\\begin{array}{cc}\n    \\pmb{\\Sigma}_1 = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix} &\n    \\pmb{\\Sigma}_2 = \\begin{bmatrix} 1 & 0.2 \\\\ 0.2 & 1 \\end{bmatrix}\n    \\\\ \\\\\n    \\pmb{\\Sigma}_1 = \\begin{bmatrix} 1 & 0.5 \\\\ 0.5 & 1 \\end{bmatrix} &\n    \\pmb{\\Sigma}_2 = \\begin{bmatrix} 0.1 & 0 \\\\ 0 & 1 \\end{bmatrix}\n    \\\\ \\\\\n    \\pmb{\\Sigma}_1 = \\begin{bmatrix} 1 & 0.9 \\\\ 0.9 & 1 \\end{bmatrix} &\n    \\pmb{\\Sigma}_2 = \\begin{bmatrix} 0.01 & 0 \\\\ 0 & 1 \\end{bmatrix}\n\\end{array}\n\\]\nQue dan lugar a las siguientes funciones de densidad:\n\n\n\n\n\n\n\n\n\nParte 1: Metropolis-Hastings\n\nUtilice el algoritmo Metropolis-Hastings para obtener \\(n=10000\\) muestras de cada una de las distribuciones.\nCalcule la probabilidad de aceptación.\nGrafique la función de autocorrelación y calcule la cantidad de muestras efectivas.\nAnalice como varía la probabilidad de aceptación y la cantidad de muestras efectivas según las diferentes características de la distribución objetivo.\n¿Cuáles son las ventajas y desventajas del algoritmo de Metropolis-Hastings según lo que puede concluir a partir de esta aplicación? Comente dificultades con las que se haya encontrado.\n\nParte 2: Hamiltonian Monte Carlo\n\nUtilice el algoritmo HMC para obtener \\(n=10000\\) muestras de cada una de las distribuciones.\nCalcule la probabilidad de aceptación.\nGrafique la función de autocorrelación y calcule la cantidad de muestras efectivas.\nAnalice como varía la probabilidad de aceptación y la cantidad de muestras efectivas según las diferentes características de la distribución objetivo.\n¿Cuáles son las ventajas y desventajas del algoritmo de Metropolis-Hastings según lo que puede concluir a partir de esta aplicación? Comente dificultades con las que se haya encontrado.\n\n\n\n\nEjercicios que faltan\n\nUtilizar HMC para la normal multivariada con correlación moderada y alta correlación\nUtilizar HMC para los modelos donde se usó MH\nAlgun caso donde los diagnosticos no den bien…\n\nPuede ser cuando el HMC no esta bien tuneado\nPensar algunos otros (deberia buscar en cosas que he hecho)\n\nAlgo con brms?\n\nNota: Para los que dicen “utilizar HMC” estaria bueno que proveamos una funcion que use HMC, sin que tengan que usar Stan."
  },
  {
    "objectID": "practica/practica_04.html",
    "href": "practica/practica_04.html",
    "title": "Práctica - Unidad 4",
    "section": "",
    "text": "Descargar PDF"
  },
  {
    "objectID": "practica/practica_04.html#regresión-lineal",
    "href": "practica/practica_04.html#regresión-lineal",
    "title": "Práctica - Unidad 4",
    "section": "Regresión lineal",
    "text": "Regresión lineal\n\nMi primer regresión bayesiana\nEl conjunto de datos sales contiene los montos semanales de inversión en publicidad y de ingresos de una determinada compañía. Considere el siguiente modelo de regresión lineal simple:\n\\[\n\\begin{aligned}\n\\mu_i &= \\beta_0 + \\beta_1 \\text{publicidad}_i \\\\\n\\text{ventas}_i &\\sim \\text{Normal}(\\mu_i, \\sigma^2)\n\\end{aligned}\n\\]\n\nAjuste el modelo utilizando {brms} y sus priors por defecto.\nConstruya un gráfico que muestre las ventas en función de la inversión en publicidad y superponga la recta de regresión estimada.\n\nMejorando mi regresión bayesiana\nConsidere la siguiente versión del modelo del ejercicio anterior que propone distribuciones a priori para los parámetros del modelo: \\[\n\\begin{aligned}\n\\mu_i &= \\beta_0 + \\beta_1 \\text{publicidad}_i \\\\\n\\text{ventas}_i &\\sim \\text{Normal}(\\mu_i, \\sigma^2) \\\\\n\\beta_0 &\\sim \\text{Normal}(\\overline{\\text{ventas}}, 10) \\\\\n\\beta_1 &\\sim \\text{Normal}(0, 0.5) \\\\\n\\sigma^2 &\\sim \\text{Normal}^+(5)\n\\end{aligned}\n\\]\n\nAjuste el modelo utilizando {brms} y los priors sugeridos.\nConstruya un gráfico que muestre las ventas en función de la inversión en publicidad, superponga la recta de regresión estimada, y el intervalo de credibilidad del 95% para la recta de regresión.\n\nComparando de lm() y brm()\nUtilice datos simulados para comparar la estimación por mínimos cuadrados con la estimación Bayesiana en modelos de regresión.\n\nSimule 100 observaciones del modelo \\(Y = 2 + 3X + \\varepsilon\\) donde los valores del predictor \\(X\\) se obtienen de una distribución \\(\\text{Uniforme}(0, 20)\\) y los errores son obtenidos de manera independiente de una distribución \\(\\text{Normal}(0, 5^2)\\).\nAjuste el modelo de regresión utilizando lm() y brm() del paquete {brms} utilizando priors por defecto.\nVerifique que ambos métodos arrojan resultados similares.\nRepresente gráficamente los datos y las dos rectas de regresión.\nIntente repetir la simulación, pero esta vez cree las condiciones para que ambos enfoques den resultados diferentes. \n\nLa altura… ¿se hereda?\nEl conjunto de datos de las alturas (heights) contiene las alturas (en pulgadas) de 5524 pares de madres e hijas registradas en un estudio realizado por Karl Pearson y Alice Lee en 1903.\n\nElabore un gráfico que permita ver la relación entre las alturas de las madres y las hijas. Aplique las técnicas que crea necesaria para obtener una visualización informativa y fidedigna.\n¿Por qué es adecuado utilizar un modelo de regresión lineal?\nAjuste el siguiente modelo de regresión lineal utilizando {brms} y priors por defecto:\n\n\\[\n\\begin{aligned}\n\\mu_i &= \\beta_0 + \\beta_1 \\text{altura\\_madre}_i \\\\\n\\text{altura\\_hija}_i &\\sim \\text{Normal}(\\mu_i, \\sigma^2)\n\\end{aligned}\n\\]\n\nCalcule la media, el desvío estándar y el intervalo de credibilidad del 95% para los parámetros del modelo utilizando el posterior.\nInterprete los coeficientes del modelo.\nSuperponga la recta de regresión en el gráfico donde se visualiza la relación entre las variables.\nObtenga el posterior del peso medio de una hija cuya madre mide 58 pulgadas. \n\nClima en Australia\nEl conjunto de datos weather_WU datos climáticos correspondientes a 100 días en dos ciudades de Australia: Uluru y Wollongong. Se intentará predecir la temperatura a las 3 de la tarde, utilizando otras variables.\nConsidere los siguientes cuatro modelos:\n\n\\(m_1\\): temp3pm ~ temp9am\n\\(m_2\\): temp3pm ~ location\n\\(m_3\\): temp3pm ~ temp9am + location\n\\(m_4\\): temp3pm ~ .\n\n\nAjuste cada uno de los modelos y construya gráficas para mostrar los parámetros obtenidos\nRealice pruebas predictivas a posteriori para comparar los modelos\nCompare los ELPD de cada modelo utilizando LOO \n\n\n\n\n\n\nParque Nacional Uluṟu-Kata Tjuṯa en Uluru, Australia. Foto de Snowscat en Unsplash\n\n\n\n\nPingüinos\nConsidere el dataset de pingüinos de Palmer (penguins) y los siguientes modelos:\n\n\\(m_1\\): body_mass_g ~ flipper_length_mm\n\\(m_2\\): body_mass_g ~ species\n\\(m_3\\): body_mass_g ~ flipper_length_mm + species\n\\(m_4\\): body_mass_g ~ flipper_length_mm + species + flipper_length_mm:species\n\\(m_5\\): body_mass_g ~ flipper_length_mm + bill_length_mm + bill_depth_mm\n\n\nAjuste cada uno de los modelos y construya gráficas para mostrar los parámetros obtenidos\nRealice pruebas predictivas a posteriori para comparar los modelos\nCompare los ELPD de cada modelo utilizando LOO \n\nDe tal palo…\nEl dataset child_iq contiene información de los resultados de tests de coeficiente intelectual de niños de 3 años, educación de la madre, y edad de la madre cuando dio a luz.\n\nAjuste un modelo de regresión del puntaje del bebé a los 3 años en función de la edad de la madre\nConsidere ahora un modelo que incluya la educación de la madre\n\nLa pinta es lo de menos…\nHamermesh y Parker estudiaron la relación entre los resultados de los estudiantes en un curso y la belleza de los instructores. La determinación de la belleza se hizo a partir de las opiniones de seis estudiantes que no participaron de los cursos y no conocían las notas. Los datos se encuentran en el archivo beauty.\n\nConsidere un modelo de regresión courseevaluation ~ btystdave\nTo Do?\n\nIngresos\nEl dataset earnings contiene los resultados de la encuesta realizada por Ross sobre Trabajo, Familia y Bienestar.\n\nAjuste un modelo que prediga ingreso en función de altura. ¿Qué transformación sería necesaria para interpretar el intercepto como el ingreso promedio de una persona con altura promedio?\n\n!Kung\nLos !Kung son un pueblo que habita en el desierto de Kalahari entre Botsuana, Namibia y Angola. Hablan la lengua !Kung, que se destaca por su amplio uso de consonantes clic (chasquido consonántico). El !K del nombre ǃKung es un sonido como cuando sale un corcho de una botella.\nEl archivo Howell1 contiene datos de un censo parcial realizado por Dobe Howell acerca de la población !Kung.\nConsidere un modelo de altura en función del peso.\n\nDetermine e interprete las distribuciones a posteriori de los parámetros\nConstruya un gráfico de altura en función del peso, incluya las observaciones de los individuos, la recta de regresión MAP, el intervalo del 80% para la media y y el intervalo del 80% para la altura predicha.\nRealice predicciones para individuos cuyos pesos son: 46.95, 43.72, 64.78, 32.59 y 54.63. Calcule la altura esperada y el intervalo del 89%.\n\nZorros urbanos\nConsidere del conjunto de datos sobre zorros urbanos (foxes). Ajuste tres modelos:\n\n\\(m_1\\): weight ~ area\n\\(m_2\\): weight ~ groupsize\n\\(m_3\\): weight ~ area + groupsize\n\n\nPara los modelos \\(m_1\\) y \\(m_2\\), represente gráficamente los resultados, incluyendo la recta de regresión MAP, su intervalo del 89% y el intervalo de predicción del 89%. ¿Es alguna de las dos variables importantes para predecir la masa de un zorro?\nRepresentar gráficamente las predicciones del modelo para cada predictor, dejando el otro constante en su valor medio. ¿Qué puede decirse sobre la importancia de las variables para predecir la masa de un zorro?\n\nUn prior informativo marca la diferencia\nConsidere el conjunto de datos sobre belleza y proporción de sexos (sexratio) . Estos datos provienen de un estudio de adolescentes estadounidenses cuyo atractivo en una escala de cinco puntos fue evaluado por entrevistadores en una encuesta cara a cara. Años más tarde, muchos de estos encuestados tuvieron hijos y se registraron ciertos atributos entre los cuales se incluyó el sexo. El objetivo del análisis es comparar la proporción de sexos de los hijos según la belleza de los padres. Para ello considere el siguiente modelo de regresión:\n\\[\n\\begin{aligned}\n\\mu_i &= \\beta_0 + \\beta_1 \\text{belleza}_i \\\\\n\\text{pf}_i &\\sim \\text{Normal}(\\mu_i, \\sigma^2)\n\\end{aligned}\n\\]\nDonde \\(\\text{pf}\\) representa la proporción de bebés de sexo femenino y \\(\\text{belleza}\\) representa el grupo de belleza de los padres.\n\nAjuste el modelo utilizando mínimos cuadrados.\nAjuste el modelo con brm() y sus priors por defecto.\nCompare el ajuste de ambos modelos.\nExplore los priors utilizados por {brms} y la distribución predictiva a priori. ¿Qué puede concluir?\nProponga distribuciones a priori informativas.\nAjuste el modelo utilizando brm() y los priors informativos.\nCompare el resultado con los obtenidos anteriormente y concluya.\n\n¡A la pesca de priors!\nEl conjunto de datos fish-market contiene mediciones morfológicas realizadas sobre pescados de diferentes especies. El objetivo es construir un modelo de regresión lineal que permita predecir el peso de los pescados en base a sus otros atributos.\nUno de los modelos propuestos es el siguiente:\n\\[\n\\begin{aligned}\n\\log(\\text{Weight}_i) &\\sim \\text{Normal}(\\mu_i, \\sigma) \\\\\n\\mu_i  &= \\beta_{0, j[i]} + \\beta_{1, j[i]} \\log(\\text{Length1}_i)\n\\end{aligned}\n\\]\n\\(\\text{Weight}_i\\) es el peso del i-ésimo pescado en gramos y \\(\\text{Length1}_i\\) es la longitud del i-ésimo pescado en centímetros. La letra \\(j\\) indexa las especies de los pescados. Por lo tanto, en este modelo cada especie tiene su propio intercepto y pendiente.\n\nImplemente el modelo utilizando {brms} y los siguientes priors no informativos \\[\n\\begin{aligned}\n\\beta_{0, j[i]} &\\sim \\text{Normal}(0, 10) \\\\\n\\beta_{1, j[i]} &\\sim \\text{Normal}(0, 5)\n\\end{aligned}\n\\]\nObtenga y visualice la distribución predictiva a priori.\nElabore un gráfico y describa la función de densidad a priori de los parámetros \\(\\beta_{0, j[i]}\\) y \\(\\beta_{1, j[i]}\\).\nProponga priors más adecuados en base a la interpretación de los parámetros del modelo y la información que tenga del problema.\nNuevamente, obtenga y visualice la distribución predictiva a priori y compare con el resultado obtenido anteriormente.\nAjuste el modelo, obtenga la distribución predictiva a posteriori y grafíquela.\n\n\n\n\n\n\nEspecies de peces de todas variedades y tamaños.\n\n\n\n\nEn búsqueda del modelo adecuado\nContinuando con los datos del ejercicio anterior, El objetivo es construir un modelo de regresión lineal que permita predecir el peso de los pescados en base a sus otros atributos.\nConsidere los siguientes modelos\n\n\\(m_1\\): log(Weight) ~ 0 + Species\n\\(m_2\\): log(Weight) ~ 0 + Species + log(Length1)\n\\(m_3\\): log(Weight) ~ 0 + Species + log(Length1):Species\n\\(m_4\\): log(Weight) ~ 0 + Species + log(Length1):Species + log(Height)\n\\(m_5\\): log(Weight) ~ 0 + Species + log(Length1):Species + log(Height):Species\n\n\nAjuste cada uno de los modelos.\nEstime el ELPD de cada modelo utilizando LOO y seleccione el modelo más adecuado de acuerdo a este criterio.\nExplique el resultado.\n\nComparación de modelos\nSe recopilaron datos (mesquite) con el fin de desarrollar un método para estimar la producción total (biomasa) de hojas de mesquite utilizando parámetros fácilmente medibles de la planta, antes de que se realice la cosecha real. Se tomaron dos conjuntos separados de mediciones, uno en un grupo de 26 arbustos de mesquite y otro en un grupo diferente de 20 arbustos de mesquite medidos en un momento diferente del año. Todos los datos se obtuvieron en la misma ubicación geográfica, pero ninguno constituyó una muestra estrictamente aleatoria. La variable de resultado es el peso total (en gramos) de material fotosintético obtenido de la cosecha real del arbusto. Las variables de entrada son:\n\n\n\n\n\n\n\nNombre\nDescripción\n\n\n\n\ndiam1\nDiámetro de la copa medido a lo largo del eje más largo del arbusto (metros)\n\n\ndiam2\nDiámetro de la copa medido a lo largo del eje más corto (metros)\n\n\ncanopy_height\nAltura de la copa\n\n\ntotal_height\nAltura total del arbusto\n\n\ndensity\nNúmero de tallos primarios por planta\n\n\ngroup\nGrupo de mediciones (0 para el primer grupo, 1 para el segundo)\n\n\n\n\nRealice un análisis exploratorio de los datos.\nAjuste el modelo weight ~ diam1 + diam2 + canopy_height + total_height + density + group.\nExplore y describa el posterior.\nEstime ELPD mediante PSIS-CV con la función loo(), analice los valores de las estimaciones del parámetro \\(k\\) de la distribución generalizada de Pareto y otros valores de la salida que crea relevant, ¿qué puede concluir?\nEstime ELPD mediante K-fold cross validation con \\(K=10\\). Compare la estimación con el resultado obtenido mediante PSIS-CV y concluya.\nAjuste el modelo transformando todas las variables numéricas con la función logarítmica. ¿Cómo afecta esta transformación la interpretación de los coeficientes?\nEstime ELPD mediante PSIS-CV con la función loo(). Concluya acerca de la estabilidad del cómputo. ¿Es posible comparar la la estimación con la obtenida en el inciso iv? ¿Por qué?\nCon ambos modelos, obtenga y grafique la distribución predictiva a posteriori comparándola con los datos observados ¿Cuál de los modelos representa mejor a los datos?\n\n\n\n\n\n\nUn árbol de mesquite.Foto de Sergei Bogomyakov, Alamy Stock Photo.\n\n\n\n\n\n\nSecundarios en Portugal\nSe cuenta con un conjunto de datos sobre 343 estudiantes de secundaria de Portugal (portugal) y se desea predecir la calificación final en matemáticas del último año en base a un gran número de predictores potencialmente relevantes.\nEl listado de variables se compone por: escuela del estudiante, sexo del estudiante, edad del estudiante, tipo de domicilio del estudiante, tamaño de la familia, estado de convivencia de los padres, educación de la madre, educación del padre, tiempo de viaje del hogar a la escuela, tiempo de estudio semanal, número de fracasos escolares pasados, apoyo educativo adicional, clases pagadas adicionales dentro de la materia del curso, actividades extracurriculares, si el estudiante asistió a una guardería, si el estudiante desea cursar estudios superiores, acceso a Internet en el hogar, si el estudiante tiene una relación romántica, calidad de las relaciones familiares, tiempo libre después de la escuela, si el estudiante sale con amigos, consumo de alcohol entre semana, consumo de alcohol los fines de semana, estado de salud actual y número de ausencias escolares.\nPriors débilmente informativos\n\nAjuste un modelo de regresión lineal utilizando todos los predictores luego de estandarizarlos y con los siguientes priors \\[\n\\begin{aligned}\n\\beta_k &\\sim \\text{Normal}(0, 2.5) \\\\\n\\sigma  &\\sim \\text{Exponential}(1 / \\text{std}(y))\n\\end{aligned}\n\\]\nElabore un gráfico para visualizar los posteriors marginales y compárelos. ¿Qué puede concluir acerca de su incertidumbre?\nCalcule y compare la mediana del \\(R^2\\) bayesiano y del \\(R^2\\) calculado mediante LOO ¿Qué conclusión puede extraer de esta comparación?\n¿Cuál es el número efectivo de parámetros según LOO? ¿Qué indica?\nObtenga muestras del prior y del posterior del \\(R^2\\) bayesiano, compárelos utilizando una visualización y concluya considerando la elección de los priors débilmente informativos sobre \\(\\beta_k\\) y \\(\\sigma\\).\n\nPriors alternativos (I)\nSi se asume que muchos predictores pueden tener poca relevancia, se pueden escalar los priors independientes para que la suma de la varianza de los priors se encuentre alrededor de un valor razonable. En este caso, se cuenta con 26 predictores y se podría suponer que la proporción de la varianza explicada por los predictores está alrededor de 0.3. Entonces, un enfoque simple consiste en asignar priors independientes a los coeficientes de regresión con media 0 y desviación estándar \\(\\sqrt{0.3/26}\\text{sd}(y)\\) y un prior exponencial con media \\(\\sqrt{0.7}\\text{sd}(y)\\) para \\(\\sigma\\).\n\nAjuste el modelo nuevamente utilizando los siguientes priors \\[\n\\begin{aligned}\n\\beta_k &\\sim \\text{Normal}(0, \\sqrt{\\frac{0.3}{26}}\\text{sd}(y)) \\\\\n\\sigma  &\\sim \\text{Exponential}(1 / \\sqrt{0.7}\\text{sd}(y))\n\\end{aligned}\n\\]\nExplore la distribución a priori sobre \\(R^2\\) y compárela con la distribución obtenida con los priors débilmente informativos.\nCalcule ELPD mediante LOO y compare este modelo con el anterior.\nElabore un gráfico para visualizar los posteriors marginales. Compare este resultado con el obtenido con los priors débilmente informativos.\n\nPriors alternativos (II)\nOtra alternativa es asumir que solo algunos de los predictores tienen alta relevancia y que el resto de los predictores tienen una relevancia insignificante. Una posibilidad para modelar bajo este supuesto es el horseshoe prior regularizado1. Este prior utiliza distribuciones normales independientes con media 0 y varianza \\(\\tau^2\\lambda_k^2\\) para los coeficientes de regresión \\(\\beta_k\\) y se describe a continuación:\n\\[\n\\begin{aligned}\n\\beta_k   &\\sim \\text{Normal}(0, \\tau^2\\tilde{\\lambda}_k^2) \\\\\n\\tilde{\\lambda}_k^2 &= \\frac{c^2\\lambda_k^2}{c^2 + \\tau^2\\lambda_k^2} \\\\\nc & = \\sqrt{c'} \\text{SS} \\\\\nc' &\\sim \\text{InvGamma}(0.5 \\cdot SDF, 0.5 \\cdot SDF) \\\\\n\\lambda_k &\\sim \\text{StudentT}^+(\\text{df} = 1, \\mu = 0, \\sigma = 1 ) \\\\\n\\tau      &\\sim \\text{StudentT}^+(\\text{df} = 1, \\mu = 0, \\sigma = \\text{GS})\n\\end{aligned}\n\\]\ncon \\[\n\\begin{aligned}\n\\text{GS} = \\frac{p_0}{p - p_0} \\frac{\\sigma}{\\sqrt{n}} \\\\\n\\text{SS} = \\sqrt{\\frac{0.3}{p_0}} \\text{sd}(y) \\\\\n\\text{SDF} = 4\n\\end{aligned}\n\\]\ndonde \\(\\text{GS}\\), \\(\\text{SS}\\) y \\(\\text{SDF}\\) representan global scale, slab scale y slab degrees of freedom, respectivamente. Además, \\(p\\) representa la cantidad de predictores, 26, y \\(p_0\\) la cantidad de predictores que se espera que sean relevantes.\nIntuitivamente, el parámetro global \\(\\tau\\) empuja todos los \\(\\beta_k\\) hacia el 0, mientras que los parámetros locales \\(\\lambda_k\\) contribuyen a que algunos de los \\(\\beta_k\\) escapen del 0.\n\nUtilice \\(p_0 = 6\\) para ajustar el modelo con todos los predictores y grafique y analice los posteriors marginales.\nCompare este modelo con los ajustados anteriormente en base a sus ELPD estimados con LOO y concluya.\n\nPriors débilmente informativos con menos predictores\nAjuste el modelo de regresión con un subconjunto de predictores que crea conveniente y los priors débilmente informativos que se utilizaron inicialmente.\n\nVisualice los posteriors marginales.\nNuevamente, calcule y compare la mediana del \\(R^2\\) bayesiano y del \\(R^2\\) calculado mediante.\nCompare este modelo con el ajustado anteriormente en base a sus ELPD estimados con LOO y concluya sobre la capacidad predictiva de este modelo."
  },
  {
    "objectID": "practica/practica_01.html",
    "href": "practica/practica_01.html",
    "title": "Práctica - Unidad 1",
    "section": "",
    "text": "Descargar PDF"
  },
  {
    "objectID": "practica/practica_01.html#regla-de-bayes",
    "href": "practica/practica_01.html#regla-de-bayes",
    "title": "Práctica - Unidad 1",
    "section": "Regla de Bayes",
    "text": "Regla de Bayes\nEl propósito de esta sección de la práctica es resolver situaciones que impliquen la aplicación de la Regla de Bayes como se presenta tradicionalmente en un curso de Probabilidad.\n\nDemostración\nDemuestra la validez de la siguiente expresión de la Regla de Bayes\n\\[\nP(B_j | A) = \\frac{P(A | B_j) P(B_j)}{\\sum_{k=1}^{K}P(A | B_k) P(B_k)}\n\\]\ndonde \\(A\\) es un evento cualquiera y \\(\\{B_1, \\cdots, B_K\\}\\) forman una partición. Para ello siga los siguientes pasos\n\nDemuestre que \\(P(B_j | A) P(A) = P(A | B_j) P(B_j)\\).\nDemuestre que \\(P(A) = P(A \\cap B_1) + P(A \\cap \\{\\cup_{k=2}^{K}B_j\\})\\).\nDemuestre que \\(P(A) = \\sum_{k=1}^{K} P(A \\cap B_j)\\).\nJunte las partes para formar la Regla de Bayes.  \n\nEl test infalible\nEn una población dada, una de cada mil personas tiene una enfermedad. Se toma una persona al azar de la población, se le aplica un test para detectar dicha enfermedad, y el resultado es positivo. El test se caracteriza por dar positivo el 99% de las veces que una persona tiene la enfermedad. Además, dicho test tiene una tasa de falsos positivos del 5%.\n\n¿Cuál es la probabilidad de que la persona tenga efectivamente la enfermedad?\nSi realizamos el mismo análisis una segunda vez sobre el mismo paciente y obtenemos nuevamente positivo\n\n¿Cuál seria la probabilidad que el paciente esté enfermo?\n¿Y si diera negativo?\n¿Es el prior el mismo para el segundo análisis que para el primero? \n\n\n¿Es verdad que existen los vampiros? Versión Crepúsculo\nEdward quiere probarle a Bella que los vampiros existen. Según Bella, hay una probabilidad del 5% de que los vampiros existan. También cree que la probabilidad de que exista alguien con la piel brillante dado que los vampiros existen es del 70%, y que la probabilidad de que alguien tenga la piel rillante si los vampiros no existen es del 3%. Edward lleva a Bella al bosque y le muestra que de hecho su piel brilla como un 💎 ¿Cuál es la probabilidad que existan los vampiros? \n\n\n\n\n\nRobert Pattinson como Edward en Crepúsculo\n\n\n\n\nÁrboles enfermos\nUn vivero de la ciudad se destaca por vender una variedad de árboles nativos, incluyendo al jacarandá, ceibo, ombú, entre otros. Lamentablemente, el 18% de los árboles del vivero estan infectados con moho. Los árboles enfremos se componen en un 15% por jacarandás, 80% de ceibos, y 5% de otras especies. Los árboles sanos se componen por un 20% de jacarandás, 10% de ceibos, y 70% de otras especies. Con el objetivo de monitorear cuanto se propagó la enfermedad, una de las personas que trabaja en el vivero selecciona al azar uno de los árboles para testear.\n\n¿Cuál es la probabilidad a priori de que el árbolo tenga moho?\nResulta que el árbol seleccionado es un ceibo. ¿Cuál es la probabilidad de haber seleccionado un ceibo?\n¿Cuál es la probabilidad a posteriori de que el ceibo seleccionado tenga moho?\nCompare las probabilidades a priori y a posteriori de que el árbol tenga moho. ¿Cómo afecta el análisis el saber que el árbol es un ceibo? \n\n\n\n\n\n\nFlor del Ceibo, la flor nacional\n\n\n\n\nTransporte “El Impuntual”\nUna cierta empresa de transporte regional, que decidimos llamar “El Impuntual”, tiene servicios que van desde Rosario hasta Wheelwright varias veces al día, todos los días de la semana. Un 30% de los viajes salen a la mañana, otro 30% salen a la tarde, y el restante 40% salen a la noche. Los pasajeros suelen estar muy frustrados ya que un 25% de los viajes salen tarde. De estos viajes demorados, el 40% corresponden a la mañana, un 50% suceden a la tarde, y el 10% restante ocurre a la noche1.\nLucio y Franco son dos amigos del pueblo, y se volvieron a sus casas en colectivos diferentes.\n\nLucio se fue en uno de los colectivos de la mañana. ¿Cuál es la probabilidad que su viaje esté demorado?\nEl colectivo de Franco no está demorado. ¿Cuál es la probabilidad de que esté viajando en uno de los colectivos de la mañana? \n\n\n\n\n\n\nFoto de Markus Winkler en Unsplash\n\n\n\n\nBebé panda\nSupongamos que hay dos especies de osos panda. Ambas especies son igual de frecuentes y viven en la misma región. Es más, lucen de la misma forma y comen la misma comida. Aún no existe una prueba genética que pueda diferenciarlos. Lo único que los diferencia es la cantidad de crías que suelen tener. Las madres de la especie A dan luz a mellizos el 10% del tiempo. Y las madres de la especie B dan a luz mellizos el 20% del tiempo. En todos los otros casos, estas madres dan a luz un solo bebé panda.\nUsando un poco la imaginación, supongamos que somos la persona encargada de un programa de reproducción de pandas. Tenemos una panda femenina que acaba de dar a luz a un par de mellizos, pero no sabemos a que especie pertenece.\n\n¿Cuál es la probabilidad que la mamá panda sea de la especie A?\n¿Cuál es la probabilidad que vuelva a tener mellizos en la próxima parición?\nUn tiempo después sos encontramos con que en la segunda parición da a luz a un único bebé panda. ¿Cuál es la probabilidad de que este panda sea de la especie A? \n\n\n\n\n\n\nFoto de Stone Wang en Unsplash\n\n\n\n\nParaguas\nEstás a punto de subir a un avión rumbo a Mendoza. Querés saber si tenés que llevar un paraguas o no. Llamás a tres amigos que viven en Mendoza y les preguntás si está lloviendo. Cada uno de ellos tiene una probabilidad de 2/3 de decirte la verdad y 1/3 de mentirte para hacerte una broma. Los tres responden que sí está lloviendo. ¿Cuál es la probabilidad de que realmente esté lloviendo en las Mendoza? Se puede asumir que en Mendoza llueve en 1 de cada 10 días. \nSherlock\nDos personas dejaron rastros de sangre en la escena del crimen. La sangre de Guido, un sospechoso, es analizada y resulta ser de tipo ‘0’. Los rastros de sangre de la escena son de tipo ‘0’ (un tipo común en la población, presente en el 60% de las personas) y de tipo ‘AB’ (un tipo raro, con una frecuencia del 1% en la población). ¿Estos datos representan evidencia de que Guido estaba presente en la escena del crimen? \nHijxs de la probabilidad\nNos encontramos con alguien en la calle y nos dice que tiene dos hijxs. Le preguntamos si algunx de ellxs es mujer y nos responde que sí. ¿Cuál es la probabilidad de que ambxs sean niñas? \nLos Reyes del Rock\nElvis Presley tenía un hermano varón que nació en el mismo parto pero que murió al poco tiempo. ¿Cuál es la probabilidad de que Elvis tuviera un gemelo? Alguna información adicional: en 1935, cuando Elvis nació, 1/3 de los hermanxs del mismo parto eran gemelxs y 2/3 mellizxs; además, la probabilidad de que dos mellizxs sean del mismo sexo biológico puede estimarse en 50%, mientras que dos gemelxs son siempre del mismo sexo biológico. \n¿Alguien ordena las medias?\nDos cajones contienen medias. Uno de ellos tiene igual cantidad de medias blancas y negras. El otro contiene un número igual de medias rojas, verdes y azules. Se elige un cajón al azar, se sacan dos medias sin mirar y resultan ser las dos iguales. ¿Cuál es la probabilidad de que las medias sean blancas? Supóngase que sacar la primera media no altera las proporciones. \nLa Falacia del Fiscal\nSally Clark era una abogada británica que fue erróneamente sentenciada a prisión perpetua en 1999 por la muerte de sus dos hijos bebés. Su hijo mayor, Christopher, murió con 11 semanas en diciembre de 1996 y su hijo más joven, Harry, con 8 semanas en enero de 1998. Durante el juicio, la defensa argumentó que las muertes se debieron al síndrome de muerte súbita del lactante (SIDS). Clark fue condenada a partir del testimonio del pediatra Sir Roy Meadow, quien argumentó en la corte lo siguiente:\n\nEn familias sanas, la chance de muerte por SIDS es de \\(\\frac{1}{8500}\\)\nLa probabilidad de dos muertes por SIDS en la misma familia es aproximadamente \\(\\frac{1}{8500^2} \\approx \\frac{1}{73000000}\\)\nEs, por ende, muy poco probable que Clark sea inocente\n\nLuego de pasar 3 años en prisión, Clark fue liberada en 2003 luego de que se determinara que el testimonio experto de Meadows era equivocado. Dos mujeres, a las cuales el testimonio de Meadows había enviado a prisión, también fueron liberadas.\n\nIdentifica una falla en la probabilidad de \\(\\frac{1}{73000000}\\) dada por Meadows\nIncluso aceptando el número anterior como correcto, ¿cuál es el problema de interpretar esa probabilidad como la probabilidad de inocencia de Clark?"
  },
  {
    "objectID": "practica/practica_01.html#inferencia-bayesiana",
    "href": "practica/practica_01.html#inferencia-bayesiana",
    "title": "Práctica - Unidad 1",
    "section": "Inferencia Bayesiana",
    "text": "Inferencia Bayesiana\nEn esta parte de la práctica, se le otorga un significado a las cantidades que aparecen en la Regla de Bayes modificando conceptualmente el enfoque de las situaciones problemáticas. Ahora los problemas se tratan de realizar inferencias sobre posibles causas de ciertos datos observados. Se incrementa el rigor matemático, aparecen distribuciones de probabilidad y la necesidad de dejar ciertos cálculos en manos de la computadora.\n\nEl lenguaje de las probabilidades\nEscribir la expresión matemática para cada una de las siguientes descripciones verbales:\n\nProbabilidad de un parámetro dados los datos observados\nLa distribución de probabilidad de los parámetros antes de ver los datos\nLa verosimilitud de los datos para un valor dado de los parámetros\nLa probabilidad de una observación nueva luego de observar los datos\nLa probabilidad de una observación antes de ver los datos \n\nQué datazo me tiraste, rey\nLos M&Ms azul fueron introducidos en el año 1995 (antes había dos tipos de marrón)\n\nAntes de 1995, la mezcla de colores en una bolsa de M&Ms era: 30% marron, 20% amarillo, 20% rojo, 10% verde, 10% naranja y 10% marrón bronceado.\nLuego de 1995, la mezcla pasó a ser: 24% azul, 20% verde, 16% naranja, 14% amarillo, 13% rojo y 13% marrón.\n\nUn amigo tiene dos bolsas de M&M y nos dice que una bolsa es de 1994 y la otra es de 1996, pero no nos dice cuál es cuál. Nos da un M&M de cada bolsa: uno es amarillo y el otro es verde (ambos posiblemente estén vencidos). ¿Cuál es la probabilidad de que el amarillo venga de la bolsa de 1994?\nLa Gran Estafa\nHay dos monedas en una caja. Una de ellas es una moneda común y la otra es una moneda que tiene dos caras.\n\nSe elige una moneda al azar, se arroja, y se obtiene cara. ¿Cuál es la probabilidad de que la moneda elegida sea la falsa?\nSe elige una moneda al azar y se arroja al aire tres veces, obteniéndose tres caras. ¿Cuál es la probabilidad de que la moneda elegida sea la falsa?\n\nVocabulario limitado\nSupongamos que existe un idioma con seis palabras:\n\\[\n\\text{\\{perro, parra, farra, carro, corro, tarro\\}}\n\\]\nUn análisis lingüístico exhaustivo de esta lengua ha descubierto que todas las palabras son igualmente probables, excepto por ‘perro’, que es \\(\\alpha\\) veces más probable que las otras.\nAdemás:\n\nCuando se tipean, un caracter se introduce erróneamente con probabilidad \\(\\theta\\)\nTodas las letras tienen la misma probabilidad de producir un error de tipeo\nSi una letra se tipeó mal, la probabilidad de cometer un error en otro caracter no cambia\nLos errores son independientes a lo largo de una palabras.\n\n\n¿Cuál es la probabilidad de escribir correctamente ‘tarro’?\n¿Cuál es la probabilidad de tipear ‘cerro’ o ‘curro’ al querer escribir ‘carro’?\nUtilizando la Regla de Bayes, desarrollar un corrector gramatical para esta lengua. Para las palabras tipeadas ‘farra’, ‘birra’ y ‘locos’, hallar la probabilidad de que cada palabra del diccionario sea la palabra que se había querido escribir. Utilizar las siguientes combinaciones de parámetros:\n\n\\(\\alpha = 2\\) y \\(\\theta = 0.1\\)\n\\(\\alpha = 50\\) y \\(\\theta = 0.1\\)\n\\(\\alpha = 2\\) y \\(\\theta = 0.9\\)\n\n\nBosque\nSea \\(X_1 \\sim \\text{Bernoulli}(\\theta)\\) una variable que indica si una especie de árboles se halla en un determinado bosque y \\(\\theta \\in [0, 1]\\) representa la probabilidad a priori de que la especie se encuentre en el bosque. Una investigadora selecciona una muestra de \\(n\\) árboles del bosque y encuentra que \\(X_2\\) de ellas pertenecen a la especie de interés.\nEl modelo luego es\n\\[\n\\begin{array}{lc}\nX_2|X_1 \\sim \\text{Binomial}(n, \\lambda X_1) & \\text{con} \\ \\lambda \\in [0, 1]\n\\end{array}\n\\]\n\\(\\lambda\\) representa la probabilidad de detectar la especie, dado que la especie se encuentra en el bosque.\nEncuntre expresiones matemáticas en término de \\(n\\), \\(\\theta\\) y \\(\\lambda\\) para las siguientes probabilidades:\n\n\\(P(X_1 = 0, X_2 = 0)\\)\n\\(P(X_1 = 0)\\)\n\\(P(X_2 = 0)\\)\n\\(P(X_1 = 0 | X_2 = 0)\\)\n\\(P(X_2 = 0 | X_1 = 0)\\)\n\\(P(X_1 = 0 | X_2 = 1)\\)\n\\(P(X_2 = 0 | X_1 = 1)\\)\nExplique de manera intuitiva cómo es que las probabilidades calculadas en (iv)-(vii) cambian según \\(n\\), \\(\\theta\\) y \\(\\lambda\\).\nAsuma \\(\\theta=0.5\\), \\(\\lambda=0.1\\) y \\(X_2 = 0\\) ¿Cuán grande debe ser \\(n\\) para que se puede concluir con 95% de confianza que la especie no se encuentra en el bosque? \n\n¡Ostras! ¡Estoy haciendo inferencia bayesiana!\nEn un estudio que utiliza métodos de la Estadística Bayesiana para predecir el número de especies que serán descubiertas en el futuro se reporta que la cantidad de especies marinas bivalvas2 descubiertas cada año entre 2010 y 2015 fue 64, 13, 33, 18, 30 y 20.\nSi se representa con \\(Y_t\\) a la cantidad de especies descubierta en el año \\(t\\), y asumiendo:\n\\[\n\\begin{aligned}\nY_t | \\lambda &\\underset{iid}{\\sim} \\text{Poisson}(\\lambda) \\\\\n\\lambda       &\\sim \\text{Uniforme}(0, 100)\n\\end{aligned}\n\\]\nGraficar la distribución a posteriori de \\(\\lambda\\). \nEs negocio…\nSea \\(n\\) la cantidad desconocida de clientes que visitan una tienda en un dia cualquiera. El número de clientes que realizan una compra es \\(Y\\) y se cumple que\n\\[\nY | n \\sim \\text{Binomial}(n, \\theta)\n\\]\ndonde \\(\\theta\\) es la probabilidad de compra, dado que se produce la visita a la tienda. La distribución a priori de \\(n\\) es \\(n \\sim \\text{Poisson}(5)\\). Bajo el supuesto que \\(\\theta\\) es conocido y que \\(n\\) es desconocido, graficar la distribución a posteriori de \\(n\\) para todas las combinaciones de \\(Y \\in \\{0, 5, 10 \\}\\) y \\(\\theta \\in \\{0.2, 0.5\\}\\). Explique cual es del efecto de cambiar \\(Y\\) y \\(\\theta\\) sobre la distribución a posteriori.  \nCon amigos así, quién necesita enemigos\nUn amigo arroja un dado y anota en secreto el número que sale (llamémoslo \\(T\\)). A continuación, nosotros, con los ojos vendados, arrojamos el dado varias veces. No podemos ver el número que sale pero nuestro amigo nos dice si el número que sacamos es mayor, menor o igual a \\(T\\).\nSupongamos que nos da la secuencia: \\(G,\\ G,\\ C,\\ I,\\ C,\\ C,\\ C, I,\\ G,\\ C\\) (siendo \\(G\\) más grande, \\(C\\) más chico e \\(I\\) igual). ¿Cuál es la distribución a posteriori de los valores de \\(T\\)? \nOrden en la sala\nEn las Jornadas Rosarinas de Ciencia de Datos, una expositora está dando una charla en un salón cuando el personal de seguridad la interrumpe porque cree que puede haber más de 1000 personas en la sala, superando el máximo permitido.\nLa expositora piensa que hay menos de 1000 personas y se ofrece a demostrarlo, aunque piensa que contarlas podría llevar mucho tiempo. Decide hacer un experimento:\n\nPregunta cuántas personas nacieron el 11 de mayo. Dos personas levantan la mano.\nPregunta cuántas personas nacieron el 23 de mayo. Una persona levanta la mano.\nPregunta cuántas personas nacieron el 1 de agosto. Nadie levanta la mano.\n\n¿Cuántas personas hay en la sala? O, mejor dicho, ¿cuál es la probabilidad de que haya más de 1000 personas en la sala? \nHouse of Cards\nHay 538 miembros en el Congreso de Estados Unidos. Supongamos que se auditan sus inversiones y se encuentra que 312 de ellos obtuvieron rendimientos por encima del mercado. Asumamos que un miembro honesto del Congreso tiene solo una probabilidad del 50% de tener rendimientos por encima del mercado, pero uno deshonesto que opera con información confidencial tiene una chance del 90% de hacerlo. ¿Cuántos miembros del Congreso son honestos? \nPuede fallar…\nCansada de los experimentos de arrojar una moneda cientos de veces al aire, una estudiante diseña un sistema de reconocimiento de imágenes que determina si salió cara o ceca y registra el resultado.\nLógicamente, el sistema diseñado no es perfecto sino que presenta una tasa de error. En particular, la probabilidad de que clasificar mal es de 0.2 (20% de las veces que sale cara, el sistema dice ceca, y viceversa).\nSe arroja la moneda 250 veces y el sistema detecta 140 caras,\n\n¿Cuál es la distribución a posteriori de \\(\\theta\\), la probabilidad de obtener cara?\n¿Qué ocurre a medida que la probabilidad de clasificar mal varía? \n\n¡Saludos a los cubos con puntos! (…) Serán dados\nDos dados de seis caras son arrojados. Se sabe que la suma de los dos puntajes obtenidos es 9. ¿Cuál es la distribución a posteriori de los puntajes de los dados?"
  },
  {
    "objectID": "practica/practica_01.html#conceptuales",
    "href": "practica/practica_01.html#conceptuales",
    "title": "Práctica - Unidad 1",
    "section": "Conceptuales",
    "text": "Conceptuales\nEn esta sección, se nos invita a pensar sobre las características de la Estadística Bayesiana. En lugar de encontrar una respuesta única mediante cálculos matemáticos, se necesita comprender en profundidad tanto el enfoque frecuentista como el bayesiano para interpretar estas visiones en diferentes escenarios.\n\nVoy a conseguir esa pasantía\nLa empresa de tecnología en la que todo el mundo quiere trabajar tiene varias vacantes para pasantes en ciencia de datos. Luego de leer la descripción de la búsqueda, te das cuenta que sos una persona calificada para el puesto: estos son tus datos. Tu objetivo es averiguar si te van a ofrecer el puesto: esta es tu hipótesis.\n\nDesde la perspectiva de una persona con un razonamiento frecuentista, ¿Qué es lo que se responde al evaluar la hipótesis de que te ofrecen el puesto?\nRepita el punto anterior considerando la perspectiva de una persona con un razonamiento Bayesiano.\n¿Qué pregunta tiene más sentido responder: la frecuentista o la Bayesiana? Justifica tu respuesta. \n\nBeneficios de la Estadística Bayesiana\nUna amiga te cuenta que está interesada en aprender más sobre Estadística Bayesiana. Explícale lo siguiente:\n\n¿Por qué es útil el enfoque Bayesiano?\n¿Cuáles son las similitudes entre el enfoque frecuentista y el Bayesiano?"
  },
  {
    "objectID": "practica/practica_02.html",
    "href": "practica/practica_02.html",
    "title": "Práctica - Unidad 2",
    "section": "",
    "text": "Descargar PDF"
  },
  {
    "objectID": "practica/practica_02.html#modelos-de-distribuciones-conjugadas",
    "href": "practica/practica_02.html#modelos-de-distribuciones-conjugadas",
    "title": "Práctica - Unidad 2",
    "section": "Modelos de Distribuciones Conjugadas",
    "text": "Modelos de Distribuciones Conjugadas\nEsta sección contiene ejercicios para trabajar con modelos basados en distribuciones conjugadas. En general, los ejercicios requieren cálculos o derivaciones que se pueden realizar a mano. Sin embargo, se promueve fuertemente el uso de la computadora y el lenguaje R para verificar los resultados, mostrar soluciones alternativas y ejercitar el uso de una herramienta que será de suma utilidad a lo largo de todo el curso y de la vida profesional.\n\n¿Quién domina el posterior?\nPara cada una de las situaciones siguientes, se da una distribución a priori Beta para el parámetro \\(\\pi\\) de un ensayo binomial. Para cada escenario, identificar cuál de estos se cumple: el prior tiene mayor influencia en el posterior, los datos tienen más influencia en el posteriori, o la creencia a priori y los datos influyen de manera similar en la creencia a posteriori\n\nPrior: \\(\\pi \\sim \\text{Beta}(1,4)\\), observaciones: \\(y=8\\) éxitos en \\(n=10\\) ensayos\nPrior: \\(\\pi \\sim \\text{Beta}(20,3)\\), observaciones: \\(y=0\\) éxitos en \\(n=1\\) ensayos\nPrior: \\(\\pi \\sim \\text{Beta}(4,2)\\), observaciones: \\(y=1\\) éxitos en \\(n=3\\) ensayos\nPrior: \\(\\pi \\sim \\text{Beta}(3,10)\\), observaciones: \\(y=10\\) éxitos en \\(n=13\\) ensayos\nPrior: \\(\\pi \\sim \\text{Beta}(20,2)\\), observaciones: \\(y=10\\) éxitos en \\(n=200\\) ensayos\n\nMás o menos certeza\nSea \\(\\theta\\) la proporción de personas que prefieren los perros a los gatos. Suponga que se elige una distribución \\(\\text{Beta}(7,2)\\) para representar la creencia a priori\n\nDe acuerdo al prior ¿cuáles son valores razonables para \\(\\theta\\)?\nSe observa en una encuesta que \\(y=19\\) de \\(n=20\\) personas prefieren perros, ¿cómo cambia eso el conocimiento acerca de \\(\\theta\\)? Comenta en términos de la evolución de la credibilidad media y del grado de certidumbre acerca de \\(\\theta\\).\nSi, en lugar de eso, se determina que \\(y=1\\) de \\(n=20\\) personas prefieren perros, ¿cómo cambia ahora el grado de credibilidad de los diferentes valores de \\(\\theta\\)?\nSi, en lugar de eso, se determina que \\(y=10\\) de \\(n=20\\) personas prefieren perros, ¿cómo cambia ahora el grado de credibilidad de los diferentes valores de \\(\\theta\\)?\n\nPasito a pasito\nSea \\(\\theta\\) la probabilidad de éxito de un evento de interés. Sea \\(\\text{Beta}(2,3)\\) la distribución a priori para \\(\\theta\\). Actualiza la distribución a posteriori para \\(\\theta\\) secuencialmente:\n\nPrimera observación: éxito\nSegunda observación: éxito\nTercera observación: fracaso\nCuarta observación: éxito\n\nPasitos tras pasitos\nSea \\(\\theta\\) la probabilidad de éxito de un evento de interés. Sea \\(\\text{Beta}(2,3)\\) la distribución a priori para \\(\\theta\\). Actualiza la distribución a posteriori para \\(\\theta\\) secuencialmente dados conjuntos de cinco observaciones:\n\nPrimeras observaciones: tres éxitos\nSegundas observaciones: un éxito\nTerceras observaciones: un éxito\nCuartas observaciónes: dos éxitos\n\nDiferentes observaciones, diferentes posteriors\nUna empresa que fabrica zapatillas está diseñando una publicidad para Instagram. Tres empleados comparten que la creencia a priori para \\(\\pi\\), la probabilidad de que un cliente haga clic en el anuncio cuando lo ve, puede expresarse con una distribución \\(\\text{Beta}(4, 3)\\). No obstante, los tres empleados realizan tres experimentos distintos y por ende tienen acceso a datos diferentes. El primer empleado prueba el anuncio en una persona, que no cliquea el anuncio. El segundo lo prueba en 10 personas, de las cuales 3 cliquean el anuncio. El último lo prueba en 100 personas, 20 de las cuales cliquean el anuncio.\n\nDescriba el entendimiento a priori que los empleados tienen sobre \\(\\pi\\)\nEspecifique la distribución a posteriori de cada uno de los empleados\nCompare las distribuciones a posteriori de cada empleado\n\n¿Galletitas o masitas?\nLa UNR reúne cada año a estudiantes provenientes de diferentes localidades. Cuántas cuadras constituyen una distancia “caminable” suele ser motivo de discusión, entre otros. Pero la verdadera grieta está entre la denominación galletitas versus masitas. Un rosarino pone un prior \\(\\text{Beta}(20,2)\\) a la proporción de personas que dicen galletitas, mientras que un oriundo de una localidad del interior dirá que la credibilidad a priori es \\(\\text{Beta}(2,8)\\).\n\nResuma ambas distribuciones a priori y explique con sus palabras lo que implican\nCon la información de sus compañerxs de curso, actualice ambas distribuciones a priori. ¿Es suficiente esa información para acercar ambas posturas?\n\nMi primera huerta\nEn un campamento de verano para infantes se realizaron actividades que promueven el contacto con la naturaleza. Una de las tareas consistió en germinar semillas de tomate. Josefina plantó 18 semillas en su almaciguera. Al cabo de 5 días, 8 de ellas germinaron. Sea \\(\\theta\\) la probabilidad de que una semilla de tomate germine y sea \\(\\text{Beta}(1, 1)\\) su distribución a priori.\n\n¿Qué información implica el prior sobre la probabilidad de germinación?\nCalcule la media y el desvío estándar a posteriori de \\(\\theta\\) a mano.\nVerifique el cálculo utilizando R.\nObtenga un intervalo de credibilidad del 95% para \\(\\theta\\).\n\nA mano\nUsando R\n\n\n\n\n\n\n\nFoto de Markus Spiske en Unsplash\n\n\n\n\n¿Quién dijo que el fútbol siempre da revancha?\nEn la final del 2018 de la Copa del Mundo de la FIFA, Francia le ganó a Croacia por 4 a 2. En función de este resultado,\n\n¿Qué probabilidad hay de que Francia fuera un mejor equipo que Croacia?\nSi el mismo partido se jugara de nuevo (cosa que los franceses en aquella oportunidad no pidieron), ¿cuál es la probabilidad de que Francia ganara de nuevo? \n\nMirá si me va a pasar a mi…\nDurante el desarrollo de las vacunas contra el COVID-19, un medio anunció para una determinada vacuna una eficacia del 100%.\n\nEn la fase 3 de un ensayo en adolescentes de entre 12 y 15 años, la vacuna BNT162b2 de Pfizer-BioNTech para el COVID-19 demostró una eficacia del 100% y una respuesta robusta de anticuerpos. El ensayo clínico involucró 2260 jóvenes estadounidenses. En el ensayo, 18 casos de COVID-19 fueron observados en el grupo placebo (\\(n=1129\\)) y ninguno en el grupo vacunado (\\(n=1131\\))\n\nEs de esperar que, en un ensayo más grande, aparezca algún caso de COVID-19 en el grupo que recibió el tratamiento. ¿Cómo se estima la probabilidad de algo que aún no ocurrió? \nLa regla del tres\nUna estudiante de Licenciatura en Estadística está releyendo su tesina antes de entregarla. Si en 20 páginas encontrara 5 typos, sería razonable estimar \\(\\frac{5}{20} = \\frac{1}{4}\\) typos por página. ¿Pero qué ocurre si en 20 páginas no encuentra ningún error?\nVerifcar que, partiendo de un prior uniforme, \\(\\frac{3}{N}\\) es una estimación razonable para \\(\\tau\\) (la tasa de typos por página), siendo \\(N\\) el número de páginas. Para ello, hallar la probabilidad de que \\(\\tau > \\frac{3}{N}\\) para diferentes valores de \\(N\\). \n¿Tenés alguien para recomendar?\nUna colega quiere comprar un producto por Internet. Tres vendedores ofrecen el mismo producto al mismo precio. Un vendedor tiene 100% de evaluaciones positivas, con 10 reviews. Otro tiene 96% de evaluaciones positivas, con 50 reviews. El último tiene 90% de comentarios positivos, con 200 evaluaciones. ¿Cuál de los tres vendedores le recomendarías? \nBichos\nUn biólogo quiere determinar la densidad de un insecto en su región. Su conocimiento a priori del número promedio de insectos por unidad de área (\\(\\text{m}^2\\)) se puede representar con una distribución Gamma de media 0.50 y desvío estándar 0.25. En una investigación en 20 \\(\\text{m}^2\\) de área, se hallan 3, 2, 5, 1 y 2 insectos en los primeros 5 \\(\\text{m}^2\\) y ninguno en la fracción de tierra restante.\n\nHalle la distribución a posteriori del número medio de insectos por unidad de área\nHalle la distribución predictiva a posteriori del número de insectos que se espera encontrar en una exploración de un área de 10 \\(\\text{m}^2\\)\n\nAlter-ego\nEl profesor Caprista y el profesor Evangetto están dando sus primeros cursos de Estadística Bayesiana. Sus colegas les dijeron que el puntaje promedio en un examen final, \\(\\mu\\), varía normalmente año a año con media 8 y desvío estándar 0.4. Y además, que los puntajes individuales de lxs estudiantes \\(Y\\) varían normalmente alrededor de \\(\\mu\\) con una desviación estándar de 0.4\n\n¿Cuál es la probabilidad a priori de que un estudiante se saque más de 9 en un examen final?\nEl profesor Caprista toma el examen final y observa que sus 20 estudiantes obtuvieron una nota media de 8.6. Halle la distribución a posteriori de \\(\\mu\\).\nEl profesor Evangetto toma el examen final y observa que sus 20 estudiantes obtuvieron una nota media de 8.2. Halle la distribución a posteriori de \\(\\mu\\).\nCombine las notas de ambos exámenes para obtener la distribución a posteriori de \\(\\mu\\)\n¿Cuál es la probabilidad a posteriori de que un estudiante se saque más de 9 en un examen final?\n\nInferencia sobre una distribución de Poisson\nLa distribución de masa de probabilidad Poisson se define como\n\\[\n\\begin{array}{lcr}\n\\displaystyle p(x | \\lambda) = \\frac{e^{-\\lambda}\\lambda^x}{x!} &\n\\text{con} &\nx \\in \\{0, 1, 2, \\cdots \\}\n\\end{array}\n\\]\ndonde \\(\\lambda > 0\\) es la cantidad promedio de veces que ocurre el evento de interés en un periodo o espacio determinado.\n\nDerive el estimador de máxima verosimilitud del parámetro \\(\\lambda\\).\nDerive el posterior \\(p(\\lambda|D)\\) suponiendo que el prior sobre \\(\\lambda\\) es \\(p(\\lambda) = \\text{Gamma}(\\lambda | a, b) \\propto \\lambda^{\\alpha-1}e^{-\\lambda b}\\).\nAyuda: El posterior también es una distribución Gamma.\n¿A qué valor tiende la media a posteriori cuando \\(a \\to 0\\) y \\(b \\to 0\\)?\nRecuerde que la media de una distribución \\(\\text{Gamma}(a, b)\\) es \\(a/b\\). \n\nEl modelo Gamma-Poisson\nSea \\(\\lambda\\) la tasa de mensajes de WhatsApp que una persona recibe en una hora. Suponga inicialmente que se cree que la tasa de mensajes por hora tiene media 5 con desvío estándar de 0.25 mensajes.\n\nElija una distribución Gamma que represente adecuadamente lo que se cree acerca de \\(\\lambda\\)\n¿Cuál es la probabilidad a priori de que la tasa de mensajes sea mayor a 10?\n¿Cuántos mensajes se espera que reciba una persona en promedio en una hora?\n\nSe sondea a un grupo de seis personas que recibieron 7, 3, 8, 9, 10 y 12 mensajes en la última hora.\n\nGraficar la verosimilitud de \\(\\lambda\\)\nDeterminar la distribución a posteriori de \\(\\lambda\\)\n¿Cuál es la probabilidad a posteriori de que la tasa de mensajes sea mayor a 10?\n¿Cuántos mensajes se espera ahora que reciba una persona en promedio en una hora?\n\nInferencia sobre una distribución Uniforme\nConsidere una distribución uniforme crentrada en \\(0\\) y rango \\(2a\\). La función de densidad de probabilidad es\n\\[\np(x) = \\frac{1}{2a}I(x \\in [-a, a])\n\\]\nSea \\(\\mathbf{X} = (X_1,..., X_n)\\) un vector de \\(n\\) variables aleatorias independientes e idénticamente distribuidas según \\(p(x)\\)\nInferencia máximo-verosímil\n\n¿Cuál es el estimador máximo verosímil de \\(a\\) (llámelo \\(\\hat{a}\\))?\n¿Qué probabilidad le asigna el modelo a una nueva observación \\(x_{n + 1}\\) usando \\(\\hat{a}\\)?\n¿Observa algún problema con el resultado anterior? Si es así, sugiera una alternativa mejor.\n\nInferencia Bayesiana\nEl prior conjugado de la distribución uniforme es la distribución de Pareto.\nSi \\(X \\sim \\text{Pareto}(\\alpha, m)\\), luego\n\\[\nf(x| \\alpha, m) = \\frac{\\alpha m^\\alpha}{x^{\\alpha+1}} \\mathbb{I}(x \\ge m)\n\\]\nSi el prior es una distribución de Pareto, la distribución conjunta de \\(\\theta\\) y \\(\\mathbf{X} = (X_1,..., X_n)\\) es\n\\[\nf(\\theta, \\mathbf{X})\n    = \\frac{\\alpha m^\\alpha}{\\theta^{n + \\alpha + 1}}\n    \\mathbb{I}(\\theta \\ge \\text{max}(\\mathbf{X}))\n\\]\nLlamando \\(M_x = \\text{max}(\\mathbf{X})\\). La evidencia es\n\\[\n\\begin{aligned}\np(\\mathbf{X}) &= \\int_{M_x}^\\infty\n                 \\frac{\\alpha m^\\alpha}{\\theta^{n + \\alpha + 1}}\n                 d\\theta \\\\\n&=  \\begin{cases}\n    \\frac{\\alpha}{(n+\\alpha)m^n} & \\text{Si } M_x \\le m \\\\\n    \\frac{\\alpha m^\\alpha}{(n+\\alpha)m^{n+\\alpha}} & \\text{Si } M_x > m \\\\\n    \\end{cases}\n\\end{aligned}\n\\]\nDerive el posterior y muestre que puede ser expresado como una distribución de Pareto.  \nInferencia sobre una distribución Exponencial\nEl tiempo de vida de una máquina en años \\(X\\) es modelado con una distribución exponencial con parámetro \\(\\theta\\) desconocido. La función de densidad es\n\\[\n\\begin{array}{lcrr}\nf(x | \\theta) = \\theta e^{-\\theta x} & \\text{con} & x \\ge 0, & \\theta \\ge 0\n\\end{array}\n\\]\n\nMuestre que el estimador máximo verosímil (MV) es \\(\\hat{\\theta} = 1/\\bar{x}\\)\n\nSuponga que se observan los siguientes tiempos de vida de tres máquinas independientes \\(x_1 = 5\\), \\(x_2 = 6\\), \\(x_3 = 4\\). ¿Cuál es el valor del estimador MV?\nUna experta del área sugiere que \\(\\theta\\) debe tener una distribución a priori que también sea exponencial. \\[\n\\begin{aligned}\n\\theta &\\sim \\text{Exp}(\\lambda) \\\\\nf(\\theta | \\lambda) &= \\lambda e^{-\\lambda \\theta}\n\\end{aligned}\n\\] Elija un valor para el hiperparámetro \\(\\lambda\\) de la distribución a priori tal que \\(\\mathbb{E}(\\theta) = 1/3\\). Utilice \\(\\hat{\\lambda}\\) para representar al valor.\n¿Cuál es el posterior \\(f(\\theta | \\mathbf{X}, \\hat{\\lambda})\\)?\n¿Es la distribución exponencial conjugada con un likelihood exponencial?\nEncuentre la media del posterior, \\(\\mathbb{E}(\\theta | \\mathbf{X}, \\hat{\\lambda})\\)\nExplique por que difieren el estimador MV de la media a posteriori. ¿Cuál es más razonable en este ejemplo? \n\nOtras distribuciones conjugadas (I)\nConsidere el siguiente modelo:\n\\[\n\\begin{array}{l}\nY\\mid\\theta \\sim \\text{Geom}(\\theta) \\\\\n\\theta \\sim \\text{Beta}(\\alpha,\\beta)\n\\end{array}\n\\] donde la función de densidad de la distribución geométrica es \\(p(y\\mid\\theta) = \\theta(1-\\theta)^{y-1}\\) para \\(y \\in {1,2,\\dots}\\)\n\n¿Qué debería ocurrir con la distribución a posteriori de \\(\\theta\\) para poder afirmar que la distribución geométrica es conjugada de la beta?\nDerive la distribución a posteriori de \\(\\theta\\) y concluya.\n\nOtras distribuciones conjugadas (II)\nConsidere el siguiente modelo:\n\\[\n\\begin{array}{l}\nY\\mid\\theta \\sim \\text{BinomialNeg}(\\theta,m) \\\\\n\\theta \\sim \\text{Beta}(\\alpha,\\beta)\n\\end{array}\n\\]\ndonde la función de densidad de la distribución binomial negativa es\n\\[p(y\\mid \\theta, m) = {y+m-1 \\choose y} \\theta^{m} (1-\\theta)^y\\]\nObtenga la distribución a posteriori de \\(\\theta\\).\nOtras distribuciones conjugadas (III)\nConsidere el siguiente modelo:\n\\[\n\\begin{array}{l}\nY\\mid\\theta \\sim \\text{Exp}(\\theta) = \\text{Gamma}(1,\\theta)\n\\end{array}\n\\]\ndonde la función de densidad exponencial es \\(f(y\\mid\\theta) = \\theta e^{-\\theta y}\\).\nElija una distribución a priori conjugada de la verosimilitud propuesta y obtenga la expresión para la distribución de probabilidad a posteriori"
  },
  {
    "objectID": "practica/practica_02.html#simulaciones",
    "href": "practica/practica_02.html#simulaciones",
    "title": "Práctica - Unidad 2",
    "section": "Simulaciones",
    "text": "Simulaciones\nA diferencia de la sección anterior, que requiere resolver los ejercicios a mano y promueve el uso de la computadora y R de manera complementaria, esta sección contiene ejercicios que deben ser resueltos mediante técnicas de simulación implementadas en R. Es posible que en algunos casos también se pueda obtener una solución analítica. En estos casos, puede resultar de utilidad obtener también una solución a mano para comparar resultados, niveles de dificultad y ver que tan intuitivo resultan ambos enfoques.\n\nEntrada en calor\nPara cada una de las siguientes situaciones, hallar los intervalos centrales de credibilidad\n\nIntervalo del 95% para \\(\\pi\\) siendo \\(\\pi\\mid \\mathbf{y} \\sim \\text{Beta}(4,5)\\)\nIntervalo del 60% para \\(\\pi\\) siendo \\(\\pi\\mid \\mathbf{y} \\sim \\text{Beta}(4,5)\\)\nIntervalo del 89% para \\(\\lambda\\) siendo \\(\\lambda\\mid \\mathbf{y} \\sim \\text{Gamma}(1,8)\\)\nIntervalo del 95% para \\(\\lambda\\) siendo \\(\\lambda\\mid \\mathbf{y} \\sim \\text{Gamma}(2,5)\\)\nIntervalo del 81% para \\(\\mu\\) siendo \\(\\mu\\mid \\mathbf{y} \\sim \\mathcal{N}(10,2^2)\\)\nIntervalo del 99% para \\(\\pi\\) siendo \\(\\mu\\mid \\mathbf{y} \\sim \\mathcal{N}(-3,1^2)\\)\n\nPropiedades frecuentistas de inferencias bayesianas (!!)\nSea una variable \\(Y\\) tal que \\(Y | \\theta \\sim \\text{Binomial}(n, \\theta)\\) y \\(\\theta \\sim \\text{Beta}(1/2, 1/2)\\). Mediante un estudio de simulación calcule la cobertura empírica del intervalo de credibilidad del 95% para \\(n \\in \\{1, 5, 10, 25\\}\\) y \\(\\theta \\in \\{0.05, 0.10, \\dots, 0.50 \\}\\). Describa las propiedades frecuentistas del intervalo de credibilidad bayesiano. \n¿Te preguntaste alguna vez cuál es la distribución de un p-value?\nConsidere un problema conocido. Se desean comparar dos muestras independientes de tamaño 5 utilizando un test t y utilizando el test de Mann-Whitney.\n\nConsidere el caso en que las dos muestras provienen de poblaciones con igual media y desvío estándar (supongamos normal de media nula y varianza unitaria). Si se repitiera muchas veces el proceso de tomar las muestras y realizar los tests, ¿qué distribución tendrán los p-values obtenidos para cada test?\nConsidere ahora el caso en que las dos muestras provienen de poblaciones con diferente media e igual desvío estándar (\\(\\mathcal{N}(0,1)\\) y \\(\\mathcal{N}(1,1)\\)). Si se repitiera muchas veces el proceso de tomar las muestras y realizar los tests, ¿qué distribución tendrán los p-values obtenidos para cada test?"
  },
  {
    "objectID": "practica/practica_02.html#elección-de-distribuciones-a-priori",
    "href": "practica/practica_02.html#elección-de-distribuciones-a-priori",
    "title": "Práctica - Unidad 2",
    "section": "Elección de distribuciones a priori",
    "text": "Elección de distribuciones a priori\nEsta útima sección de la práctica tiene como propósito ejercitar el uso de distribuciones de probabilidad como herramienta para reflejar información de un problema determinado.\n\nEsbozar la distribución de las siguientes variables\n\nEl número de personas que compran café en el bar de la facultad asumiendo distribución de Poisson.\nEl peso de perros adultos en kilogramos asumiendo una distribución Uniforme.\nEl peso de elefantes adultos en kilogramos asumiendo una distribución Normal.\nEl peso de humanos adultos en libras asumiendo una distribución asimétrica hacia la derecha.\n\nVerificar los resultados de manera computacional\nPara cada uno cada uno de los ejemplos del ejercicio anterior, graficar la distribución usando R. Seleccionar los parámetros que creas razonable, tomar una muestra aleatoria de tamaño 1000 y graficar la distribución en base a las muestras. ¿Se refleja tu conocimiento del problema en la distribución graficada? Si no, ajustar los parámetros y repetir el proceso hasta que el resultado tenga concuerde con el conocimiento del problema.\nHay que amigarse con de la distribución Beta\nComparar las siguientes distribuciones a priori.\n\n\\(\\text{Beta}(0.5, 0.5)\\)\n\\(\\text{Beta}(1, 1)\\)\n\\(\\text{Beta}(1, 1)\\)\n\\(\\text{Beta}(1, 4)\\)\n\\(\\text{Beta}(5, 1.5)\\)\n\n\n¿En qué se diferencian?\n¿Cuál de ellas es más informativa?\n¿Cómo lo determinaste?\n\nElicitación de priors\nEn cada una de la situaciones que se describen debajo, ajustar manualmente los parámetros de una distribución \\(\\text{Beta}\\) para que reflejen la información brindada. No siempre existe una única respuesta correcta.\n\nUn amigo se postuló para un empleo en LinkedIn y te dijo: “Diría que tengo una chance del 40% de que me den el trabajo, pero no estoy seguro”. Cuando le preguntamos un poco mas, dijo que estima sus chances entre un 20% y un 60%.\nUn grupo de investigación del CONICET desarrolló una nueva prueba para una enfermedad bastante rara. El grupo espera que esta prueba arroje resultados correctos el 80% de las veces, con una varianza de 0.05.\nEl primo de un amigo es un apasionado de la pesca, lo practica muy seguido, y se dice ser muy bueno. Según comenta tu amigo, en el asado de los Jueves el pescador dijo lo siguiente:\n\n\nSi tengo que hacer un promedio, 9 de cada 10 veces que salgo, vuelvo con algo. Pero últimamente te diría que siempre es 10 de 10. Estoy infalible. La verdad es que soy un crack de la pesca.\n\nAnte el descreimiento de algunos de los comensales supo reconocer que no siempre le fue tan bien:\n\nTuve mis malas rachas, pero nunca menos de 8 pescas de cada 10 salidas.\n\nEfecto de la parametrización\nSea \\(\\theta\\) la probabilidad de éxito en un experimento binomial y sea \\(\\gamma = \\frac{\\theta}{1-\\theta}\\) la chance de éxito. Utilizar simulaciones para explorar los efectos de las siguientes elecciones de distribuciones a priori\n\nSi \\(\\theta \\sim \\text{Uniforme}(0,1)\\), ¿cuál es el prior inducido para \\(\\gamma\\)?\nSi \\(\\theta \\sim \\text{Beta}(0,1)\\), ¿cuál es el prior inducido para \\(\\gamma\\)?\nSi \\(\\gamma \\sim \\text{Uniforme}(0,100)\\), ¿cuál es el prior inducido para \\(\\theta\\)?\nSi \\(\\gamma \\sim \\text{Gamma}(1,1)\\), ¿cuál es el prior inducido para \\(\\theta\\)?"
  },
  {
    "objectID": "practica/practica_02.html#teoría-de-la-decisión",
    "href": "practica/practica_02.html#teoría-de-la-decisión",
    "title": "Práctica - Unidad 2",
    "section": "Teoría de la Decisión",
    "text": "Teoría de la Decisión\n\nDada la distribución a posteriori \\(p(\\theta \\mid y)\\), probar que el estimador de Bayes que minimiza la función de pérdida \\(L_1\\) es la mediana de \\(p(\\theta \\mid y)\\). \nSuponga que la distribución a posteriori de \\(\\pi\\), \\(p(\\pi \\mid y)\\), es \\(\\text{Beta}(12,4)\\). Determine mediante simulación el estimador que minimiza la pérdida de Huber: \\[\n\\mathcal{L}(\\delta,\\pi) =\n\\begin{cases}\n\\frac{1}{2} (\\pi - \\delta)^2 \\text{ si } |\\pi - \\delta| \\leq \\alpha \\\\\n\\alpha \\cdot (|\\pi - \\delta|-\\frac{1}{2}\\alpha) \\text{ en cualquier otro caso}\n\\end{cases}\n\\]\nTo Do Problema de rankear cinco tratamientos. Se tienen los puntajes de diez tratamientos, \\({\\theta_1,\\theta_2,\\dots,\\theta_10}\\). Se dan muestras de las distribuciones a posteriori, \\(p(\\theta_i\\mid y)\\). ¿Cuál de los tratamientos es mejor?"
  },
  {
    "objectID": "practica/practica_05.html",
    "href": "practica/practica_05.html",
    "title": "Práctica - Unidad 5",
    "section": "",
    "text": "Descargar PDF\n\n\nConsidere un modelo para datos de conteo con un predictor \\(X\\) que toma valores entre -3 y 50\n\\[\n\\begin{aligned}\nY_i   &\\sim \\mathrm{Poisson}(\\lambda_i) \\\\\n\\log(\\lambda_i) &= \\beta X \\\\\n\\end{aligned}\n\\]\n\nGenere 1000 valores de \\(X\\), asuma un valor conocido (y fijo) para \\(\\beta\\), simule los correspondientes valores de \\(\\lambda_i\\) y los de \\(Y_i\\). ¿Cómo es \\(\\lambda\\) en función de \\(X\\)? ¿Es lineal la relación entre \\(X\\) e \\(Y\\)? ¿Qué ocurre con la varianza de \\(Y\\) en función de \\(X\\)? ¿Cómo es la distribución marginal de \\(Y\\)?\nAhora añada incertidumbre al valor de \\(\\beta\\) (¿cómo se hace esto?) y simule nuevamente valores para \\(\\lambda_i\\) y \\(Y_i\\). Compare los resultados.\n\nConsidere un modelo de clasificación con un predictor \\(X\\) que toma valores entre -30 y 10\n\\[\n\\begin{aligned}\nY_i   &\\sim \\mathrm{Bernoulli}(\\theta_i) \\\\\n\\log\\left(\\frac{\\theta_i}{1 - \\theta_i}\\right) &= \\beta X \\\\\n\\end{aligned}\n\\]\n\nGenere 1000 valores de \\(X\\), asuma un valor conocido (y fijo) para \\(\\beta\\), simule los correspondientes valores de \\(\\theta_i\\) y los de \\(Y_i\\). ¿Cómo es \\(\\theta\\) en función de \\(X\\)? ¿Es lineal la relación entre \\(X\\) e \\(Y\\)?\nAhora añada incertidumbre al valor de \\(\\beta\\) (¿cómo se hace esto?) y simule nuevamente valores para \\(\\theta_i\\) y \\(Y_i\\). Compare los resultados.\n\nUtilice el conjunto de datos de las elecciones presidenciales de Estados Unidos del año 2016 que se provee en Reich y Ghosh (2019) (rep_2012_2016). Elabore un modelo de regresión lineal bayesiano donde la variable respuesta es la diferencia porcentual entre el porcentaje de votos que obtuvo el candidato Republicano en el 2016 versus los que tuvo en el 2012 en cada condado y utilice todas las demás variables como predictoras.\n\nUtilice distribuciones a priori normales no informativas. Interprete las distribuciones a posteriori marginales de los coeficientes de regresión.\nCalcule los residuos \\(\\mathbf{r} = \\mathbf{y} - \\mathbf{X}\\hat{\\boldsymbol{\\beta}}\\) donde \\(\\hat{\\boldsymbol{\\beta}}\\) es la media a posteriori del vector de coeficientes de regresión ¿Puede concluir que los residuos siguen una distribución normal? ¿Qué condados presentan los residuos más grandes y más pequeños? ¿Qué puede indicar sobre estos condados?\nTo Do: Compartir datos de forma accesible \n\nUtilice el conjunto de datos sobre el control de armas en Estados Unidos. Estos datos provienen de un estudio transversal. Para el estado \\(i\\), sea \\(Y_i\\) el numero de homicios y \\(N_i\\) el tamaño de la población.\n\nAjuste el modelo \\(Y_i | \\boldsymbol{\\beta} \\sim \\text{Poisson}(N_i\\lambda_i)\\) donde \\(\\text{log}(\\lambda_i) = \\mathbf{X}_i\\boldsymbol{\\beta}\\). Use distribuciones a priori no informativas y \\(p = 7\\) de las covariables en \\(\\mathbf{X}_i\\): el intercepto, los cinco confounders \\(\\mathbf{Z}_i\\), y el número de leyes relacionadas a armas. Justifique que el sampler ha convergido y explorado suficientemente la distribución a posteriori y resuma la distribución a posteriori de \\(\\boldsymbol{\\beta}\\).\nTo Do: No puse los puntos (b) y (c) porque no se si estan dentro del plan\nTo Do: Ver como presentamos el tema de las variables a incorporar en el modelo\n\nDescargue el conjunto de datos babynames en R y calcule el log-odds de un bebé llamado “Sophia” en cada año luego de 1950.\nlibrary(babynames)\ndat <- babynames\ndat <- dat[dat$name == \"Sophia\" & dat$sex == \"F\" & dat$year > 1950, ]\nyr <- dat$year\np <- dat$prop\nt <- dat$year - 1950\nY <- log(p / (1 - p))\nSea \\(Y_t\\) el log-odds muestral en el año \\(t + 1950\\). Ajuste el siguiente modelo auto-regresivo de orden 1:\n\\[\n\\begin{aligned}\nY_t   &= \\mu_t + \\rho(Y_{t - 1} + \\mu_{t - 1}) + \\varepsilon_t \\\\\n\\mu_t &= \\alpha + \\beta t \\\\\n\\varepsilon &\\underset{iid}{\\sim} \\text{Normal}(0, \\sigma^2) \\\\\n\\alpha, \\beta &\\sim \\text{Normal}(0, 100^2) \\\\\n\\rho &\\sim \\text{Uniforme}(-1, 1) \\\\\n\\sigma^2 &\\sim \\text{InvGamma}(0.1, 0.1)\n\\end{aligned}\n\\]\n\nInterprete los parámetros del modelo (\\(\\alpha\\), \\(\\beta\\), \\(\\rho\\) y \\(\\sigma^2\\))\nAjuste el modelo utilizando RStan para \\(t > 1\\). Verifique la convergencia y reporte la media a posteriori e intervalos del 95% para los parámetros.\nGrafique la distribución predictiva a posteriori para \\(Y_t\\) en el año 2020. \n\nEn este ejercicio se llevará a cabo un meta-análisis, es decir, un análisis que combina el resultado de varios estudios. Los datos provienen del paquete rmeta en R.\nlibrary(rmeta)\ndata(cochrane)\ncochrane\n          name ev.trt n.trt ev.ctrl n.ctrl\n1     Auckland     36   532      60    538\n2        Block      1    69       5     61\n3        Doran      4    81      11     63\n4        Gamsu     14   131      20    137\n5     Morrison      3    67       7     59\n6 Papageorgiou      1    71       7     75\n7      Tauesch      8    56      10     71\nLos datos provienen de siete ensayos aleatorizados que evalúan el efecto de la terapia con corticosteroides en la muerte neonatal. Para el ensayo \\(i \\in \\{1, \\dots, 7 \\}\\) \\(Y_{i0}\\) representa el número de eventos que ocurren en el grupo de control de tamaño \\(N_{i0}\\) y \\(Y_{i1}\\) representa el número de eventos que ocurren en el grupo tratado de tamaño \\(N_{i1}\\).\n\nAjuste el modelo \\(Y_{ij} | \\theta_j \\underset{indep}{\\sim} \\text{Binomial}(N_{ij}, \\theta_j)\\) con \\(\\theta_0, \\theta_1 \\sim \\text{Uniforme}(0, 1)\\). ¿Se puede concluir que el tratamiento está asociado a una reducción de la tasa de muerte?\nAjuste el modelo \\(Y_{ij} | \\theta_j \\underset{indep}{\\sim} \\text{Binomial}(N_{ij}, \\theta_j)\\) con\n\n\\(\\text{logit}(\\theta_{ij}) = \\alpha_{ij}\\)\n\\(\\boldsymbol{\\alpha}_i = (\\alpha_{i0}, \\alpha_{i1})^T \\underset{iid}{\\sim} \\text{Normal}(\\boldsymbol{\\mu}, \\boldsymbol{\\Sigma})\\)\n\\(\\boldsymbol{\\mu} \\sim \\text{Normal}(0, 10^2I_2)\\)\n\\(\\boldsymbol{\\Sigma} \\sim \\text{InvWishart}(3, I_2)\\)\n\nInterprete los resultados indicando si estos sugieren que el tratamiento está asociado a una reducción en la tasa de muerte.\nDibuje un DAG para ambos modelos.\nDiscuta las ventajas y desventajas de ambos modelos.\n¿Cuál modelo es el preferido para estos datos? \n\nUtilice el conjuto de datos airquality que viene con el paquete datasets que se carga automáticamente al crear una sesión de R.\nhead(airquality)\n  Ozone Solar.R Wind Temp Month Day\n1    41     190  7.4   67     5   1\n2    36     118  8.0   72     5   2\n3    12     149 12.6   74     5   3\n4    18     313 11.5   62     5   4\n5    NA      NA 14.3   56     5   5\n6    28      NA 14.9   66     5   6\nCompare los siguientes modelos utilizando 5-fold cross-validation:\n\\[\n\\begin{array}{l}\n\\mathcal{M}_1: \\text{Ozone}_i \\sim \\text{Normal}(\\beta_1 + \\beta_2 \\text{Solar.R}_i, \\sigma^2) \\\\\n\\mathcal{M}_2: \\text{Ozone}_i \\sim \\text{Normal}(\\beta_1 + \\beta_2 \\text{Solar.R}_i + \\beta_3 \\text{Temp}_i + \\beta_4 \\text{Wind}_i, \\sigma^2)\n\\end{array}\n\\]\nElija priors para ambos modelos explicando su elección. \nAccidente del Challenger\nEl 28 de enero de 1986, el vuelo número veinticinco del programa estadounidense de trasbordadores espaciales acabó en un desastre cuando uno de los propulsores del Challenger explotó poco después del despegue. En el accidente murieron los siete tripulantes. La comisión que investigó el accidente concluyó que el accidente fue causado por una falla en un o-ring en una juntura de uno de los propulsores. Esta falla se debió a un diseño defectuoso que volvió al o-ring excesivamente sensible a factores externos, entre ellos la temperatura. De los veinticuatro vuelos previos, existía información de fallas de o-rings para veintitrés de ellos (el otro se perdió en el océano). Estos datos fueron discutidos la noche previa al incidente. No obstante, los datos de los siete vuelos en los que hubo fallas llevaron a la conclusión de que no había una evidencia clara.\n\n\n\n\n\n\n \n  \n    T (°F) \n    Falla \n  \n \n\n  \n    66 \n    0 \n  \n  \n    70 \n    1 \n  \n  \n    69 \n    0 \n  \n  \n    68 \n    0 \n  \n  \n    67 \n    0 \n  \n  \n    72 \n    0 \n  \n  \n    73 \n    0 \n  \n  \n    70 \n    0 \n  \n  \n    57 \n    1 \n  \n  \n    63 \n    1 \n  \n  \n    70 \n    1 \n  \n  \n    78 \n    0 \n  \n  \n    67 \n    0 \n  \n  \n    53 \n    1 \n  \n  \n    67 \n    0 \n  \n  \n    75 \n    0 \n  \n  \n    70 \n    0 \n  \n  \n    81 \n    0 \n  \n  \n    76 \n    0 \n  \n  \n    79 \n    0 \n  \n  \n    75 \n    1 \n  \n  \n    76 \n    0 \n  \n  \n    58 \n    1 \n  \n\n\n\n\n\n\nCurvas de crecimiento de tiranosáuridos\nSe analizan datos de 20 fósiles de tiranosáuridos para estimar las curvas de crecimiento de cuatro especies: Albertosaurio, Daspletosaurio, Gorgosaurio y Tiranosaurio. Los datos se toman de la Tabla 1 de Erickson et al. (2004) y se muestran en la Figura 1. El objetivo es determinar la curva de crecimiento, esto es, determinar el peso esperado por edad para todas las especies.\nEn el panel izquierdo de la Figura 1 se puede observar que hay una relación no lineal entre la edad y el peso. También se observan ciertos patrones comunes a las especies. Por ejemplo, la relación positiva entre las variables o el decrecimiento en la tasa de cambio conforme la edad es mayor.\n\n\n\n\n\nFigura 1: (Izquierda) Edad (años) vs Peso (kilogramos). (Derecha) Los mismos datos luego de aplicar la transformación logarítmica a ambas variables.\n\n\n\n\nSea \\(Y_{ij}\\) el peso y \\(X_{ij}\\) y la edad de la muestra \\(i\\) de la especie \\(j\\), con \\(j = 1, 2, 3, 4\\). Se propone el siguiente modelo:\n\\[\nY_{ij} = f_j(X_{ij}) \\epsilon_{ij}\n\\]\ndonde \\(f_j\\) es la verdadera curva de crecimiento para la especie \\(j\\) y \\(\\epsilon_{ij} > 0\\) es un error multiplicativo.\n\n¿Por qué tiene sentido proponer un error multiplicativo?\n¿Cuál es un valor sensato para la media de la distribución del error?\nUtilice una distribución log-normal para el error, \\(\\log (\\epsilon_{ij}) \\sim \\text{Normal}\\). Proponga valores para la media y la varianza de forma tal que satisfagan la condición del punto anterior.\n\nEsto da lugar un al siguiente modelo log-normal para \\(Y_{ij}\\):\n\\[\n\\log (Y_{ij}) \\sim \\text{Normal}\n(\\log [f_j(X_{ij})] + \\mu_{\\log \\epsilon}, \\sigma^2_{\\log \\epsilon})\n\\]\ncon \\(\\mathbb{E}(Y_{ij}) = f_j(X_{ij})\\).\nA continuación se proponen cuatro modelos que varían según la relación funcional que se propone para \\(f_j\\) y la naturaleza de las distribuciones a priori que se utilizan.\nModelo 1\nObservando el panel derecho de la Figura 1 se puede concluir que luego de transformar ambas variables con la función logaritmo la relación se ve aproximadamente lineal. Por lo tanto, se propone el siguiente modelo log-lineal:\n\\[\n\\log [f_j(X)] = a_j + b_j \\log(X)\n\\]\ndonde \\(a_j\\) y \\(b_j\\) representan al intercepto y pendiente de la especie \\(j\\). La curva de crecimiento en la escala original resulta \\(f_j(X) = \\exp (a_j)X^{b_j}\\). Considere los siguientes priors:\n\\[\n\\begin{aligned}\na_j &\\sim \\text{Normal}(0, 10) \\\\\nb_j &\\sim \\text{Normal}(0, 10) \\\\\n\\sigma^2_j &\\sim \\text{InvGamma}(0.1, 0.1)\n\\end{aligned}\n\\]\n\nEscriba un programa en Stan que implemente el modelo y obtenga el posterior con RStan.\nAnalice los coeficientes del modelo y las curvas de crecimiento. Realice gráficos que permitan observar la curva ajustada y su incertidumbre para cada especie.\n\nModelo 2\nEste modelo es el mismo que el Modelo 1, excepto que las especies tienen la misma varianza, \\(\\sigma^2_j = \\sigma^2\\) y los coeficientes de regresión son modelados de manera jerárquica. Utilice los siguientes priors:\n\\[\n\\begin{aligned}\n\\mu_a    &\\sim \\text{Normal}(0, 10) \\\\\n\\sigma_a &\\sim \\text{InvGamma}(0.1, 0.1) \\\\\n\\mu_b    &\\sim \\text{Normal}(0, 10) \\\\\n\\sigma_b &\\sim \\text{InvGamma}(0.1, 0.1) \\\\\na_j      &\\sim \\text{Normal}(\\mu_a, \\sigma^2_a) \\\\\nb_j      &\\sim \\text{Normal}(\\mu_b, \\sigma^2_b) \\\\\n\\sigma^2 &\\sim \\text{InvGamma}(0.1, 0.1)\n\\end{aligned}\n\\]\n\nEscriba un programa en Stan que implemente el modelo y obtenga el posterior con RStan.\nAnalice los coeficientes del modelo y las curvas de crecimiento. Genere gráficos similares a los producidos en el punto anterior. Describa similitudes y diferencias respecto del modelo 1. Justifique su respuesta.\n¿Qué problemas detecta los modelos 1 y 2? Considere como evoluciona el peso conforme la edad según el modelo.\n\nModelo 3\nComo alternativa al componente log-lineal anterior, se propone la siguiente curva de crecimiento logístico:\n\\[\nf_j(X) = a_j + b_j \\frac{\\exp [d_j (\\log(X) - c_j)]}{1 + \\exp [d_j(\\log(X) - c_j)]}\n\\]\nEste modelo tiene cuatro parámetros:\n\n\\(a_j\\) es el peso esperado cuando la edad es 0\n\\(b_j\\) es el peso máximo esperado (o la cota superior del peso)\n\\(\\log (c_j)\\) es la edad a la que la especie \\(j\\) alcanza la mitad del peso máximo\n\\(d_j > 0\\) determina la tasa de crecimiento del peso conforme aumenta la edad\n\nPara que la curva sea positiva y creciente para todas las edades, se debe cumplir que \\(a_j > 0\\), \\(b_j > a_j\\) y \\(d_j > 0\\). Se pueden satisfacer estas restricciones expresando los parámetros en función de parámetros cuyo dominio es \\(\\mathbb{R}\\).\n\n\\(a_j = \\exp (\\alpha_{j1})\\)\n\\(b_j = \\exp (\\alpha_{j2})\\)\n\\(c_j = \\alpha_{j3}\\)\n\\(d_j = \\exp (\\alpha_{j4})\\)\n\nConsidere las siguientes distribuciones a priori para los parámetros del modelo:\n\\[\n\\begin{aligned}\n\\alpha_{jk} &\\sim \\text{Normal}(0, 10) \\\\\n\\sigma^2_j  &\\sim \\text{InvGamma}(0.1, 0.1)\n\\end{aligned}\n\\]\n\nEscriba un programa en Stan que implemente el modelo y obtenga el posterior con RStan.\nAnalice los diagnósticos de la inferencia realizada.\nGrafique las curvas estimadas para cada especie junto a sus intervalos de credibilidad e interprete los resultados.\n\nModelo 4\nEste modelo es el mismo que el Modelo 3, excepto que las especies tienen la misma varianza, \\(\\sigma^2_j = \\sigma^2\\) y los coeficientes de regresión son modelados de manera jerárquica. Utilice los siguientes priors:\n\\[\n\\begin{aligned}\n\\mu_k             &\\sim \\text{Normal}(0, 10) \\\\\n\\sigma^2_k        &\\sim \\text{InvGamma}(0.1, 0.1) \\\\\n\\log(\\alpha_{jk}) &\\sim \\text{Normal}(\\mu_k, \\sigma^2_k) \\\\\n\\sigma^2          &\\sim \\text{InvGamma}(0.1, 0.1)\n\\end{aligned}\n\\]\n\nEscriba un programa en Stan que implemente el modelo y obtenga el posterior con RStan.\nAnalice los diagnósticos de la inferencia y compare con los resultados del modelo 3.\nGrafique las curvas estimadas para cada especie junto a sus intervalos de credibilidad e interprete los resultados. Compare con los resultados del modelo 3. ¿Qué diferencias observa? ¿Por qué se dan?\nEscriba una síntesis comparando todos los modelos desarrollados. Comente ventajas y desventajas de cada uno de ellos, explicando a que se deben en cada caso ¿Qué modelo resulta más conveniente para estimar la curva de crecimiento de los tiranosáuridos? Justifique su respuesta.\n\nNota: Queremos usar los priors del libro? O mejor usamos otra cosa? Estoy mirando los InvGamma por ejemplo. Ídem con la notación de varianza vs desvío estándar. \n\n\n\n\n\nReferencias\n\nDavidson-Pilon, Cameron. 2015. Bayesian Methods for Hackers: Probabilistic Programming and Bayesian Inference. 1st edition. Addison-Wesley Data; Analytics Series.\n\n\nErickson, Gregory M, Peter J Makovicky, Philip J Currie, Mark A Norell, Scott A Yerby, y Christopher A Brochu. 2004. «Gigantism and comparative life-history parameters of tyrannosaurid dinosaurs». Nature 430: 772-75.\n\n\nReich, Brian J., y Sujit K. Ghosh. 2019. Bayesian Statistical Methods. 1st edition. Chapman; Hall/CRC."
  },
  {
    "objectID": "practica/practica_00.html",
    "href": "practica/practica_00.html",
    "title": "Práctica - Unidad 0",
    "section": "",
    "text": "Descargar PDF\n\n\nDe las siguientes expresiones cual(es) se corresponde(n) con el enunciado “la probabilidad de que Argentina gane la copa del mundo el 18 de Diciembre de 2022”?\n\n\\(P(\\text{18 de Diciembre de 2022} | \\text{Argentina campeon})\\)\n\\(P(\\text{Argentina campeon})\\)\n\\(P(\\text{Argentina campeon}, \\text{18 de Diciembre de 2022}) / P(\\text{18 de Diciembre de 2022})\\)\n\\(P(\\text{Argentina campeon} | \\text{Diciembre})\\)\n\\(P(\\text{Argentina campeon} | \\text{18 de Diciembre de 2022})\\) \n\nEnuncie con palabras cada una de las expresiones del punto anterior. \nSegún la definición de probabilidad condicional\n\n¿Cuál es el valor de \\(P(A | A)\\)?\n¿Cuál es la probabilidad de \\(P(A, B)\\)?\n¿Cuál es la probabilidad de \\(P(A, B)\\) en el caso que \\(A\\) y \\(B\\) sean independientes?\nCuando se cumple que \\(P(A | B) = P(A)\\)?\nEs posible que \\(P(A | B) > P(A)\\)? Cuando?\nEs posible que \\(P(A | B) < P(A)\\)? Cuando? \n\nSea \\(X\\) una variable aleatoria con soporte \\(X \\in \\mathcal{S} = [1, \\infty)\\). Encuentre la constante \\(c\\), en función de \\(\\theta\\), que haga que \\(f(x) = c \\exp(-x / \\theta)\\) sea una función de densidad de probabilidad válida. \nSuponga \\(X \\sim \\text{Uniforme}(a, b)\\). Su soporte es \\(\\mathcal{S} = [a, b]\\) y su función de densidad de probabilidad es \\(f(x) = 1 / (b - a)\\) para todo \\(x \\in \\mathcal{S}\\).\n\nPruebe que \\(f(x)\\) es una función de densidad de probabilidad válida.\nEncuentre la media y la varianza de \\(X\\). \n\nSegún personas expertas en un problema determinado, se indica que el valor de un parámetro debe ser positivo y su distribución a priori debe tener media igual a 5 y varianza igual a 3. Encuentre una distribución que satisfaga estas condiciones. \nSean \\(X_1\\) y \\(X_2\\) dos variables aleatorias con función de probabilidad conjunta dada por la siguiente tabla\n\n\n\n\n\n\\(X_1\\) / \\(X_2\\)\n\\(X_2=0\\)\n\\(X_2=1\\)\n\n\n\n\n\\(X_1=0\\)\n\\(0.15\\)\n\\(0.15\\)\n\n\n\\(X_1=1\\)\n\\(0.15\\)\n\\(0.20\\)\n\n\n\\(X_2=2\\)\n\\(0.15\\)\n\\(0.20\\)\n\n\n\n\n\ndonde la celda de la primer fila y primer columna se lee \\(P(X_1=0, X_2=0)=0.15\\)\n\nObtenga la distribución marginal de \\(X_1\\).\nObtenga la distribución marginal de \\(X_2\\).\nObtenga la distribución condicional de \\(X_1\\) dado \\(X_2\\).\nObtenga la distribución condicional de \\(X_2\\) dado \\(X_1\\). \n\nSean \\(X_1\\) y \\(X_2\\) tales que \\((X_1, X_2)\\) siguen una distribución normal bivariada con \\(\\mathbb{E}(X_1) = \\mathbb{E}(X_1)\\) = 0, \\(\\text{Var}(X_1) = \\text{Var}(X_2 = 1)\\) y \\(\\text{cor}(X_1, X_2) = \\rho\\)\n\nEncuentre la distribución marginal de \\(X_1\\).\nEncuentre la distribución condicional de \\(X_1\\) dado \\(X_2\\). \n\nSuponga una urna \\(S\\) contiene un 40% de bolas verdes y un 60% de bolas rojas, y otra urna \\(E\\) contiene un 60% de bolas verdes y un 40% de bolas rojas. Una persona arroja una moneda de un peso argentino y selecciona una bola de una de las dos urnas dependiendo de si la moneda en sol o escudo. Si la moneda cae en sol, saca una bola de la urna \\(S\\) y si la moneda cae en escudo, saca una bola de la urna \\(E\\).\nConsidere las siguientes variables aleatorias:\n\\[\n\\begin{aligned}\nX &=\n    \\begin{cases}\n    1 & \\text{Si la moneda cae en sol} \\\\\n    0 & \\text{Si la moneda cae en escudo}\n    \\end{cases}\n\\\\\n\\\\\nY &=\n    \\begin{cases}\n    1 & \\text{Si la bola es verde} \\\\\n    0 & \\text{Si la bola es roja}\n    \\end{cases}\n\\end{aligned}\n\\]\n\nEncuentre la distribución conjunta de \\(X\\) e \\(Y\\) en una tabla.\nEncuentre \\(\\mathbb{E}(Y)\\). ¿Cuál es la probabilidad de que la bola sea verde?\nEncuentre \\(\\text{Var}(Y | X = 0)\\), \\(\\text{Var}(Y | X = 1)\\) Y \\(\\text{Var}(Y)\\). Considerando a la varianza como una medida de incertidumbre, explique de manera intuitiva por que algunas variancias son mas grandes que otras.\nSuponga que observa que la bola es verde. ¿Cuál es la probabilidad de que la moneda haya caido en escudo? \n\n\n\n\n\n\nMoneda de un peso argentino acuñada en 1995\n\n\n\n\nLas luces de giro en los automóviles se utilizan para indicar que se va a realizar alguna acción determinada. La acción depende del escenario donde se conduzca (urbano, ruta, rotonda, etc.) y la luz que se encienda (izquierda o derecha). En el uso urbano, se debe colocar la luz de giro correspondiente para indicar que se va a girar en un sentido determinado. Sin embargo, esto no siempre se realiza. Muchas veces sucede que un vehículo no muestra luz de giro, y sin embargo gira. Aunque menos frecuente, también se da que el vehículo colca la luz de giro, pero no gira. La probabilidad de girar dado que se colca la luz de giro es 0.87 y la probabilidad de girar dado que no se coloca la luz de giro es 0.21. Si observa que un vehículo coloca la luz de giro, ¿cuál es la probabilidad de que efectivamente doble?\nProblema del cumpleaños\nHay \\(k\\) personas en una sala. Suponga que el cumpleaños de cada persona tiene la misma probabilidad de ocurrir en cualquiera de los 365 días del año (se excluye el 29 de Febrero) y que los cumpleaños de las personas son independientes entre si. ¿Cuál es la probabilidad de que al menos un par de personas en el grupo cumplan los años el mismo día? \nProblema de concordancia de de Montmort\nConsidere un mazo de \\(n\\) cartas bien mezcladas, etiquetadas con números del 1 a \\(n\\). Se seleccionan las cartas de a una y se la da vuelta, diciendo en voz alta el número de cartas dadas vueltas desde 1 a \\(n\\). Para ganar el juego tiene que coincidir el número que se dice en voz alta con el número de la carta que se está dando vuelta – por ejemplo, si la séptima carta dada vuelta contiene el número 7. ¿Cuál es la probabilidad de ganar? ¿Depende de \\(n\\)? \nProblema de los dos sobres\nSupongamos que te presentan dos sobres con dinero. Un sobre contiene el doble de dinero que el otro, pero a simple vista son indistinguibles. Se te pide que escogas uno de los sobres. Antes de abrirlo se te ofrece la posibilidad de cambiarlo por el otro. ¿Cambiarías el sobre? ¿Por qué?   \n\n\n\n\n\nReferencias\n\nHoff, Peter D. 2009. A First Course in Bayesian Statistical Methods. 1st edition. Springer.\n\n\nMartin, Osvaldo A., Ravin Kumar, y Junpeng Lao. 2021. Bayesian Modeling and Computation in Python. 1st edition. Chapman; Hall/CRC.\n\n\nReich, Brian J., y Sujit K. Ghosh. 2019. Bayesian Statistical Methods. 1st edition. Chapman; Hall/CRC."
  },
  {
    "objectID": "computo/instalacion.html#rstan",
    "href": "computo/instalacion.html#rstan",
    "title": "Instalación de herramientas computacionales",
    "section": "RStan",
    "text": "RStan\n\nWindows\n\n\nUbuntu\n\n\nMac OS\n\n\nVerificación"
  },
  {
    "objectID": "computo/instalacion.html#librerias-adicionales",
    "href": "computo/instalacion.html#librerias-adicionales",
    "title": "Instalación de herramientas computacionales",
    "section": "Librerias adicionales",
    "text": "Librerias adicionales\n\n{brms}\n{ggplot2}\n{dplyr}\n**Estaria bueno pinear las dependencias usando {here} o algo similar\n\n\nVerificación"
  },
  {
    "objectID": "computo/instalacion.html#dependencias-optativas",
    "href": "computo/instalacion.html#dependencias-optativas",
    "title": "Instalación de herramientas computacionales",
    "section": "Dependencias optativas",
    "text": "Dependencias optativas\n\nQuarto\n… ?"
  },
  {
    "objectID": "trabajos_practicos/02_tp2.html",
    "href": "trabajos_practicos/02_tp2.html",
    "title": "TP2: Implementación del algoritmo de Metropolis-Hastings",
    "section": "",
    "text": "Descargar PDF"
  },
  {
    "objectID": "trabajos_practicos/02_tp2.html#metropolis-hastings-en-2d",
    "href": "trabajos_practicos/02_tp2.html#metropolis-hastings-en-2d",
    "title": "TP2: Implementación del algoritmo de Metropolis-Hastings",
    "section": "Metropolis-Hastings en 2D",
    "text": "Metropolis-Hastings en 2D\nSe desean tomar muestras de una normal bivariada asimétrica cuya función de densidad viene dada por\n\\[\nf(\\mathbf{x}) =\n    2\\ \\phi_2(\\mathbf{x} \\mid \\mathbf{0}, \\pmb{\\Omega})\n    \\ \\Phi(\\pmb{\\alpha}^T\\mathbf{x})\n    \\qquad \\mathbf{x} \\in \\mathbb{R}^2\n\\]\nsiendo \\(\\phi_2(\\mathbf{x}\\mid\\mathbf{0},\\mathbf{\\Omega})\\) la función de densidad de la normal bivariada de media \\(\\mathbf{0}\\) y matriz de covarianza \\(\\mathbf{\\Omega}\\), \\(\\Phi(\\pmb{\\alpha}^T\\mathbf{x})\\) es la función de probabilidad acumulada de la normal estándar \\(\\mathcal{N}(0,1)\\) y \\(\\pmb{\\alpha} \\in \\mathbb{R}^2\\) es un vector de parámetros.\n\nEn este caso, se tiene:\n\\[\n\\mathbf{\\Omega} = \\begin{bmatrix}1.5 & 0.6 \\\\ 0.6 & 1.5 \\end{bmatrix}\n\\]\ny\n\\[\n\\pmb{\\alpha} = [2 \\quad 0]\n\\]\n\n\n\n\n\nFunción de densidad de la que se desean obtener muestras\n\n\n\n\n\nEscriba una función que implemente el algoritmo de Metropolis-Hastings para tomar muestras de una función de probabilidad bivariada dada. Separe en funciones cada una de los pasos del algoritmo. La probabilidad de salto será normal bivariada de matriz de covarianza variable. Otorgue flexibilidad al algoritmo haciendo que reciba como argumento la matriz de covarianza de la probabilidad de transición.\n\nSe utilizará una normal bivariada para proponer un salto en el algoritmo de Metropolis-Hastings. Se explorará el efecto de diferentes distribuciones de probabilidad para el salto, en función de diferentes matrices de covarianza \\(\\mathbf{\\Sigma}\\). Si se representa a \\(\\mathbf{\\Sigma}\\) de la siguiente manera\n\\[\n\\mathbf{\\Sigma} =\n    \\begin{bmatrix} \\sigma_1 & 0 \\\\ 0 & \\sigma_2 \\end{bmatrix}\n    \\begin{bmatrix} 1 & \\rho \\\\ \\rho & 1\\end{bmatrix}  \n    \\begin{bmatrix} \\sigma_1 & 0 \\\\ 0 & \\sigma_2 \\end{bmatrix}\n\\]\ndonde \\(\\sigma_i\\) representa el desvío estándar de la componente \\(i\\) y \\(\\rho\\) la correlación entre las variables \\(X_1\\) y \\(X_2\\), entonces se deberán ensayar los siguientes casos:\n\n\\(\\sigma_1 = \\sigma_2\\) y \\(\\rho = 0\\)\n\\(\\sigma_1 > \\sigma_2\\) y \\(\\rho = 0\\)\n\\(\\sigma_1 < \\sigma_2\\) y \\(\\rho = 0\\)\n\\(\\sigma_1 = \\sigma_2\\) y \\(\\rho > 0\\)\n\\(\\sigma_1 = \\sigma_2\\) y \\(\\rho < 0\\)\n\nTO DO: Hacer gráficos\n\nPara al menos dos de los cinco casos anteriores, comparar las trayectorias seguidas por las cadenas al obtener muestras de \\(f(x)\\)."
  },
  {
    "objectID": "trabajos_practicos/02_tp2.html#aplicación-tiempo-de-reacción-humano-proponer-un-prior-para-sigma-y-uno-para-mu",
    "href": "trabajos_practicos/02_tp2.html#aplicación-tiempo-de-reacción-humano-proponer-un-prior-para-sigma-y-uno-para-mu",
    "title": "TP2: Implementación del algoritmo de Metropolis-Hastings",
    "section": "Aplicación: ¿tiempo de reacción humano? ¿proponer un prior para sigma y uno para mu?",
    "text": "Aplicación: ¿tiempo de reacción humano? ¿proponer un prior para sigma y uno para mu?"
  },
  {
    "objectID": "trabajos_practicos/01_tp1.html",
    "href": "trabajos_practicos/01_tp1.html",
    "title": "TP1: Aplicación de modelos conjugados a reviews de Google Maps",
    "section": "",
    "text": "Descargar PDF"
  },
  {
    "objectID": "trabajos_practicos/01_tp1.html#descubriendo-la-distribución-de-dirichlet",
    "href": "trabajos_practicos/01_tp1.html#descubriendo-la-distribución-de-dirichlet",
    "title": "TP1: Aplicación de modelos conjugados a reviews de Google Maps",
    "section": "Descubriendo la distribución de Dirichlet",
    "text": "Descubriendo la distribución de Dirichlet\nLa distribución Dirichlet es en realidad una familia de distribuciones. Se trata de una familia de distribuciones de probabilidad continuas y multivariadas. La distribución de Dirichlet en \\(K \\geq 2\\) es la distribución de probabilidad del vector aleatorio \\(X=[X_1, X_2 \\dots, X_K]\\) dimensiones tiene como parámetro al vector \\(\\mathbf{\\alpha} = [\\alpha_1, \\alpha_2, \\dots,\\alpha_K]\\).\n\\[\nf(x_1,x_2,\\dots,x_k \\mid \\alpha_1, \\alpha_2,\\dots,\\alpha_K) =\n    \\frac{1}{B(\\pmb{\\alpha})} \\prod_{i=1}^K x_i^{\\alpha_i-1}\n\\]\ndonde los \\(\\alpha_i \\in \\mathbb{R}^+\\) y \\(B(\\pmb{\\alpha})\\) es la constante que hace que la integral sea unitaria.\nEl soporte de la distribución Dirichlet es tal que \\(\\sum_{i=1}^{K} x_i = 1\\) y \\(x_i \\in [0,1]\\). Es decir, los \\(x_i\\) suman 1. Si consideramos, por ejemplo, \\(K=3\\), el vector \\([x_1, x_2, x_3]\\) pertenece al triángulo en \\(\\mathbb{R}^3\\) que tiene por vértices a los puntos \\((1,0,0)\\), \\((0,1,0)\\) y \\((0,0,1)\\). Así, si \\(x_1=1\\) entonces \\(x_2=x_3=0\\).\nMás simple aún, cuando \\(K=2\\), el vector \\([x_1,x_2]\\) pertenece al segmento en \\(\\mathbb{R}^2\\) que tiene por extremos a los puntos \\((1,0)\\) y \\((0,1)\\).\nNotar que esta característica hace que los \\(x_1, x_2, \\dots, x_K\\) puedan representar las probabilidades de un experimento con \\(K\\) resultados posibles.\nA título informativo, el soporte de la distribución Dirichlet en \\(K\\) dimensiones es lo que se conoce como simplex (estándar) de \\(K-1\\) dimensiones. El \\(3\\)-simplex es un triángulo y el \\(2\\)-simplex es un segmento. En general, un \\(K-1\\)-simplex es la envolvente convexa de \\(K\\) vértices y, a su vez, es la colección de todas las combinaciones convexas de puntos en el conjunto (Teorema de Carathéodory).\nLos párrafos anteriores, delirantemente matemáticos, muestran una virtud particular de la distribución Dirichlet de \\(K=3\\) dimensiones. Esta distribución, a pesar de ser de una variable aleatoria en \\(\\mathbb{R}^3\\), puede representarse perfectamente de manera gráfica en dos dimensiones (aunque utilizando un sistema de coordenadas peculiar: las coordenadas baricéntricas), como si se tratara de una distribución bivariada.\n\n\n\n\n\nComo los valores posibles del vector aleatorio tridimensional yacen en un plano, la distribución de probabilidad puede representarse gráficamente con facilidad\n\n\n\n\n\n\nMostrar que, cuando \\(K=2\\), la distribución de Dirichlet es la distribución beta de parámetros \\(a=\\alpha_1\\) y \\(b=\\alpha_2\\)"
  },
  {
    "objectID": "trabajos_practicos/01_tp1.html#relación-entre-la-distribución-dirichlet-y-la-multinomial",
    "href": "trabajos_practicos/01_tp1.html#relación-entre-la-distribución-dirichlet-y-la-multinomial",
    "title": "TP1: Aplicación de modelos conjugados a reviews de Google Maps",
    "section": "Relación entre la distribución Dirichlet y la multinomial",
    "text": "Relación entre la distribución Dirichlet y la multinomial\nCuando un experimento puede tener dos resultados posibles, uno de ellos tiene probabilidad \\(p\\) y el otro probabilidad \\(1-p\\). Si coleccionamos \\(N\\) realizaciones independientes del experimento, el número de éxitos es una variable aleatoria con distribución binomial. Estudiamos que era natural utilizar la distribución beta como distribución a priori para \\(p\\), dado que la distribución a posteriori también era beta.\nAnálogamente, cuando un experimento puede tener tres resultados posibles, el primero tiene probabilidad \\(p_1\\), el segundo tiene probabilidad \\(p_2\\) y el tercero, probabilidad \\(p_3 = p_1 - p_2\\). Necesariamente debe ser \\(p_1 + p_2 + p_3 = 1\\). Si coleccionamos \\(N\\) realizaciones independientes del experimento, el número de ocurrencias de cada resultado posible es un vector aleatorio con distribución multinomial. Por lo visto hasta aquí, todo parece indicar que, si queremos realizar inferencias sobre \\(p_1\\), \\(p_2\\) y \\(p_3\\), sería natural utilizar la distribución Dirichlet de tres dimensiones como distribución a priori para las probabilidades…\nEn efecto, cuando la distribución a priori es Dirichlet y la verosimilitud es multinomial, la distribución a posteriori también es Dirichlet.\n\nSabemos que para una verosimilitud binomial, si la distribución a priori de la probabilidad de éxito \\(p\\) es beta de parámetros \\(a\\) y \\(b\\) y se observan \\(s\\) éxitos en \\(N\\) intentos independientes, la distribución a posteriori es beta de parámetros \\(a' = a + s\\) y \\(b' = b + (N - s)\\).\nHallar, por analogía con el caso anterior, los parámetros de la distribución a posteriori que se obtiene si la verosimilitud es multinomial con tres resultados posibles, la distribución a priori es Dirichlet de parámetros \\([\\alpha_1, \\alpha_2, \\alpha_3]\\) y se obtuvieron \\(s_1\\) veces el primer resultado y \\(s_2\\) veces el segundo resultado, sobre un total de \\(N\\) intentos."
  },
  {
    "objectID": "trabajos_practicos/01_tp1.html#aplicación",
    "href": "trabajos_practicos/01_tp1.html#aplicación",
    "title": "TP1: Aplicación de modelos conjugados a reviews de Google Maps",
    "section": "Aplicación",
    "text": "Aplicación\nAsumiremos ahora que las reviews de un local tienen distribución multinomial de parámetros \\([p_1, p_2, \\dots, p_5]\\). Es decir, la probabilidad de que un usuario asigne 1⭐ es \\(p_1\\), de que asigne 2⭐ es \\(p_2\\), y así sucesivamente. Llamaremos \\(n_1\\) al número de calificaciones de 1⭐, \\(n_2\\) al número de calificaciones de 2⭐, y así sucesivamente. \\(n_1 + n_2 + n_3 + n_4 + n_5 = N\\) será el número total de reviews.\nSe puede verificar que el número esperado de reviews de \\(i\\)⭐ será \\(N p_i\\). Por lo tanto, la puntuación esperada será:\n\\[\n\\frac{1}{N} (1\\cdot N p_1 + 2\\cdot N p_2 + 3\\cdot N p_3 + 4\\cdot N p_4 +5\\cdot N p_5) =\n    \\sum_{i=1}^5 i \\cdot p_i\n\\]\n\nElija dos combinaciones de posibles valores de \\(p_i\\) que den un valor esperado de 4.1⭐. Piense en una combinación que represente acuerdo entre los clientes y otra que indique la presencia de opiniones dispares.\nEscriba una función que, dada una combinación de valores de \\(p_i\\), simule el proceso de calificación de un cliente.\nConstruya una función que simule la calificación de \\(U\\) clientes.\nSimule 1000 veces el proceso de 15 clientes que evalúan una cafetería de 4.1⭐ y el proceso de 100 clientes que evalúan la misma cafetería. ¿Qué se observa?\n\nUtilizaremos este nuevo modelo para realizar inferencias sobre las puntuaciones de Arto y Orlan.\n\nLos datos se generan siguiendo una distribución multinomial. ¿Cuáles son los parámetros de esa distribución multinomial? ¿Qué distribución a priori sería conveniente utilizar? ¿Cómo está parametrizada esa distribución a priori?\nElija los parámetros de la distribución a priori de modo tal que la creencia inicial sea uniforme sobre los posibles valores de los \\(p_i\\). ¿Qué implicancias tiene para la puntuación en ⭐ la distribución a priori elegida?\nCon los datos de la introducción, obtenga la distribución a posteriori de los \\(p_i\\) para cada cafetería.\n¿Cuál es la probabilidad de que Orlan sea mejor que Arto?"
  },
  {
    "objectID": "trabajos_practicos/00_tp0.html",
    "href": "trabajos_practicos/00_tp0.html",
    "title": "TP0: Distribución de Rocklets azules",
    "section": "",
    "text": "Descargar PDF\n\n\nDistribución de Rocklets azules"
  },
  {
    "objectID": "trabajos_practicos/03_tp3.html",
    "href": "trabajos_practicos/03_tp3.html",
    "title": "TP3: Estudio de modelos lineales mediante simulaciones",
    "section": "",
    "text": "Descargar PDF"
  },
  {
    "objectID": "trabajos_practicos/03_tp3.html#simulaciones",
    "href": "trabajos_practicos/03_tp3.html#simulaciones",
    "title": "TP3: Estudio de modelos lineales mediante simulaciones",
    "section": "Simulaciones",
    "text": "Simulaciones\nEl archivo … contiene 100 observaciones que se usarán para identificar los parámetros de un modelo, mientras que el archivo … tiene 20 observaciones que se usarán para evaluar los resultados del proceso de inferencia.\nSe sabe que los datos fueron generados utilizando un modelo de la forma:\n\\[\ny_i \\sim \\mathcal{N}(\\theta_3 x_i^3 + \\theta_2 x_i^2 + \\theta_1 x_i + \\theta_0, \\sigma^2)\n\\]\naunque no se conocen los valores de los \\(\\theta_i\\) ni de \\(\\sigma\\)\nEn primer lugar, se estudiará el efecto de la cantidad de datos utilizados para el ajuste del modelo.\n\nUtilizando priors vagos para los parámetros del modelo, analice los resultados obtenidos al utilizar 10, 20, 50 o 100 observaciones de los datos de entrenamiento. Compare las distribuciones a posteriori de los parámetros y las predicciones sobre los datos de test.\n\nEn segundo lugar, se investigará qué efecto tiene la elección de distribuciones a priori centradas en valores erróneos de los parámetros de la regresión.\n\nConsidere las siguientes distribuciones a priori […]. Compare, como hizo en el caso anterior, los resultados en las estimaciones utilizando 10, 20, 50 y 100 observaciones.\n\nFinalmente, se considera el caso donde se propone un modelo erróneo.\n\nUtilizando priors vagos, ajuste polinomios de grado 3, 4, 5 y 6 utilizando 20 observaciones. Compare gráficamente el ajuste en los datos de entrenamiento con el ajuste en los datos de evaluación. ¿Qué ocurre si se utilizan todos los datos?\nUtilice ahora priors de regularización (centrados en 0) para polinomios de grado 3, 4, 5 y 6 utilizando 20 observaciones. Pruebe diferentes grados de regularización. Compare gráficamente el ajuste en los datos de entrenamiento con el ajuste en los datos de evaluación.\nEscriba una función que calcule el lppd para un conjunto de observaciones. Compare lppd para los polinomios de grados 3, 4, 5 y 6 ajustados con 20 observaciones. Compare la métrica utilizando los datos de entrenamiento y de evaluación."
  },
  {
    "objectID": "trabajos_practicos/03_tp3.html#enfriamiento-de-agua-en-un-termo",
    "href": "trabajos_practicos/03_tp3.html#enfriamiento-de-agua-en-un-termo",
    "title": "TP3: Estudio de modelos lineales mediante simulaciones",
    "section": "Enfriamiento de agua en un termo",
    "text": "Enfriamiento de agua en un termo\nEn un país matero como Argentina, era de esperarse que aparecieran casi tantos termos como personas. Es difícil decir si la cantidad de variantes de termos en el mercado nacional cambió, pero es indudable que, tras el furor del termo color verde militar, la elección de un termo adquirió un papel relevante en el ritual del mate.\nDe acero, de vidrio, con capa aisladora. Diferentes configuraciones dan lugar a distintas capacidades de mantener la temperatura y, obviamente, a distintos rangos de precios. Dejando de lado la cuestión monetaria, centrémonos en estudiar cómo varía la temperatura de un líquido en el interior de un termo en función del tiempo transcurrido.\nLa temperatura es una medida del grado de agitación de las partículas de una sustancia. Un líquido (o sólido, o gas) está más caliente que otro si sus partículas tienen (en promedio) mayor grado de agitación. Sabemos por evidencia empírica que si un cuerpo se pone en contacto con otro que tiene una temperatura menor, hay una transferencia de energía que hace que el primero se enfríe y el segundo se caliente, hasta que alcanzan el denominado equilibrio térmico.\nDe manera similar, esto es lo que ocurre con el agua que dejamos dentro del termo: en algún momento, llega al equilibrio térmico con el ambiente. La salvedad necesaria acá es que, como el ambiente es grande, no aumenta su temperatura con la energía que pierde el agua del recipiente.\nAhora bien, el ritmo con el cual el agua caliente pierde energía no es constante. Físicamente, mientras mayor sea la diferencia de temperatura entre dos cuerpos, más rápido fluirá la energía (y más rápido cambiará la temperatura). Si estudiamos la temperatura del agua en el termo en función del tiempo, notaremos que el ritmo con el que cambia decrece a medida con el que transcurre el tiempo.\nLa lectura del párrafo anterior debería permitir asociar el concepto de ritmo de cambio con la noción matemática de derivada. En efecto, la derivada de la temperatura respecto al tiempo varía con el tiempo. En otras palabras, la pendiente no es constante.\nLas leyes que rigen el universo pueden muchas veces formularse en términos de lo que en matemática se conoce como ecuación diferencial. En este caso, la temperatura del agua en el termo satisface la siguiente ley:\n\\[\n\\frac{\\mathrm{d}T(t)}{\\mathrm{d}t} = r [T_{\\text{amb}}-T(t)]\n\\]\ndonde \\(T_{\\text{amb}}\\) es la temperatura ambiente (un valor fijo y conocido), \\(r\\) es una constante y \\(T(t)\\) es la función (en principio desconocida) que describe la temperatura del agua del termo en función del tiempo.\nNo se trata de una ecuación algebraica donde la solución es un valor numérico sino de una ecuación donde la solución es una función. Buscamos una función \\(T(t)\\) que satisfaga la ecuación: su derivada debe cambiar con el valor que toma la función.\nUna función que satisface esa ecuación es:\n\\[\nT(t) = T_{\\text{amb}} + (T_i - T_{\\text{amb}})e^{-rt}\n\\]\nsiendo \\(T_i\\) la temperatura a la que está inicialmente el agua en el termo (un valor fijo y conocido).\n\nVerificar que la función anterior satisface la ecuación diferencial\nGrafique \\(T(t)\\) para \\(T_{\\text{amb}} = 20 \\text{ C°}\\) y \\(T_i = 90 \\text{ C°}\\), para dos valores de \\(r\\), \\(r_1=0.1\\) y \\(r_2 = 0.3\\). ¿Qué representa \\(r\\)?\nSegún su experiencia con termos, ¿cuál es un valor realista de \\(r\\)?\n\nEstudiaremos a continuación un conjunto de mediciones de temperatura de agua en un termo en función del tiempo transcurrido.\nLeonel tiene un termo Estanli™ que compró por Amason y se dispone a despejar la duda de cualquier usuario de termos Estanli™: ¿cuánto dura el agua caliente? Pone agua en la pava eléctrica, la vierte en el termo y registra la temperatura en algunos momentos posteriores. Ese día, el reporte meteorológico indica una temperatura de \\(T_{\\text{amb}} = 23\\text{ C°}\\). Las temperaturas que registró Leonel son las siguientes:\n\n\n\n\n \n  \n    t (h:mm) \n    T (°C) \n  \n \n\n  \n    1:20 \n    92.0 \n  \n  \n    2:30 \n    90.5 \n  \n  \n    4:00 \n    81.4 \n  \n  \n    5:15 \n    80.8 \n  \n  \n    8:30 \n    74.2 \n  \n\n\n\n\n\nPara simplificar la construcción de un modelo, en lugar de considerar la temperatura del agua en el termo, se considerará la diferencia entre la temperatura del agua y la temperatura ambiente \\(T-T_{\\text{amb}}\\). Además, se llamará \\(T_{\\text{diff}}\\) a la diferencia de temperatura entre la temperatura inicial del agua y la temperatura ambiente \\(T_i - T_{\\text{amb}}\\).\n\\[\nT(t) - T_{\\text{amb}} = T_{\\text{diff}} e^{-rt}\n\\]\n\nVerifique que el logaritmo natural de la nueva variable (\\(T(t) - T_{\\text{amb}}\\)) es una función lineal de \\(t\\).\n¿Qué representan \\(\\beta_0\\) y \\(\\beta_1\\)?\n\nAjustaremos un modelo lineal a los datos transformados.\n\nEn función del enunciado del problema y de su conocimiento de termos, elija una distribución a priori para \\(\\beta_0\\), \\(\\beta_1\\) y \\(\\sigma\\). ¿Cuáles son las implicancias de sus distribuciones a priori? Realice pruebas predictivas a priori.\nAjuste el modelo lineal utilizando R\nEncontrar el posterior de \\(r\\), de \\(T_{\\text{diff}}\\) y de la temperatura inicial del agua \\(T_i\\)\nPredecir la temperatura a la que estará el agua transcurridas 12:00 h del inicio de la experiencia.\nHalle la distribución a posteriori del tiempo que le toma al agua llegar a \\(30 \\text{ C°}\\)"
  },
  {
    "objectID": "trabajos_practicos/descripcion.html",
    "href": "trabajos_practicos/descripcion.html",
    "title": "Generalidades",
    "section": "",
    "text": "Para aprobar la materia es necesario completar tres trabajos prácticos cortos. La denominación cortos hace referencia a que los trabajos son guiados y las tareas a realizar están delimitadas.\nLos trabajos prácticos tienen como objetivo repasar y afianzar los conocimientos adquiridos durante las clases, adquirir práctica en la aplicación de conceptos trabajados, mejorar las habilidades de programación y el uso de R, e incorporar algunos conceptos complementarios.\nCada trabajo práctico será presentado y discutido en clase. Se destinará una fracción de la clase a comenzar a pensar algunas de las actividades.\nLa fecha de entrega de cada trabajo práctico será de dos semanas luego de la fecha de presentación. Se podrá entregar el trabajo práctico una semana después de la fecha de entrega con una penalización del 25% de la nota final.\nPara cada trabajo práctico, cada grupo deberá entregar un informe en formato pdf donde se resuelvan las actividades propuestas. El informe debe estar obligatoriamente elaborado utilizando \\(\\mathrm{\\LaTeX{}}\\) (a través de Quarto, RMarkdown o alguna otra variante). Tener en cuenta que los apartados presentados en el enunciado del trabajo práctico constituyen una guía de actividades a resolver y no deben responderse uno a uno como si se tratara de un cuestionario. El informe deberá permitir una lectura fluida de los resultados y análisis presentados. Cuando la resolución de una problemática consista en una función o porción de código en R, el código deberá mostrarse en el informe.\nSe evaluarán los siguientes aspectos del informe: presentación, redacción (claridad, coherencia y cohesión), estética, resultados obtenidos, profundidad del análisis."
  },
  {
    "objectID": "notas/planificacion.html",
    "href": "notas/planificacion.html",
    "title": "Contenidos detallados",
    "section": "",
    "text": "Actividad Rocklets\n\n\nRepaso\n\nRepaso de probabilidad, distribuciones conjuntas, distribuciones marginales\nPráctica 0 (ver qué ejercicios)\n\n\n\nIntroducción\n\nProbabilidad para cuantificar la incertidumbre\n\nDefiniciones de probabilidad\n\nClasica\nFrecuentista\nBayesiana (subjetiva)\n\nProbabilidades subjetivas\nLógica y razonamiento plausible (ver Jaynes)\nDutch book\n\nRegla de Bayes\n\nHistoria: Bayes, Price, Laplace\nPresentación tradicional de la Regla de Bayes\n\nLey de la probabilidad total\n\nPráctica 1 (ver qué ejercicios)\n\nInferencia bayesiana: problema original de Bayes, problema de la percepción del suelo mojado, problema de las bolas (¿hecho en vivo con Sugus?), problema del globo terráqueo (¿hecho en vivo?), problema de detección de gluten (ver Downey), problema de detección de una explosión (ver Barber).\n\nDiscutir modelos generativos (probabilidad hacia adelante e inversa).\nPráctica 1 (ver qué ejercicios)\nIdea intuitiva: ¿qué es el prior? ¿qué es la función de verosimilitud? ¿qué es el posterior?\n\n\n\n\nModelos de distribuciones conjugadas\n\nModelo beta-binomial\n\nDemostración\n\nBeta(a,b) siendo a y b “pseudocuentas”\n\nDefinición de “distribuciones conjugadas” (ver BDA 2.4)\nEnfoque intuitivo\nDistribución a posteriori como compromiso entre likelihood y prior\n\nver caso particular y luego generalidad 2.2 de BDA\n\nRazonamiento secuencial\nResumen de la distribución a posteriori: media, moda, intervalos de credibilidad. Cálculos a mano, cálculos exacto con funciones de R. Simulaciones (vamos a introducir la idea de utilizar simulaciones para resolver problemas)\n\nPodemos resolver algunos ejercicios de Simulación de la Práctica 2\n\nPredicciones: simulaciones. Problema del amanecer.\nEstimación por máxima verosimilitud\nPráctica 2\n\nElección de la distribución a priori\n\nPráctica 2\n\nModelo normal-normal\n\nDemostración\nEnfoque intuitivo\nDistribución a posteriori como compromiso entre likelihood y prior\nRazonamiento secuencial\nPredicciones: distribución predictiva. Incertidumbre propia del sampleo + incertidumbre (ver BDA 2.5 y posterior predictive distribution). Plugin approximation vs posterior predictive distribution (3.1.5.2 de Murphy)\nModelo normal con prior uniforme (ver Devinderjit y Skilling, Sección 2.3 – Example 2)\n(¿) Modelo normal con media conocida y varianza desconocida (?) (ver BDA 2.6)\n\nModelo Gamma-Poisson\nOtros modelos de distribuciones conjugadas para una variable (ver Práctica 2)\nPresentación TP1 – Conjugación Dirichlet-Multinomial\nModelos de varias variables\n\nNormal con media y desvío desconocido: modelo normal – normal-gamma-inversa (ver Ejemplo 2.8 de Carlin y Louis, BDA Sección 3.3 y 3.2.3.3 de Murphy)\nNormal con con media y desvío desconocido: prior uniforme (ver Devinderjit y Skilling, Sección 3.3 – Example 5 y ver BDA Sección 3.2). Relación con máxima verosimilitud (ver Devinderjit y Skilling, Sección 3.5 – Approximations)\n(¿) Distribuciones marginales de los parámetros (?)\n\n\n\n\nNociones de Teoría de la Decisión\n\nEl resultado de la inferencia bayesiana es la distribución a posteriori… aún así, a veces podemos querer resumirla\n¿Por qué tiene sentido resumir la distribución a posteriori usando la media?\nFunciones de pérdida (ver Davidson-Pilon, Capítulo 5)\nPosterior expected loss (ver Robert, Sección 2.3: Utility and loss)\n\nEjemplo de COVID-19 de Murphy (3.8.2)\n\nDemostración de que la media minimiza la pérdida cuadrática (ver Robert, Proposición 2.5.1)\nEjercicios (Práctica 2)\n\n\n\nMétodos Computacionales\n\nProblemas: determinación de probabilidades, cálculo de integrales, determinación de la distribución a posteriori (dos problemas: integrales analíticas y dimensiones de esa integral)\nDeterminación de probabilidades (ya lo hemos trabajado en la Práctica 2)\nEjercicios Simulación (Práctica 3)\nGrid approximation\n\nUn parámetro\nDos parámetros\nCaso discreto ((¿)grid approximation de un problema para estimar N y theta(?)) y caso continuo\n\nEjercitación grid approximation (Práctica 3)\nDeterminación de la distribución a posteriori (aka sampling) por métodos de MCMC\n\nPresentar rejection sampling\n(¿) Importance sampling (?)\nMetropolis-Hastings\n\nPresentación TP2 – Metropolis-Hastings (trabajo en clase)\nDiagnóstico de métodos de MCMC\nHamiltonian Montecarlo\nPráctica HMC\nProgramación probabilística: Stan\nComponentes de un modelo en Stan\nImplementación de un modelo ya trabajado.\n\nDiagnósticos\nManipulación de muestras de MCMC.\nVisualizaciones de resultados (estimaciones de parámetros y predicciones). Uso del paquete ggdist.\n\n\n\n\nModelos lineales\n\nEstimación por mínimos cuadrados. Estimación por máxima verosimilitud.\n\nVer ROS 8.1\n\nEstimación bayesiana. Priors conjugados para varianza conocida y varianza desconocida.\n\nCentrado de variables (ver Murphy y 12.3 de ROS)\n\nDistribución predictiva.\nImplementación en Stan y brms (comparación de brms con lm en R, ¿cómo obtenemos los mismos resultados? ver ROS 8.4).\nManipulación de resultados.\nPredicciones probabilísitas (predicciones basadas en distribuciones de probabilidad). Propagación de incertidumbre. Interpretación.\n\nPredicción puntual vs predicción de la media (predictor lineal) vs distribución predictiva\nWe have a set of posterior simulations rather than a single point estimate because we have uncertainty about these parameters. (ROS 9.1)\nAs sample size approaches infinity, the coefficients a and b are estimated more and more precisely, and the uncertainty in the linear predictor approaches zero, but the uncertainty in the predictive distribution for a new observation does not approach zero; it approaches the residual standard deviation σ. (ROS 9.2)\n\nParameter recovery\n\n(ver ROS 7.2 Checking the model-fitting procedure using fake-data simulation)\n\nPruebas predictivas a posteriori. Comparación de los datos disponibles con réplicas generadas por el modelo ajustado (lo que en ROS llaman validación interna)\n\nVer ROS 11.4\n\nElección de una distribución a priori. Pruebas predictivas a priori.\nProblemas con la estimación de mínimos cuadrados. Regularización ridge (\\(L_2\\)) y lasso (\\(L_1\\)). Distribuciones a priori para regularizar.\n\nSelección de variables con horseshoe prior (ver ROS 12.7)\nValidación externa y criterios de información (ver 3.7.4 de Murphy Advanced, McElreath y BDA aunque está medio confuso)\n\nlppd (log pointwise predictive density): promedio del score predictivo a través de los posibles valores de \\(\\theta\\)\n\\[\nlppd = \\sum_{i=1}^{N} \\log \\left( \\int p\\left(y_i\\mid\\theta\\right) p_{post}(\\theta) d\\theta \\right)\n\\]\n\\[\nlppd = \\sum_{i=1}^{N} \\log \\left( \\frac{1}{S} \\sum_{i=1}^{S} p\\left(y_i\\mid\\theta^{(s)}\\right) \\right)\n\\]\nPSIS\n\n\n\n\nRegresión Logística\n\nModelo para clasificación (creo que podemos trabajarlo bien siguiendo Bayes Rules!)\nSimulación\nInterpretación de coeficientes\nExceso de ceros (ver ejemplo de Bayes Rules! y Negative Binomial)\n\n\n\nRegresión Poisson\n\nModelo para datos de conteo (creo que podemos trabajarlo bien siguiendo Bayes Rules!)\nSimulación\n\n\n\nEnfoque multinivel\n\nModelo beta-binomial jerárquico (ver Kruschke)\nShrinkage de parámetros\nEjemplo de uranio de Gelman: no pooling vs complete pooling vs partial pooling\nEjemplo de las ranas de McElreath:\nEjemplo de las canciones (Bayes Rules!)\nEjemplo de la carrera de Washington (Bayes Rules!)\nModelos jerárquicos con predictores (Capítulo 17 de Bayes Rules)\n\nVariación en el intercepto\nVariación en la pendiente\n\nProblemas de estimación\nOpcional: regresión logística jerárquica y regresión Poisson jerárquica (ver ejemplo de Bayes Rules! y de un paper de Paul Burkner sobre pesca (?))"
  },
  {
    "objectID": "complementario/variables.html",
    "href": "complementario/variables.html",
    "title": "Repaso de Variables Aleatorias",
    "section": "",
    "text": "Variables aleatorias\n\nDiscretas\nContinuas\n\nCDF\nPDF\nDistribucion conjunta\nDistribucion marginal\nDistribucion condicional\nIndependencia e independencia condicional\nMomentos de una distribucion\nRegla de Bayes\nDistribuciones de probabilidad frecuentemente utilizadas\nTransformacion de variables aleatorias\n\nPropiedades de transformaciones lineales\n\n\nEste listado esta sacado del capitulo 2 de Murphy (2022)\nTambien hay cosas interesantes en capitulo 3 de Murphy (2022)\n\nUncorrelated does not imply independent\nCorrelation does not imply causation\n\n\nPairwise independence does not imply mutual independence\nWe say that two random variables are pairwise independent if \\(p(X_2|X_1) = p(X_2)\\) and hence \\(p(X_2, X_1) = p(X_1)p(X_2|X_1) = p(X_1)p(X_2)\\)\nWe say that \\(n\\) random variables are mutually independent if \\(p(Xi|XS) = p(Xi)\\) \\(\\forall S \\subseteq \\{1, \\cdots , n\\}\\) and hence \\(\\displaystyle p(X_{1:n}) = \\prod_{i=1}^{n} p(X_i)\\)\nShow that pairwise independence between all pairs of variables does not necessarily imply mutual independence. It suffices to give a counter example.\nExercise 2.5 Murphy (2022)\nExercise 2.6 Murphy (2022)\nExercise 3.5 [Gaussian vs jointly Gaussian ]\n\n\n\n\n\nReferencias\n\nMurphy, Kevin P. 2022. Probabilistic Machine Learning: An Introduction. 1st edition. The MIT Press. https://probml.ai/."
  },
  {
    "objectID": "info/calendario.html",
    "href": "info/calendario.html",
    "title": "Calendario",
    "section": "",
    "text": "Semana\nFecha\nUnidad\nTemas\nApunte\nLectura sugerida\nOtras actividades\n\n\n\n\n1\n20 de marzo\n1\n• Presentación de la materia• Probabilidad• Regla de Bayes\n\n• McElreath (2020): Capítulo 1• Kruschke (2014): Capítulo 4\n\n\n\n2\n27 de marzo\n1, 2\n• Inferencia bayesiana• Distribución a priori, función de verosimilitud y distribución a posteriori• Modelos conjugados\n\n• Johnson, Ott, y Dogucu (2022): Capítulos 1, 3, 4, 5 y 8• Kruschke (2014): Capítulos 1, 5 y 6• McElreath (2020): Capítulo 2\n\n\n\n3\n3 de abril\n2\n• Modelos de varios parámetros\n\n• Gelman et al. (2013): Capítulo 3\nPresentación TP1 (5-abr)\n\n\n4\n10 de abril\n2, 3\n• Nociones de Teoria de Decisión Bayesiana• Limitaciones del enfoque analítico• Simulaciones• Aproximación grilla\n\n• Johnson, Ott, y Dogucu (2022): Capítulo 6• McElreath (2020): Capítulo 3\n\n\n\n5\n17 de abril\n3\n• Introducción al cómputo bayesiano• Markov-chain Montecarlo• Metropolis-Hastings\n\n• Johnson, Ott, y Dogucu (2022): Capítulo 7• Kruschke (2014): Capítulo 7\nEntrega TP1 (19-abr)  Presentación TP2 (19-abr)\n\n\n6\n24 de abril\n3\n• Programación probabilística• Stan• Diagnósticos• Visualizaciones• Hamiltonian Montecarlo\n\n• Kruschke (2014): Capítulo 14\n\n\n\n7\n1 de mayo\n4\n• Modelos lineales• Paquete brms\n\n• Johnson, Ott, y Dogucu (2022): Capítulo 9• McElreath (2020): Capítulo 4• Gelman y Hill (2006): Capítulos 3 y 4• Gelman, Hill, y Vehtari (2021): Capítulos 6, 7 y 8\nEntrega TP2 (3-may)\n\n\n8\n8 de mayo\n4\n• Regularización\n\n\n\n\n\n9\n15 de mayo\n4\n• Selección de modelos• Criterios de información• Validación cruzada• Sobreajuste y subajuste\n\n• Gelman, Hill, y Vehtari (2021): Capítulo 11• Johnson, Ott, y Dogucu (2022): Capítulo 10• McElreath (2020): Capítulo 7\nParcial (15-may)  Presentación TP3 (17-may)\n\n\n10\n22 de mayo\n5\n• Regresión logística\n\n• Gelman, Hill, y Vehtari (2021): Capítulo 13• Gelman y Hill (2006): Capítulo 5• Johnson, Ott, y Dogucu (2022): Capítulo 13\n\n\n\n11\n29 de mayo\n5\n• Regresión Poisson\n\n• Johnson, Ott, y Dogucu (2022): Capítulo 12• Gelman y Hill (2006): Capítulo 6• Gelman, Hill, y Vehtari (2021): Capítulo 15\nEntrega TP3 (31-may)  Recuperatorio (2-jun)\n\n\n12\n5 de junio\n5\n• Enfoque multinivel• Modelos jerárquicos• Shrinkage de parámetros\n\n• Kruschke (2014): Capítulo 9• Johnson, Ott, y Dogucu (2022): Capítulos 15 y 16• McElreath (2020): Capítulo 13• Gelman y Hill (2006): Capítulo 11\nPresentación TP Final\n\n\n13\n12 de junio\n5\n• Modelos lineales jerárquicos• Variación en el intercepto• Variación en la pendiente• Problemas de estimación\n\n• Johnson, Ott, y Dogucu (2022): Capítulo 17• Gelman y Hill (2006): Capítulos 12 y 13\n\n\n\n14\n19 de junio\n\n\n\n\n\n\n\n15\n26 de junio\n\n\n\n\nEntrega TP Final + Defensa oral\n\n\n\n\n\n\n\n\n\n\nReferencias\n\nGelman, Andrew, John B. Carlin, Hal S. Stern, David B. Dunson, Aki Vehtari, y Donald B. Rubin. 2013. Bayesian Data Analysis. 3rd edition. Chapman; Hall/CRC.\n\n\nGelman, Andrew, y Jennifer Hill. 2006. Data Analysis Using Regression and Multilevel-Hierarchical Models. 1st edition. Cambridge University Press.\n\n\nGelman, Andrew, Jennifer Hill, y Aki Vehtari. 2021. Regression and Other Stories. 1st edition. Cambridge University Press. https://users.aalto.fi/~ave/ROS.pdf.\n\n\nJohnson, Alicia A., Miles Q. Ott, y Mine Dogucu. 2022. Bayes Rules! An Introduction to Bayesian Modeling. 1st edition. Chapman; Hall/CRC. https://www.bayesrulesbook.com/.\n\n\nKruschke, John. 2014. Doing Bayesian Data Analysis: A Tutorial with R, JAGS, and Stan. 2nd edition. Academic Press.\n\n\nMcElreath, Richard. 2020. Statistical Rethinking: A Bayesian Course with Examples in R and Stan. 2nd edition. Chapman; Hall/CRC."
  },
  {
    "objectID": "info/aprobacion.html",
    "href": "info/aprobacion.html",
    "title": "Condiciones de aprobación",
    "section": "",
    "text": "Instancias de evaluación\n\n📝 Parcial – escrito e individual, se aprueba con 6, hay una instancia de recuperación;\n💻💻💻 Trabajos prácticos cortos – grupales (hasta tres personas), se hacen por fuera del horario de clase, se entrega informe;\n📈 Trabajo práctico final – realización grupal, defensa individual.\n\n\n\nCondiciones de aprobación\n\nPromoción\n\nLas y los estudiantes que hayan aprobado el parcial o su recuperatorio (con nota \\(P\\)), los tres trabajos prácticos cortos (con promedio simple \\(T\\)) y hayan entregado el trabajo práctico final, accederán a una instancia de evaluación oral donde se discutirá el trabajo práctico final y se evaluarán de manera general todos los contenidos conceptuales de la asignatura; esta instancia puede incluir la realización de algunas actividades en computadora (el trabajo práctico final y la instancia oral tendrán nota \\(O\\)).\nLa nota final se obtendrá según \\(0.3\\ T + 0.4\\ P + 0.3\\ O\\)\n\nRegularidad\n\nQuienes no alcancen la condición de promoción podrán quedar en condición de estudiante regular si aprueban el parcial o su recuperatorio y aprueban al menos dos de los trabajos prácticos cortos. Para alcanzar la aprobación de la asignatura, los y las estudiantes en condición de regulares deberán presentar el trabajo final en una mesa de examen y aprobar una instancia oral de defensa del trabajo y de evaluación integral de los contenidos de la materia. Esta instancia puede incluir la realización de algunas actividades en computadora.\n\nLibres\n\nAquellas personas que no alcancen la promoción de la asignatura ni la condición de estudiante regular quedarán en condición de estudiante libre. Los y las estudiantes en condición de libre deberán presentar un trabajo práctico y rendir un examen teórico-práctico sobre la totalidad de los temas de la asignatura."
  },
  {
    "objectID": "info/enlaces_utiles.html",
    "href": "info/enlaces_utiles.html",
    "title": "Enlaces útiles",
    "section": "",
    "text": "Awesome Bayesian Statistics. Es un listado de recursos en línea (y gratuitos!) relacionados al mundo de la Estadística Bayesiana."
  },
  {
    "objectID": "info/docentes.html",
    "href": "info/docentes.html",
    "title": "Estadística Bayesiana",
    "section": "",
    "text": "Docentes"
  },
  {
    "objectID": "info/faq.html",
    "href": "info/faq.html",
    "title": "Estadística Bayesiana",
    "section": "",
    "text": "Preguntas frecuentes\n\nPertenezo al plan 2003 de la carrera, ¿puedo participar de las clases?\nSi, podés asistir a las clases como oyente y también realizar los trabajos prácticos. Sin embargo, los profesores no se comprometen a realizar devoluciones o correcciones sobre los trabajos de estudiantes que asistan en calidad de oyente."
  },
  {
    "objectID": "info/bibliografia.html",
    "href": "info/bibliografia.html",
    "title": "Bibliografía",
    "section": "",
    "text": "Bibliografía principal\n\nJohnson, Ott, y Dogucu (2022) McElreath (2020) Gelman y Hill (2006) Kruschke (2014) Reich y Ghosh (2019)\n\n\n\nGelman, Andrew, y Jennifer Hill. 2006. Data Analysis Using Regression and Multilevel-Hierarchical Models. 1st edition. Cambridge University Press.\n\n\nJohnson, Alicia A., Miles Q. Ott, y Mine Dogucu. 2022. Bayes Rules! An Introduction to Bayesian Modeling. 1st edition. Chapman; Hall/CRC. https://www.bayesrulesbook.com/.\n\n\nKruschke, John. 2014. Doing Bayesian Data Analysis: A Tutorial with R, JAGS, and Stan. 2nd edition. Academic Press.\n\n\nMcElreath, Richard. 2020. Statistical Rethinking: A Bayesian Course with Examples in R and Stan. 2nd edition. Chapman; Hall/CRC.\n\n\nReich, Brian J., y Sujit K. Ghosh. 2019. Bayesian Statistical Methods. 1st edition. Chapman; Hall/CRC.\n\n\n\n\nBibliografía complementaria\n\nGelman et al. (2013), Gelman, Hill, y Vehtari (2021), Downey (2021), Lee y Wagenmakers (2014), Davidson-Pilon (2015), Nicenboim, Schad, y Vasishth (2022), Barr (2021), Carlin y Louis (2008), Hoff (2009), MacKay (2003), Lambert (2018), Murphy (2022), Murphy (2023), Bishop (2006), Martin, Kumar, y Lao (2021), Theoridis (2020), Clyde et al. (2022), Ma, Kording, y Goldreich (2022)\n\n\n\n\n\nBarr, Dale J. 2021. Learning statistical models through simulation in R: An interactive textbook. 1st edition. https://psyteachr.github.io/stat-models-v1/.\n\n\nBishop, Christopher M. 2006. Pattern Recognition and Machine Learning. 1st edition. Springer.\n\n\nCarlin, Bradley P., y Thomas A. Louis. 2008. Bayesian Methods for Data Analysis. 3rd edition. Chapman; Hall/CRC.\n\n\nClyde, Merlise, Mine Çetinkaya-Rundel, Colin Rundel, David Banks, Christine Chai, y Lizzy Huang. 2022. An Introduction to Bayesian Thinking. 1st edition. https://statswithr.github.io/book/.\n\n\nDavidson-Pilon, Cameron. 2015. Bayesian Methods for Hackers: Probabilistic Programming and Bayesian Inference. 1st edition. Addison-Wesley Data; Analytics Series.\n\n\nDowney, Allen B. 2021. Think Bayes: Bayesian Statistics in Python. 2nd edition. O’Reilly Media. http://allendowney.github.io/ThinkBayes2/.\n\n\nGelman, Andrew, John B. Carlin, Hal S. Stern, David B. Dunson, Aki Vehtari, y Donald B. Rubin. 2013. Bayesian Data Analysis. 3rd edition. Chapman; Hall/CRC.\n\n\nGelman, Andrew, Jennifer Hill, y Aki Vehtari. 2021. Regression and Other Stories. 1st edition. Cambridge University Press. https://users.aalto.fi/~ave/ROS.pdf.\n\n\nHoff, Peter D. 2009. A First Course in Bayesian Statistical Methods. 1st edition. Springer.\n\n\nLambert, Ben. 2018. A Student’s Guide to Bayesian Statistics. 1st edition. SAGE Publications Ltd.\n\n\nLee, Michael D., y Eric-Jan Wagenmakers. 2014. Bayesian Cognitive Modeling: A Practical Course. 1st edition. Cambridge University Press.\n\n\nMa, Wei Ji, Konrad P. Kording, y Daniel Goldreich. 2022. Bayesian Models of Perception and Action: An Introduction. 3rd edition. http://www.cns.nyu.edu/malab/bayesianbook.html.\n\n\nMacKay, David J. C. 2003. Information Theory, Inference and Learning Algorithms. 1st edition. Cambridge University Press.\n\n\nMartin, Osvaldo A., Ravin Kumar, y Junpeng Lao. 2021. Bayesian Modeling and Computation in Python. 1st edition. Chapman; Hall/CRC.\n\n\nMurphy, Kevin P. 2022. Probabilistic Machine Learning: An Introduction. 1st edition. The MIT Press. https://probml.ai/.\n\n\nMurphy, Kevin P. 2023. Probabilistic Machine Learning: Advanced Topics. 1st edition. The MIT Press. https://probml.ai/.\n\n\nNicenboim, Bruno, Daniel Schad, y Shravan Vasishth. 2022. An Introduction to Bayesian Data Analysis for Cognitive Science. https://vasishth.github.io/bayescogsci/book/.\n\n\nTheoridis, Sergios. 2020. Machine Learning: A Bayesian and Optimization Perspective. 2nd edition. Academic Press."
  },
  {
    "objectID": "info/programa.html",
    "href": "info/programa.html",
    "title": "Programa",
    "section": "",
    "text": "Fundamentación\nLa Estadística Bayesiana es un enfoque de la inferencia estadística que se basa en utilizar probabilidades para representar el conocimiento disponible sobre el conjunto de parámetros de un modelo y actualizar esa información utilizando la Regla de Bayes a partir de la observación de un conjunto de datos. El conocimiento inicial se representa con una distribución de probabilidad a priori, la información contenida en los datos observados se modeliza con una función de verosimilitud y ambas fuentes de información se combinan para obtener una distribución de probabilidad a posteriori. La información a posteriori puede ser utilizada para extraer conclusiones sobre el fenómeno en estudio y realizar predicciones sobre datos no observados o eventos futuros.\nLos métodos bayesianos requieren, salvo en casos muy simples, una complejidad computacional que resultaba inalcanzable hace algunos años. Gracias a desarrollos revolucionarios en el ámbito de la computación, la principal barrera para la implementación de los modelos bayesianos desapareció y la utilización de estos se ha incrementado masivamente en múltiples campos científicos. Esta creciente popularidad se debe a que la inferencia bayesiana brinda un marco teórico consistente que permite la incorporación de información a priori, el desarrollo de un aprendizaje secuencial, la obtención de inferencias y predicciones en forma de distribuciones de probabilidad, el tratamiento de datos faltantes, los análisis con pocos datos, entre otras ventajas.\n\n\nObjetivos\nQue quienes cursen la materia logren:\n\nentender las características y los conceptos fundamentales de la Estadística Bayesiana;\ndescribir las características principales de la Estadística Bayesiana;\ncomprender la complejidad analítica de la inferencia bayesiana y la necesidad de la utilización de un enfoque computacional para superar estas dificultades;\nser capaces de aplicar métodos bayesianos a problemas reales utilizando software específico; e\ninterpretar los resultados del proceso de análisis bayesiano de datos.\n\n\n\nContenidos\n\nUnidad 1: Introducción y Fundamentos de la Estadística Bayesiana\n\nProbabilidad para cuantificar la incertidumbre. Modelos de probabilidad. Regla de Bayes. Inferencia bayesiana. Distribución a priori, función de verosimilitud, distribución a posteriori.\n\nUnidad 2: Inferencia Bayesiana\n\nModelos de distribuciones conjugadas. Modelos de un parámetro. Modelo beta-binomial. Enfoque intuitivo. Distribución a posteriori como compromiso entre la verosimilitud y la distribución a priori. Razonamiento secuencial. Modelo normal-normal. Modelo gamma–Poisson. Modelos de varios parámetros. Modelo normal – normal-gamma-inversa. Modelo Dirichlet–multinomial.\nElección de distribuciones a priori: no informativas (impropias, de Jeffrey) y débilmente informativas. Medidas de resumen de la distribución a posteriori. Intervalos de credibilidad. Distribución predictiva a posteriori. Nociones de teoría de la decisión bayesiana. Riesgo bayesiano. Estimador de Bayes.\n\nUnidad 3: Métodos Computacionales\n\nLimitaciones del enfoque analítico: cálculo de probabilidades y determinación de la distribución a posteriori. Soluciones: análisis de datos simulados y aproximación de grilla. Introducción al cómputo bayesiano. Nociones básicas de métodos de cadenas de Markov – Montecarlo (MCMC). Algoritmo de Metropolis–Hastings. Montecarlo Hamiltoniano. Diagnóstico de métodos MCMC.\nProgramación probabilística. Alternativas. Sintaxis de modelos. Ejemplos. Diagnóstico. Medidas de resumen a partir de las cadenas obtenidas. Visualizaciones.\n\nUnidad 4: Modelos Lineales\n\nModelos lineales. Elección de distribuciones a priori. Regularización. Diagnóstico de modelos. Predicciones basadas en distribuciones de probabilidad. Pruebas predictivas a priori y a posteriori. Densidad predictiva a posteriori logarítmica evaluada punto a punto (lppd). Deviance. Criterios de información: AIC, BIC, WAIC. Validacion cruzada. Sobreajuste y subajuste. Validación cruzada utilizando muestreo por importancia mediante suavizado Pareto (PSIS-CV).\n\nUnidad 5: Modelos Avanzados\n\nRegresión logística. Regresión Poisson. Comparación de grupos. Modelos de variable latente. Formulación gráfica. Análisis de sensibilidad.\nEl enfoque multinivel: modelos jerárquicos. Modelo beta-binomial jerárquico. Shrinkage de parámetros. Variación en el intercepto. Variación en la pendiente. Pooling de estimaciones. Problemas de estimación."
  }
]